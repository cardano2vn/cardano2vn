<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cardano2vn Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cardano2vn Blog Atom Feed"><title data-react-helmet="true">Week 04 - Monads | Cardano2vn</title><meta data-react-helmet="true" property="og:url" content="https://cardano2vn.io/docs/dr-lars-lession/week4"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Week 04 - Monads | Cardano2vn"><meta data-react-helmet="true" name="description" content="ÄÃ¢y lÃ  phiÃªn báº£n viáº¿t cá»§a BÃ i [giáº£ng sá»‘"><meta data-react-helmet="true" property="og:description" content="ÄÃ¢y lÃ  phiÃªn báº£n viáº¿t cá»§a BÃ i [giáº£ng sá»‘"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/2.png"><link data-react-helmet="true" rel="canonical" href="https://cardano2vn.io/docs/dr-lars-lession/week4"><link data-react-helmet="true" rel="alternate" href="https://cardano2vn.io/docs/dr-lars-lession/week4" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://cardano2vn.io/docs/dr-lars-lession/week4" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8b54419c.css">
<link rel="preload" href="/assets/js/runtime~main.38f84b10.js" as="script">
<link rel="preload" href="/assets/js/main.c8d132ad.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Cardano2vn</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Cardano2vn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Táº¡o Há»£p Ä‘á»“ng thÃ´ng minh</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/overview">Tá»•ng quan</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/marlowe">NgÃ´n ngá»¯ Marlowe</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/plutus">NgÃ´n ngá»¯ Plutus</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TÃ­ch há»£p vá»›i Cardano</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/integrate-cardano/note">Note</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Váº­n hÃ nh má»™t Stake Pool</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operate-a-stake-pool/note">Note</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">KhoÃ¡ Ä‘Ã o táº¡o Plutus cá»§a Dr. Lars</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/overview">Plutus Pioneer Program</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week1">Week 01 - English Auction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week2">Week 02 - Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week3">Week 03 - Script Context</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/dr-lars-lession/week4">Week 04 - Monads</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Week 04 - Monads</h1></header><div class="markdown"><p>ÄÃ¢y lÃ  phiÃªn báº£n viáº¿t cá»§a BÃ i <a href="https://youtu.be/HLJOcKlEucI" target="_blank" rel="noopener noreferrer">giáº£ng sá»‘
4</a>.</p><p>Trong bÃ i giáº£ng nÃ y, chÃºng ta tÃ¬m hiá»ƒu vá» ÄÆ¡n nguyÃªn (monads). Äáº·c biá»‡t lÃ  cÃ¡c
monads EmulatorTrace vÃ  Contract..</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="tá»•ng-quat"></a>Tá»•ng quat<a class="hash-link" href="#tá»•ng-quat" title="Direct link to heading">#</a></h2><p>ChÃºng tÃ´i Ä‘Ã£ dÃ nh hai bÃ i giáº£ng cuá»‘i cÃ¹ng Ä‘á»ƒ nÃ³i vá» pháº§n on-chain cá»§a
Plutus - logic xÃ¡c thá»±c Ä‘Æ°á»£c biÃªn dá»‹ch thÃ nh táº­p lá»‡nh Plutus vÃ  thá»±c sá»±
sá»‘ng trÃªn blockchain vÃ  Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi cÃ¡c nÃºt xÃ¡c thá»±c giao dá»‹ch.</p><p>CÃ²n ráº¥t nhiá»u Ä‘iá»u Ä‘á»ƒ nÃ³i vá» bá»™ pháº­n on-chain Ä‘Ã³.</p><p>ChÃºng tÃ´i chÆ°a xem xÃ©t cÃ¡c vÃ­ dá»¥ phá»©c táº¡p hÆ¡n vá» xÃ¡c thá»±c sá»­ dá»¥ng ngá»¯
cáº£nh phá»©c táº¡p hÆ¡n vÃ  chÃºng tÃ´i chÆ°a tháº¥y cÃ¡ch mÃ£ thÃ´ng bÃ¡o gá»‘c hoáº¡t Ä‘á»™ng
nhÆ° tháº¿ nÃ o (táº­p lá»‡nh Plutus cÅ©ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c thá»±c viá»‡c Ä‘Ãºc vÃ 
Ä‘á»‘t mÃ£ thÃ´ng bÃ¡o gá»‘c).</p><p>ChÃºng ta cháº¯c cháº¯n sáº½ pháº£i nÃ³i vá» nhá»¯ng chá»§ Ä‘á» Ä‘Ã³, vÃ  quay láº¡i váº¥n Ä‘á»
Ä‘Ã³.</p><p>Tuy nhiÃªn, trÆ°á»›c khi Ä‘i vÃ o quÃ¡ nhiá»u chá»§ Ä‘á» phá»©c táº¡p vá» xÃ¡c thá»±c trÃªn
chuá»—i, chÃºng ta khÃ´ng Ä‘Æ°á»£c bá» qua pháº§n ngoÃ i chuá»—i, vÃ¬ nÃ³ cÅ©ng quan
trá»ng khÃ´ng kÃ©m.</p><p>Pháº§n on-chain Ä‘áº£m nháº­n viá»‡c xÃ¡c thá»±c nhÆ°ng Ä‘á»ƒ cÃ³ thá»© gÃ¬ Ä‘Ã³ Ä‘Æ°á»£c xÃ¡c
thá»±c, chÃºng ta pháº£i xÃ¢y dá»±ng má»™t giao dá»‹ch vÃ  gá»­i nÃ³ lÃªn blockchain. VÃ ,
Ä‘Ã³ lÃ  nhá»¯ng gÃ¬ pháº§n off-chain thá»±c hiá»‡n.</p><p>VÃ¬ váº­y, chÃºng ta sáº½ báº¯t Ä‘áº§u nÃ³i vá» cÃ¡ch viáº¿t mÃ£ Plutus ngoÃ i chuá»—i.</p><p>Tháº­t khÃ´ng may, cÃ³ má»™t váº¥n Ä‘á» nhá» liÃªn quan Ä‘áº¿n cÃ¡c tÃ­nh nÄƒng Haskell
cáº§n thiáº¿t.</p><p>Pháº§n on-chain mÃ  chÃºng ta Ä‘Ã£ tháº¥y cho Ä‘áº¿n nay hÆ¡i xa láº¡ vÃ  cáº§n lÃ m quen
má»™t chÃºt, do thá»±c táº¿ lÃ  chÃºng ta cÃ³ thÃªm sá»± phá»©c táº¡p cá»§a quÃ¡ trÃ¬nh biÃªn
dá»‹ch sang táº­p lá»‡nh Plutus. NhÆ°ng, chÃºng ta khÃ´ng thá»±c sá»± pháº£i lo láº¯ng vá»
Ä‘iá»u Ä‘Ã³ náº¿u chÃºng ta sá»­ dá»¥ng phÃ©p thuáº­t Template Haskell. Trong trÆ°á»ng
há»£p Ä‘Ã³, hÃ m xÃ¡c nháº­n chá»‰ lÃ  má»™t hÃ m Ä‘Æ¡n giáº£n.</p><p>VÃ  nÃ³ thá»±c sá»± lÃ  má»™t hÃ m Haskell ráº¥t Ä‘Æ¡n giáº£n theo quan Ä‘iá»ƒm ká»¹ thuáº­t.
ChÃºng tÃ´i khÃ´ng sá»­ dá»¥ng báº¥t ká»³ tÃ­nh nÄƒng Haskell Æ°a thÃ­ch nÃ o Ä‘á»ƒ viáº¿t
hÃ m nÃ y.</p><p>Má»™t trong nhá»¯ng lÃ½ do cho Ä‘iá»u Ä‘Ã³ lÃ  cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a quÃ¡ trÃ¬nh
biÃªn dá»‹ch Plutus. ChÃºng tÃ´i Ä‘Ã£ tháº¥y lÃ m tháº¿ nÃ o Ä‘á»ƒ viá»‡c biÃªn dá»‹ch sang
Plutus thÃ nh cÃ´ng, táº¥t cáº£ mÃ£ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi hÃ m xÃ¡c nháº­n pháº£i cÃ³ sáºµn
trong Oxford Brackets. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  táº¥t cáº£ cÃ¡c chá»©c nÄƒng Ä‘Æ°á»£c sá»­
dá»¥ng bá»Ÿi chá»©c nÄƒng <code>mkValidator</code> pháº£i sá»­ dá»¥ng pragma INLINABLE.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{-# INLINABLE mkValidator #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkValidator :: Data -&gt; Data -&gt; Data -&gt; ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkValidator _ _ _ = ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$$(PlutusTx.compile [|| mkValidator ||])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  hÃ£y nhá»› láº¡i ráº±ng vÃ¬ cÃ¡c hÃ m Haskell tiÃªu chuáº©n khÃ´ng cÃ³ pragma CÃ“ THá»‚
Lá»†NH nÃ y, nÃªn cÃ³ má»™t mÃ´-Ä‘un Plutus Prelude má»›i tÆ°Æ¡ng tá»± nhÆ° Haskell
Prelude tiÃªu chuáº©n, nhÆ°ng vá»›i cÃ¡c chá»©c nÄƒng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh vá»›i pragma
INLINABLE.</p><p>NhÆ°ng, táº¥t nhiÃªn, cÃ³ hÃ ng trÄƒm thÆ° viá»‡n Haskell ngoÃ i kia vÃ  háº§u háº¿t
chÃºng khÃ´ng Ä‘Æ°á»£c viáº¿t vá»›i Plutus, vÃ¬ váº­y chÃºng tÃ´i khÃ´ng thá»ƒ sá»­ dá»¥ng
chÃºng trong quÃ¡ trÃ¬nh xÃ¡c thá»±c. VÃ , Ä‘iá»u Ä‘Ã³ cÃ³ tÃ¡c dá»¥ng lÃ  xÃ¡c thá»±c bÃªn
trong Haskell sáº½ tÆ°Æ¡ng Ä‘á»‘i Ä‘Æ¡n giáº£n vÃ  sáº½ khÃ´ng cÃ³ nhiá»u phá»¥ thuá»™c.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="monads"></a>Monads<a class="hash-link" href="#monads" title="Direct link to heading">#</a></h2><p>Trong pháº§n off-chain cá»§a Plutus, tÃ¬nh hÃ¬nh Ä‘Ã£ Ä‘áº£o ngÆ°á»£c. ChÃºng ta khÃ´ng
pháº£i lo láº¯ng vá» viá»‡c biÃªn dá»‹ch sang táº­p lá»‡nh Plutus - nÃ³ chá»‰ lÃ  Haskell
Ä‘Æ¡n giáº£n. Tuy nhiÃªn, máº·t trÃ¡i cá»§a nÃ³ lÃ , cÃ¡ch nÃ³ Ä‘Æ°á»£c thá»±c hiá»‡n, nÃ³ sá»­
dá»¥ng cÃ¡c tÃ­nh nÄƒng Haskell phá»©c táº¡p hÆ¡n nhiá»u - vÃ­ dá»¥ nhÆ° cÃ¡i gá»i lÃ  há»‡
thá»‘ng hiá»‡u á»©ng, phÃ¡t trá»±c tuyáº¿n vÃ  Ä‘áº·c biá»‡t lÃ  monads.</p><p>Táº¥t cáº£ mÃ£ off-chain (mÃ£ vÃ­), Ä‘Æ°á»£c viáº¿t báº±ng má»™t Ä‘Æ¡n nguyÃªn Ä‘áº·c biá»‡t -
ÄÆ¡n nguyÃªn há»£p Ä‘á»“ng.</p><p>CÃ¡c tu viá»‡n ná»•i tiáº¿ng trong tháº¿ giá»›i Haskell. ÄÃ¢y thÆ°á»ng lÃ  trá»Ÿ ngáº¡i Ä‘áº§u
tiÃªn khi báº¯t Ä‘áº§u láº­p trÃ¬nh viÃªn Haskell.</p><p>CÃ³ ráº¥t nhiá»u hÆ°á»›ng dáº«n cá»‘ gáº¯ng giáº£i thÃ­ch cÃ¡c Monads. Monads Ä‘Æ°á»£c so
sÃ¡nh vá»›i burritos, vÃ  táº¥t cáº£ cÃ¡c loáº¡i áº©n dá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cá»‘ gáº¯ng giáº£i
thÃ­ch khÃ¡i niá»‡m. NhÆ°ng á»Ÿ Ä‘Ã¢y, Ã­t nháº¥t chÃºng ta hÃ£y cá»‘ gáº¯ng cung cáº¥p má»™t
khÃ³a há»c cÆ¡ báº£n vá» monads cho nhá»¯ng ngÆ°á»i má»›i sá»­ dá»¥ng Haskell.</p><p>TrÆ°á»›c khi Ä‘áº¿n vá»›i cÃ¡c Ä‘Æ¡n nguyÃªn chung, chÃºng ta sáº½ báº¯t Ä‘áº§u vá»›i IO , Ä‘Ã³
lÃ  cÃ¡ch xá»­ lÃ½ cÃ¡c tÃ¡c dá»¥ng phá»¥ cá»§a IO trong Haskell. Tuy nhiÃªn, trÆ°á»›c
khi Ä‘áº¿n vá»›i Haskell, chÃºng ta hÃ£y xem xÃ©t má»™t ngÃ´n ngá»¯ chÃ­nh thá»‘ng nhÆ°
Java.</p><p>HÃ£y xem xÃ©t phÆ°Æ¡ng phÃ¡p Java sau Ä‘Ã¢y.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.java}"><div tabindex="0" class="prism-code language-{.java} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">public static int foo() {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ m nÃ y khÃ´ng cÃ³ Ä‘á»‘i sá»‘ vÃ  nÃ³ tráº£ vá» <code>int</code>. HÃ£y tÆ°á»Ÿng tÆ°á»£ng nÃ³ Ä‘Æ°á»£c gá»i
hai láº§n trong mÃ£.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.java}"><div tabindex="0" class="prism-code language-{.java} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">final int a = foo();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">final int b = foo();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng ta lÆ°u Ã½ ráº±ng, chá»«ng nÃ o chÃºng ta khÃ´ng biáº¿t Ä‘iá»u gÃ¬ Ä‘ang
xáº£y ra bÃªn trong hÃ m foo(), thÃ¬ giÃ¡ trá»‹ tráº£ vá» cá»§a biá»ƒu thá»©c sau lÃ 
khÃ´ng xÃ¡c Ä‘á»‹nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.java}"><div tabindex="0" class="prism-code language-{.java} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">a == b; // true or false? at compile time, we don&#x27;t know</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i khÃ´ng biáº¿t cÃ³ <code>a</code> giá»‘ng nhÆ° <code>b</code> váº­y khÃ´ng vÃ¬ trong Java, hoÃ n
toÃ n cÃ³ thá»ƒ xáº£y ra má»™t sá»‘ IO bÃªn trong <code>foo</code>. VÃ­ dá»¥: cÃ³ mÃ£ lÃ  mÃ£ yÃªu cáº§u
ngÆ°á»i dÃ¹ng nháº­p Ä‘áº§u vÃ o trÃªn báº£ng Ä‘iá»u khiá»ƒn vÃ  sá»­ dá»¥ng mÃ£ nÃ y Ä‘á»ƒ tÃ­nh
toÃ¡n giÃ¡ trá»‹ tráº£ vá».</p><p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ , Ä‘á»ƒ láº­p luáº­n vá» mÃ£, chÃºng ta cáº§n pháº£i nhÃ¬n vÃ o bÃªn
trong <code>foo</code>, Ä‘iá»u nÃ y lÃ m cho viá»‡c thá»­ nghiá»‡m trá»Ÿ nÃªn khÃ³ khÄƒn hÆ¡n. VÃ 
nÃ³ cÃ³ nghÄ©a lÃ , <code>foo</code> vÃ­ dá»¥ , Ä‘Ã³ lÃ  lá»‡nh gá»i tráº£ vá» Ä‘áº§u tiÃªn <code>13</code>- chÃºng
ta khÃ´ng thá»ƒ thay tháº¿ táº¥t cáº£ cÃ¡c lá»‡nh gá»i khÃ¡c Ä‘áº¿n <code>foo</code> báº±ng giÃ¡ trá»‹
tráº£ vá» Ä‘Ã£ biáº¿t cá»§a <code>13</code>.</p><p>á» Haskell, tÃ¬nh hÃ¬nh ráº¥t khÃ¡c vÃ¬ Haskell lÃ  má»™t ngÃ´n ngá»¯ chá»©c nÄƒng thuáº§n
tÃºy. Chá»¯ kÃ½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng trong Haskell sáº½ giá»‘ng nhÆ° sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo = ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», náº¿u chÃºng ta gáº·p trÆ°á»ng há»£p chÃºng ta gá»i <code>foo</code> hai láº§n, máº·c dÃ¹
chÃºng ta khÃ´ng biáº¿t giÃ¡ trá»‹ cá»§a <code>foo</code> lÃ  gÃ¬, chÃºng ta biáº¿t cháº¯c ráº±ng hai
giÃ¡ trá»‹ tráº£ vá» sáº½ giá»‘ng nhau.</p><p>ÄÃ¢y lÃ  má»™t tÃ­nh nÄƒng ráº¥t quan trá»ng Ä‘Æ°á»£c gá»i lÃ  tÃ­nh minh báº¡ch tham
chiáº¿u . TrÃªn thá»±c táº¿, cÃ³ má»™t sá»‘ cá»­a thoÃ¡t hiá»ƒm Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y,
nhÆ°ng chÃºng ta cÃ³ thá»ƒ bá» qua Ä‘iá»u nÃ y.</p><p>Äiá»u nÃ y lÃ m cho cÃ¡c tÃ¡c vá»¥ nhÆ° tÃ¡i cáº¥u trÃºc vÃ  kiá»ƒm tra dá»… dÃ ng hÆ¡n
nhiá»u.</p><p>Äiá»u nÃ y lÃ  ráº¥t tá»‘t, nhÆ°ng báº¡n cáº§n cÃ³ tÃ¡c dá»¥ng phá»¥ Ä‘á»ƒ cÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n
tháº¿ giá»›i. Náº¿u khÃ´ng, táº¥t cáº£ nhá»¯ng gÃ¬ chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n lÃ m lÃ  lÃ m
nÃ³ng bá»™ xá»­ lÃ½.</p><p>Báº¡n cáº§n Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra. Báº¡n pháº£i cÃ³ kháº£ nÄƒng ghi káº¿t quáº£ Ä‘áº§u ra ra
mÃ n hÃ¬nh, hoáº·c Ä‘á»c Ä‘áº§u vÃ o tá»« bÃ n phÃ­m, káº¿t ná»‘i máº¡ng hoáº·c tá»‡p, cháº³ng
háº¡n.</p><p>CÃ³ má»™t <a href="https://www.youtube.com/watch?v=iSmkqocn0oQ" target="_blank" rel="noopener noreferrer">video ná»•i tiáº¿ng cá»§a Simon Peyton-Jones lÃ  Haskell Is
Useless</a> giáº£i thÃ­ch ráº±ng
ngÃ´n ngá»¯ thuáº§n tÃºy, khÃ´ng cÃ³ tÃ¡c dá»¥ng phá»¥ thÃ¬ ráº¥t Ä‘áº¹p vá» máº·t toÃ¡n há»c,
nhÆ°ng cuá»‘i cÃ¹ng thÃ¬ báº¡n cÅ©ng cáº§n cÃ³ tÃ¡c dá»¥ng phá»¥ Ä‘á»ƒ biáº¿n báº¥t cá»© Ä‘iá»u gÃ¬
xáº£y ra.</p><p>VÃ  Haskell cÃ³ má»™t cÃ¡ch Ä‘á»ƒ xá»­ lÃ½ cÃ¡c tÃ¡c dá»¥ng phá»¥ vÃ  Ä‘Ã³ lÃ  ÄÆ¡n nguyÃªn IO.
Tuy nhiÃªn, Ä‘á»«ng lo láº¯ng vá» pháº§n Ä‘Æ¡n nguyÃªn.</p><p>ÄÃ¢y lÃ  cÃ¡ch chÃºng tÃ´i lÃ m Ä‘iá»u Ä‘Ã³ trong Haskell.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: IO Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo = ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><code>IO</code> lÃ  má»™t phÆ°Æ¡ng thá»©c khá»Ÿi táº¡o kiá»ƒu nháº­n má»™t Ä‘á»‘i sá»‘, giá»‘ng nhÆ° má»™t sá»‘
vÃ­ dá»¥ khÃ¡c vá» cÃ¡c hÃ m táº¡o kiá»ƒu nhÆ° <code>Maybe</code> and <code>List</code> . Tuy nhiÃªn, khÃ´ng
giá»‘ng nhÆ° nhá»¯ng vÃ­ dá»¥ Ä‘Ã³, <code>IO</code> Ä‘áº·c biá»‡t, theo nghÄ©a lÃ  báº¡n khÃ´ng thá»ƒ
triá»ƒn khai nÃ³ báº±ng chÃ­nh ngÃ´n ngá»¯. NÃ³ lÃ  má»™t nguyÃªn thá»§y Ä‘Æ°á»£c tÃ­ch há»£p
sáºµn.</p><p>GiÃ¡ trá»‹ tráº£ vá» <code>IO Int</code> cho chÃºng ta biáº¿t ráº±ng Ä‘Ã¢y lÃ  má»™t cÃ´ng thá»©c Ä‘á»ƒ
tÃ­nh Int vÃ  cÃ´ng thá»©c nÃ y cÃ³ thá»ƒ gÃ¢y ra cÃ¡c pháº£n á»©ng phá»¥. Má»™t danh sÃ¡ch
cÃ¡c hÆ°á»›ng dáº«n cho mÃ¡y tÃ­nh biáº¿t pháº£i lÃ m gÃ¬ Ä‘á»ƒ káº¿t thÃºc vá»›i má»™t <code>Int</code> .</p><p>Äiá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  tÃ­nh minh báº¡ch cá»§a tham chiáº¿u khÃ´ng bá»‹ phÃ¡
vá»¡ á»Ÿ Ä‘Ã¢y. Káº¿t quáº£ Ä‘Ã¡nh giÃ¡ foo lÃ  chÃ­nh cÃ´ng thá»©c, khÃ´ng pháº£i giÃ¡ trá»‹
<code>Int</code> . VÃ  vÃ¬ cÃ´ng thá»©c luÃ´n giá»‘ng nhau, nÃªn tÃ­nh minh báº¡ch cá»§a tham
chiáº¿u Ä‘Æ°á»£c duy trÃ¬.</p><p>CÃ¡ch duy nháº¥t Ä‘á»ƒ thá»±c sá»± thá»±c hiá»‡n má»™t cÃ´ng thá»©c nhÆ° váº­y trong chÆ°Æ¡ng
trÃ¬nh Haskell lÃ  tá»« Ä‘iá»ƒm nháº­p chÃ­nh cá»§a chÆ°Æ¡ng trÃ¬nh - hÃ m chÃ­nh . Báº¡n
cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng IO trong REPL.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="hello-world"></a>Hello World<a class="hash-link" href="#hello-world" title="Direct link to heading">#</a></h3><p>Hello World in Haskell trÃ´ng nhÆ° tháº¿ nÃ y:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">main :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">main = putStrLn &quot;Hello, world!&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y, <code>main</code> lÃ  má»™t cÃ´ng thá»©c thá»±c hiá»‡n má»™t sá»‘ tÃ¡c dá»¥ng phá»¥ vÃ  tráº£ vá»
ÄÆ¡n vá»‹ - khÃ´ng cÃ³ gÃ¬ Ä‘Ã¡ng quan tÃ¢m.</p><p>HÃ£y xem <code>putStrLn</code> trong REPL. ChÃºng tÃ´i tháº¥y ráº±ng Ä‘Ã³ lÃ  má»™t hÃ nh Ä‘á»™ng
IO sá»­ dá»¥ng <code>String</code> vÃ  khÃ´ng tráº£ vá» káº¿t quáº£ thÃº vá»‹ nÃ o.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t putStrLn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">putStrLn :: String -&gt; IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t putStrLn &quot;Hello, world!&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">putStrLn &quot;Hello, world!&quot; :: IO ()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ cháº¡y Ä‘iá»u nÃ y. Má»Ÿ á»©ng dá»¥ng /Main.sh vÃ  chá»‰nh
sá»­a chá»©c nÄƒng chÃ­nh Ä‘á»ƒ nÃ³ Ä‘á»c:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">main :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">main = putStrLn &quot;Hello, world!&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Sau Ä‘Ã³ cháº¡y</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.bash}"><div tabindex="0" class="prism-code language-{.bash} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">cabal run hello</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta sáº½ xem xÃ©t nhanh tá»‡p cabal ngay bÃ¢y giá».</p><p>Trong cÃ¡c bÃ i giáº£ng trÆ°á»›c, chÃºng ta chá»‰ cáº§n pháº§n thÆ° viá»‡n <code>library</code>
trong tá»‡p <code>plutus-pioneer-program-week04.cabal</code> vÃ¬ chÃºng ta chá»‰ xá»­ lÃ½
cÃ¡c hÃ m thÆ° viá»‡n. BÃ¢y giá», chÃºng ta cáº§n thÃªm má»™t khá»• thÆ¡ cÃ³ thá»ƒ thá»±c thi
Ä‘Æ°á»£c .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.cabal}"><div tabindex="0" class="prism-code language-{.cabal} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">executable hello</span></div><div class="token-line" style="color:#393A34"><span class="token plain">hs-source-dirs:      app</span></div><div class="token-line" style="color:#393A34"><span class="token plain">main-is:             hello.hs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">build-depends:       base ^&gt;=4.14.1.0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">default-language:    Haskell2010</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ghc-options:         -Wall -O2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y chá»‰ Ä‘á»‹nh thÆ° má»¥c nguá»“n vÃ  tá»‡p nÃ o giá»¯ chá»©c nÄƒng chÃ­nh. ThÃ´ng
thÆ°á»ng tÃªn tá»‡p pháº£i khá»›p vá»›i tÃªn mÃ´-Ä‘un, nhÆ°ng <code>main</code> lÃ  má»™t ngoáº¡i lá»‡.</p><p>Thay vÃ¬ chá»‰ yÃªu cáº§u loáº¡i <code>putStrLn</code> , chÃºng ta cÃ³ thá»ƒ cháº¡y nÃ³ trong
REPL. NhÆ° Ä‘Ã£ Ä‘á» cáº­p, REPL cho phÃ©p chÃºng ta thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng IO.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; putStrLn &quot;Hello, world!&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Hello, world!</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="getline"></a>getLine<a class="hash-link" href="#getline" title="Direct link to heading">#</a></h3><p>HÃ£y xem <code>getLine</code></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t getLine</span></div><div class="token-line" style="color:#393A34"><span class="token plain">getLine :: IO String</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y cho tháº¥y ráº±ng Ä‘Ã³ lÃ  má»™t cÃ´ng thá»©c, cÃ³ thá»ƒ táº¡o ra cÃ¡c hiá»‡u á»©ng
phá»¥, khi Ä‘Æ°á»£c thá»±c thi sáº½ táº¡o ra má»™t Chuá»—i . Trong trÆ°á»ng há»£p getLine ,
tÃ¡c dá»¥ng phá»¥ Ä‘Æ°á»£c Ä‘á» cáº­p lÃ  nÃ³ sáº½ Ä‘á»£i ngÆ°á»i dÃ¹ng nháº­p tá»« bÃ n phÃ­m.</p><p>Náº¿u chÃºng ta thá»±c thi getLine trong REPL.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; getLine</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NÃ³ chá» nháº­p bÃ n phÃ­m. Sau Ä‘Ã³, náº¿u chÃºng ta nháº­p má»™t cÃ¡i gÃ¬ Ä‘Ã³, nÃ³ sáº½ tráº£
vá» káº¿t quáº£.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Haskell</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&quot;Haskell&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ³ má»™t loáº¡t cÃ¡c hÃ nh Ä‘á»™ng IO Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Haskell Ä‘á»ƒ thá»±c hiá»‡n
táº¥t cáº£ cÃ¡c loáº¡i nhÆ° Ä‘á»c tá»‡p, ghi tá»‡p, Ä‘á»c tá»« vÃ  ghi vÃ o á»• cáº¯m.</p><p>NhÆ°ng cho dÃ¹ báº¡n cÃ³ bao nhiÃªu hÃ nh Ä‘á»™ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c, Ä‘iá»u Ä‘Ã³ sáº½
khÃ´ng bao giá» lÃ  Ä‘á»§ Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³ phá»©c táº¡p, vÃ¬ váº­y cáº§n pháº£i cÃ³
cÃ¡ch Ä‘á»ƒ káº¿t há»£p cÃ¡c hÃ nh Ä‘á»™ng IO nguyÃªn thá»§y nÃ y thÃ nh nhá»¯ng cÃ´ng thá»©c
lá»›n hÆ¡n, phá»©c táº¡p hÆ¡n.</p><p>Má»™t Ä‘iá»u chÃºng ta cÃ³ thá»ƒ lÃ m lÃ  sá»­ dá»¥ng phiÃªn báº£n kiá»ƒu <code>Functor</code> cá»§a IO.
HÃ£y xem xÃ©t cÃ¡c trÆ°á»ng há»£p loáº¡i cá»§a <code>IO</code> trong REPL.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i IO</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type IO :: ` -&gt; `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">newtype IO a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">= ghc-prim-0.6.1:GHC.Types.IO (ghc-prim-0.6.1:GHC.Prim.State#</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                 ghc-prim-0.6.1:GHC.Prim.RealWorld</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                 -&gt; (# ghc-prim-0.6.1:GHC.Prim.State#</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                       ghc-prim-0.6.1:GHC.Prim.RealWorld,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                       a #))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜ghc-prim-0.6.1:GHC.Typesâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid a =&gt; Monoid (IO a) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Semigroup a =&gt; Semigroup (IO a) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance MonadFail IO -- Defined in â€˜Control.Monad.Failâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta tháº¥y cÃ¡ thá»ƒ <code>Monad</code> Ä‘Ã¡ng sá»£ , nhÆ°ng chÃºng ta cÅ©ng tháº¥y má»™t cÃ¡
thá»ƒ <code>Functor</code>. <code>Functor</code> lÃ  má»™t loáº¡i lá»›p ráº¥t quan trá»ng trong Haskell.
Náº¿u chÃºng ta nhÃ¬n vÃ o nÃ³ trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Functor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Functor :: (` -&gt; `) -&gt; Constraint</span></div><div class="token-line" style="color:#393A34"><span class="token plain">class Functor f where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fmap :: (a -&gt; b) -&gt; f a -&gt; f b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&lt;$) :: a -&gt; f b -&gt; f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{-# MINIMAL fmap #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor (Either a) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor [] -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((-&gt;) r) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,,,) a b c) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,,) a b) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,) a) -- Defined in â€˜GHC.Baseâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>PhÆ°Æ¡ng phÃ¡p quan trá»ng á»Ÿ Ä‘Ã¢y lÃ  fmap . HÃ m thá»© hai (\&lt;\$) lÃ  má»™t hÃ m
tiá»‡n lá»£i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">fmap :: (a -&gt; b) -&gt; f a -&gt; f b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ m nÃ y <code>fmap</code> , mÃ  táº¥t cáº£ <code>Functor</code>s cÃ³ cho chÃºng ta biáº¿t ráº±ng, náº¿u
chÃºng ta cáº¥p cho nÃ³ quyá»n truy cáº­p vÃ o má»™t hÃ m cÃ³ thá»ƒ biáº¿n <code>a</code> thÃ ng <code>b</code>
, thÃ¬ nÃ³ cÃ³ thá»ƒ biáº¿n fa thÃ nh fb cho chÃºng ta. á» Ä‘Ã¢y, chÃºng ta quan tÃ¢m
Ä‘áº¿n trÆ°á»ng há»£p f lÃ  IO .</p><p>Náº¿u chÃºng ta chuyÃªn biá»‡t hÃ³a hÃ m cho <code>IO</code> , chÃºng ta sáº½ cÃ³ má»™t hÃ m nhÆ°:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">fmap&#x27; :: (a -&gt; b) -&gt; IO a -&gt; IO b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>LÃ m tháº¿ nÃ o Ä‘á»ƒ lÃ m viá»‡c Ä‘Ã³. Ã€, <code>IO a</code> lÃ  má»™t cÃ´ng thá»©c cÃ³ tÃ¡c dá»¥ng phá»¥
vÃ  táº¡o ra <code>a</code> . VÃ¬ váº­y, lÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta cÃ³ Ä‘Æ°á»£c má»™t <code>b</code> trong sá»‘
Ä‘Ã³? ChÃºng tÃ´i thá»±c hiá»‡n cÃ´ng thá»©c, nhÆ°ng, trÆ°á»›c khi tráº£ vá» a , chÃºng tÃ´i
Ã¡p dá»¥ng hÃ m <code>(a -\&gt; b)</code> cho <code>a</code> vÃ  tráº£ vá» káº¿t quáº£ lÃ  <code>b</code> .</p><p>Trong REPL, chÃºng ta hÃ£y xem xÃ©t hÃ m <code>toUpper</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; import Data.Char</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; :t toUpper</span></div><div class="token-line" style="color:#393A34"><span class="token plain">toUpper :: Char -&gt; Char</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; toUpper &#x27;q&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&#x27;Q&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng ta muá»‘n Ã¡p dá»¥ng Ä‘Æ°á»£c cho má»™t chuá»—i chá»© khÃ´ng pháº£i lÃ  má»™t Char
chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng báº£n Ä‘á»“ chá»©c nÄƒng. CÃ¡c chuá»—i <code>String</code>s trong
Haskell chá»‰ lÃ  <code>Char</code>s .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; map toUpper &quot;Haskell&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&quot;HASKELL&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ m <code>map toUpper</code> lÃ  má»™t hÃ m chuyá»ƒn tá»« <code>String</code> to <code>String</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; :t map toUpper</span></div><div class="token-line" style="color:#393A34"><span class="token plain">map toUpper :: [Char] -&gt; [Char]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng káº¿t há»£p vá»›i <code>fmap</code>. Náº¿u chÃºng ta sá»­ dá»¥ng <code>map
toUpper</code> lÃ m chá»©c nÄƒng chuyá»ƒn Ä‘á»•i <code>a</code> thÃ nh <code>b</code> , chÃºng ta cÃ³ thá»ƒ tháº¥y
loáº¡i Ä‘áº§u ra cá»§a fmap sáº½ nhÆ° tháº¿ nÃ o khi Ã¡p dá»¥ng cho <code>IO a</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; :t fmap (map toUpper) getLine</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fmap (map toUpper) getLine :: IO [Char]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y xem nÃ³ trong hÃ nh Ä‘á»™ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Data.Char Week04.Contract&gt; fmap (map toUpper) getLine</span></div><div class="token-line" style="color:#393A34"><span class="token plain">haskell</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&quot;HASKELL&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng toÃ¡n tá»­ <code>\&gt;\&gt;</code> . Äiá»u nÃ y chuá»—i hai hÃ nh
Ä‘á»™ng <code>IO</code> láº¡i vá»›i nhau, bá» qua káº¿t quáº£ cá»§a hÃ nh Ä‘á»™ng Ä‘áº§u tiÃªn. Trong vÃ­
dá»¥ sau, cáº£ hai hÃ nh Ä‘á»™ng sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n theo trÃ¬nh tá»±.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; putStrLn &quot;Hello&quot; &gt;&gt; putStrLn &quot;World&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Hello</span></div><div class="token-line" style="color:#393A34"><span class="token plain">World</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y, khÃ´ng cÃ³ káº¿t quáº£ tá»« <code>putStrLn</code> , nhÆ°ng náº¿u cÃ³, nÃ³ sáº½ bá»‹ bá» qua. CÃ¡c tÃ¡c dá»¥ng khÃ´ng mong muá»‘n cá»§a nÃ³ sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n, káº¿t quáº£ cá»§a nÃ³ bá»‹ bá» qua, sau Ä‘Ã³ cÃ¡c tÃ¡c dá»¥ng khÃ´ng mong muá»‘n thá»© hai cá»§a <code>putStrLn</code> sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n trÆ°á»›c khi tráº£ vá» káº¿t quáº£ cá»§a láº§n gá»i thá»© hai.</p><p>Sau Ä‘Ã³, cÃ³ má»™t toÃ¡n tá»­ quan trá»ng khÃ´ng bá» qua káº¿t quáº£ cá»§a hÃ nh Ä‘á»™ng IO Ä‘áº§u tiÃªn , vÃ  Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  rÃ ng buá»™c . NÃ³ Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng kÃ½ hiá»‡u <code>\&gt;\&gt;=</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t (&gt;&gt;=)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i tháº¥y rÃ ng buá»™c <code>Monad</code> , nhÆ°ng chÃºng tÃ´i cÃ³ thá»ƒ bá» qua Ä‘iá»u Ä‘Ã³ ngay bÃ¢y giá» vÃ  chá»‰ nghÄ© vá» <code>IO</code> .</p><p>Äiá»u nÃ y nÃ³i lÃªn ráº±ng náº¿u tÃ´i cÃ³ má»™t cÃ´ng thá»©c thá»±c hiá»‡n cÃ¡c tÃ¡c dá»¥ng phá»¥ sau Ä‘Ã³ cho tÃ´i káº¿t quáº£ <code>a</code> , vÃ  cho ráº±ng tÃ´i cÃ³ má»™t hÃ m nháº­n <code>a</code> vÃ  tráº£ láº¡i cho tÃ´i má»™t cÃ´ng thá»©c tráº£ vá» <code>b</code> , thÃ¬ tÃ´i cÃ³ thá»ƒ káº¿t há»£p cÃ´ng thá»©c <code>m a</code>. vá»›i cÃ´ng thá»©c mb báº±ng cÃ¡ch láº¥y giÃ¡ trá»‹ a vÃ  sá»­ dá»¥ng nÃ³ trong cÃ´ng thá»©c thu Ä‘Æ°á»£c giÃ¡ trá»‹ <code>b</code> .</p><p>Má»™t vÃ­ dá»¥ sáº½ lÃ m rÃµ Ä‘iá»u nÃ y.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; getLine &gt;&gt;= putStrLn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Haskell</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Haskell</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y, hÃ m <code>getLine</code>  cÃ³ kiá»ƒu <code>IO String</code> . GiÃ¡ trá»‹ tráº£ vá» <code>a</code> Ä‘Æ°á»£c chuyá»ƒn cho hÃ m <code>(a -\&gt; m b)</code> , sau Ä‘Ã³ táº¡o ra má»™t cÃ´ng thá»©c <code>putStrLn</code> vá»›i giÃ¡ trá»‹ Ä‘áº§u vÃ o lÃ  <code>a</code> vÃ  Ä‘áº§u ra lÃ  kiá»ƒu <code>IO ()</code> . Sau Ä‘Ã³, <code>putStrLn</code> thá»±c hiá»‡n cÃ¡c tÃ¡c dá»¥ng phá»¥ cá»§a nÃ³ vÃ  tráº£ vá» <code>Unit</code> .</p><p>CÃ³ má»™t cÃ¡ch khÃ¡c, ráº¥t quan trá»ng, Ä‘á»ƒ táº¡o cÃ¡c hÃ nh Ä‘á»™ng <code>IO</code> , vÃ  Ä‘Ã³ lÃ  táº¡o cÃ¡c cÃ´ng thá»©c náº¥u Äƒn ngay láº­p tá»©c tráº£ vá» káº¿t quáº£ mÃ  khÃ´ng thá»±c hiá»‡n báº¥t ká»³ tÃ¡c dá»¥ng phá»¥ nÃ o.</p><p>Äiá»u Ä‘Ã³ Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i má»™t chá»©c nÄƒng Ä‘Æ°á»£c gá»i lÃ  <code>return</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t return</span></div><div class="token-line" style="color:#393A34"><span class="token plain">return :: Monad m =&gt; a -&gt; m a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t láº§n ná»¯a, nÃ³ lÃ  chung cho báº¥t ká»³ ÄÆ¡n nguyÃªn (Monad) nÃ o, chÃºng ta chá»‰ cáº§n nghÄ© vá» <code>IO</code> ngay bÃ¢y giá».</p><p>NÃ³ nháº­n má»™t giÃ¡ trá»‹ <code>a</code> vÃ  tráº£ vá» má»™t cÃ´ng thá»©c táº¡o ra giÃ¡ trá»‹ <code>a</code> . Trong trÆ°á»ng há»£p tráº£ láº¡i , cÃ´ng thá»©c thá»±c sá»± khÃ´ng táº¡o ra báº¥t ká»³ tÃ¡c dá»¥ng phá»¥ nÃ o.</p><p>VÃ­ dá»¥:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; return &quot;Haskell&quot; :: IO String</span></div><div class="token-line" style="color:#393A34"><span class="token plain">&quot;Haskell&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i cáº§n chá»‰ Ä‘á»‹nh kiá»ƒu tráº£ vá» Ä‘á»ƒ REPL biáº¿t chÃºng tÃ´i Ä‘ang sá»­ dá»¥ng <code>Monad</code> nÃ o: </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t return &quot;Haskell&quot; :: IO String</span></div><div class="token-line" style="color:#393A34"><span class="token plain">return &quot;Haskell&quot; :: IO String :: IO String</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :t return &quot;Haskell&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">return &quot;Haskell&quot; :: Monad m =&gt; m [Char]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u bÃ¢y giá» chÃºng ta quay láº¡i <code>main</code> cá»§a mÃ¬nh, bÃ¢y giá» chÃºng ta cÃ³ thá»ƒ viáº¿t cÃ¡c hÃ nh Ä‘á»™ng <code>IO</code>  tÆ°Æ¡ng Ä‘á»‘i phá»©c táº¡p . VÃ­ dá»¥, chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh má»™t hÃ nh Ä‘á»™ng <code>IO</code>  sáº½ yÃªu cáº§u hai chuá»—i vÃ  in káº¿t quáº£ cá»§a viá»‡c ná»‘i hai chuá»—i Ä‘Ã³ vá»›i báº£ng Ä‘iá»u khiá»ƒn.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">main :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">main = bar</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bar :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bar = getLine &gt;&gt;= \s -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      getLine &gt;&gt;= \t -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      putStrLn (s ++ t)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  sau Ä‘Ã³, khi chÃºng tÃ´i cháº¡y nÃ³, chÆ°Æ¡ng trÃ¬nh sáº½ Ä‘á»£i hai Ä‘áº§u vÃ o vÃ  sau Ä‘Ã³ xuáº¥t ra káº¿t quáº£ Ä‘Æ°á»£c ná»‘i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.bash}"><div tabindex="0" class="prism-code language-{.bash} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">cabal run hello</span></div><div class="token-line" style="color:#393A34"><span class="token plain">one</span></div><div class="token-line" style="color:#393A34"><span class="token plain">two</span></div><div class="token-line" style="color:#393A34"><span class="token plain">onetwo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá» Ä‘iá»u nÃ y lÃ  Ä‘á»§ cho cÃ¡c má»¥c Ä‘Ã­ch cá»§a chÃºng tÃ´i, máº·c dÃ¹ chÃºng tÃ´i sáº½ khÃ´ng cáº§n ÄÆ¡n nguyÃªn <code>IO</code> cho Ä‘áº¿n khi cÃ³ láº½ sau nÃ y trong khÃ³a há»c khi chÃºng tÃ´i nÃ³i vá» viá»‡c thá»±c sá»± triá»ƒn khai cÃ¡c há»£p Ä‘á»“ng Plutus. Tuy nhiÃªn, <code>IO</code> Monad lÃ  má»™t vÃ­ dá»¥ quan trá»ng vÃ  lÃ  má»™t vÃ­ dá»¥ tá»‘t Ä‘á»ƒ báº¯t Ä‘áº§u.</p><p>VÃ¬ váº­y, hiá»‡n táº¡i, chÃºng ta hÃ£y hoÃ n toÃ n quÃªn <code>IO</code> vÃ  chá»‰ viáº¿t Haskell thuáº§n tÃºy, cÃ³ chá»©c nÄƒng, sá»­ dá»¥ng kiá»ƒu <code>Maybe</code> .</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="maybe"></a>Maybe<a class="hash-link" href="#maybe" title="Direct link to heading">#</a></h3><p>Kiá»ƒu <code>Maybe</code>  lÃ  má»™t trong nhá»¯ng loáº¡i há»¯u Ã­ch nháº¥t trong Haskell.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Maybe</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Maybe :: ` -&gt; `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data Maybe a = Nothing | Just a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜GHC.Maybeâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Eq a =&gt; Eq (Maybe a) -- Defined in â€˜GHC.Maybeâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Semigroup a =&gt; Monoid (Maybe a) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Ord a =&gt; Ord (Maybe a) -- Defined in â€˜GHC.Maybeâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Semigroup a =&gt; Semigroup (Maybe a)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Show a =&gt; Show (Maybe a) -- Defined in â€˜GHC.Showâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Read a =&gt; Read (Maybe a) -- Defined in â€˜GHC.Readâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Foldable Maybe -- Defined in â€˜Data.Foldableâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Traversable Maybe -- Defined in â€˜Data.Traversableâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance MonadFail Maybe -- Defined in â€˜Control.Monad.Failâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NÃ³ thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <code>Optional</code> trong cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh khÃ¡c.</p><p>NÃ³ cÃ³ hai hÃ m táº¡o - <code>Nothing</code> , khÃ´ng nháº­n Ä‘á»‘i sá»‘ vÃ  <code>Just</code> - cÃ³ má»™t Ä‘á»‘i sá»‘.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data Maybe a = Nothing | Just a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y xem má»™t vÃ­ dá»¥.</p><p>Trong Haskell, náº¿u báº¡n muá»‘n truyá»n <code>String</code> Ä‘áº¿n má»™t giÃ¡ trá»‹ cÃ³ thá»ƒ hiá»‡n <code>read</code> , báº¡n sáº½ thÆ°á»ng lÃ m Ä‘iá»u nÃ y vá»›i hÃ m <code>read</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week04.Maybe&gt; read &quot;42&quot; :: Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">42</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Tuy nhiÃªn, <code>read</code> hÆ¡i khÃ³ chá»‹u, bá»Ÿi vÃ¬ náº¿u chÃºng ta cÃ³ thá»© gÃ¬ Ä‘Ã³ khÃ´ng thá»ƒ phÃ¢n tÃ­ch cÃº phÃ¡p thÃ nh <code>Int</code> , thÃ¬ chÃºng ta sáº½ gáº·p lá»—i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week04.Maybe&gt; read &quot;42+u&quot; :: Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">*** Exception: Prelude.read: no parse</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y import <code>readMaybe</code> Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ theo cÃ¡ch tá»‘t hÆ¡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Maybe&gt; import Text.Read (readMaybe)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Text.Read Week04.Contract&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ m <code>readMaybe</code> lÃ m tÆ°Æ¡ng tá»± nhÆ° <code>read</code>, nhÆ°ng nÃ³ tráº£ vá» má»™t <code>Maybe</code> vÃ  trong trÆ°á»ng há»£p nÃ³ khÃ´ng thá»ƒ phÃ¢n tÃ­ch cÃº phÃ¡p, nÃ³ sáº½ tráº£ vá» má»™t <code>Maybe</code> Ä‘Æ°á»£c táº¡o báº±ng phÆ°Æ¡ng thá»©c khá»Ÿi táº¡o <code>Nothing</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Text.Read Week04.Contract&gt; readMaybe &quot;42&quot; :: Maybe Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just 42</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Text.Read Week04.Contract&gt; readMaybe &quot;42+u&quot; :: Maybe Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Nothing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Giáº£ sá»­ chÃºng ta muá»‘n táº¡o má»™t hÃ m má»›i tráº£ vá» a <code>Maybe</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: String -&gt; String -&gt; String -&gt; Maybe Int</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Ã tÆ°á»Ÿng lÃ  hÃ m nÃªn cá»‘ gáº¯ng phÃ¢n tÃ­ch cÃº phÃ¡p cáº£ ba <code>Strings</code> lÃ  <code>Ints</code>. Náº¿u táº¥t cáº£ cÃ¡c Strings cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n tÃ­ch cÃº phÃ¡p thÃ nh cÃ´ng thÃ nh <code>Ints</code>, thÃ¬ chÃºng ta muá»‘n cá»™ng ba <code>Ints</code> Ä‘Ã³ Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c má»™t tá»•ng. Náº¿u má»™t trong cÃ¡c phÃ¢n tÃ­ch cÃº phÃ¡p khÃ´ng thÃ nh cÃ´ng, chÃºng tÃ´i muá»‘n quay láº¡i <code>Nothing</code>.</p><p>Má»™t cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ sáº½ lÃ :</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: String -&gt; String -&gt; String -&gt; Maybe Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo x y z = case readMaybe x of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Nothing -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Just k  -&gt; case readMaybe y of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Nothing -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Just l  -&gt; case readMaybe z of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Nothing -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Just m  -&gt; Just (k + l + m)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y xem náº¿u nÃ³ hoáº¡t Ä‘á»™ng. Äáº§u tiÃªn, trÆ°á»ng há»£p thÃ nh cÃ´ng:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :l Week04.Maybe </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Maybe&gt; foo &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just 6</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Tuy nhiÃªn, náº¿u má»™t trong cÃ¡c giÃ¡ trá»‹ khÃ´ng thá»ƒ Ä‘Æ°á»£c phÃ¢n tÃ­ch cÃº phÃ¡p, chÃºng tÃ´i nháº­n Ä‘Æ°á»£c <code>Nothing</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Maybe&gt; foo &quot;&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Nothing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>MÃ£ nÃ y khÃ´ng lÃ½ tÆ°á»Ÿng vÃ¬ chÃºng ta láº·p láº¡i cÃ¹ng má»™t máº«u ba láº§n. Má»—i láº§n chÃºng ta pháº£i xem xÃ©t hai trÆ°á»ng há»£p - káº¿t quáº£ cá»§a phÃ©p Ä‘á»c lÃ  <code>Just</code> hoáº·c <code>Nothing</code>.</p><p>Ask Haskellers, we hate repetition like this.</p><p>Äiá»u chÃºng tÃ´i muá»‘n lÃ m ráº¥t Ä‘Æ¡n giáº£n. ChÃºng tÃ´i muá»‘n vÆ°á»£t qua ba <code>Strings</code> vÃ  thÃªm káº¿t quáº£, nhÆ°ng vá»›i táº¥t cáº£ nhá»¯ng trÆ°á»ng há»£p Ä‘Ã³, nÃ³ ráº¥t á»“n vÃ  ráº¥t xáº¥u. ChÃºng tÃ´i muá»‘n loáº¡i bá» mÃ´ hÃ¬nh nÃ y.</p><p>Má»™t cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ lÃ  xÃ¡c Ä‘á»‹nh má»™t cÃ¡i gÃ¬ Ä‘Ã³ nhÆ°:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">bindMaybe :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindMaybe Nothing = Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindMaybe (Just x) f = f x</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y viáº¿t láº¡i cÃ¹ng má»™t chá»©c nÄƒng báº±ng cÃ¡ch sá»­ dá»¥ng <code>bindMaybe</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; :: String -&gt; String -&gt; String -&gt; Maybe Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; x y z = readMaybe x `bindMaybe` \k -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            readMaybe y `bindMaybe` \l -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            readMaybe z `bindMaybe` \m -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Just (k + l + m)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  sau Ä‘Ã³, trong REPL, chÃºng tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»± <code>foo\&#x27;</code>nhÆ° chÃºng tÃ´i Ä‘Ã£ nháº­n Ä‘Æ°á»£c <code>foo</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Maybe&gt; foo &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just 6</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Maybe&gt; foo &quot;&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Nothing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y thá»±c hiá»‡n chÃ­nh xÃ¡c nhÆ° <code>foo</code>, nhÆ°ng nÃ³ nhá» gá»n hÆ¡n nhiá»u, Ã­t tiáº¿ng á»“n hÆ¡n vÃ  logic kinh doanh rÃµ rÃ ng hÆ¡n nhiá»u.</p><p>NÃ³ cÃ³ thá»ƒ, hoáº·c cÃ³ thá»ƒ khÃ´ng, giÃºp xem chá»©c nÄƒng mÃ  nÃ³ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i kÃ½ hiá»‡u infix:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Text.Read Week04.Maybe&gt; bindMaybe (readMaybe &quot;42&quot; :: Maybe Int) (\x -&gt; Just x)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just 42</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y báº¡n cÃ³ thá»ƒ tháº¥y rÃµ rÃ ng hÃ m láº¥y <code>Maybe</code> vÃ  sau Ä‘Ã³ lÃ  hÃ m láº¥y <code>a</code> tá»« <code>Maybe</code> vÃ  sá»­ dá»¥ng nÃ³ lÃ m Ä‘áº§u vÃ o cho má»™t hÃ m tráº£ vá» má»™t má»›i  <code>Maybe</code>.</p><p>Äiá»u nÃ y táº¡o ra khÃ´ng cÃ³ gÃ¬ há»¯u Ã­ch, cho Ä‘áº¿n khi chÃºng tÃ´i thÃªm <code>readMaybe</code></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Text.Read Week04.Maybe&gt; bindMaybe (readMaybe &quot;42&quot; :: Maybe Int) (\x -&gt; bindMaybe (readMaybe &quot;5&quot; :: Maybe Int) (\y -&gt; Just (y + x)))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just 47</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Theo má»™t sá»‘ cÃ¡ch <code>Nothing</code> ithÃ¬ hÆ¡i giá»‘ng má»™t ngoáº¡i lá»‡ trong cÃ¡c ngÃ´n ngá»¯ khÃ¡c. Náº¿u báº¥t ká»³ phÃ©p tÃ­nh nÃ o tráº£ vá»  <code>Nothing</code>,  pháº§n cÃ²n láº¡i cá»§a phÃ©p tÃ­nh trong khá»‘i khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n vÃ   <code>Nothing</code> Ä‘Æ°á»£c tráº£ vá».</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="má»™t-trong-hai-either"></a>Má»™t trong hai (Either)<a class="hash-link" href="#má»™t-trong-hai-either" title="Direct link to heading">#</a></h3><p>Má»™t kiá»ƒu ráº¥t há»¯u Ã­ch khÃ¡c trong Haskell lÃ  kiá»ƒu <code>Either</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Either</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Either :: ` -&gt; ` -&gt; `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data Either a b = Left a | Right b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative (Either e) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Eq a, Eq b) =&gt; Eq (Either a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor (Either a) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad (Either e) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Ord a, Ord b) =&gt; Ord (Either a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Semigroup (Either a b) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Show a, Show b) =&gt; Show (Either a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Read a, Read b) =&gt; Read (Either a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Foldable (Either a) -- Defined in â€˜Data.Foldableâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Traversable (Either a) -- Defined in â€˜Data.Traversableâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><code>Either</code> nháº­n hai tham sá»‘ <code>a</code> and <code>b</code>.  Giá»‘ng nhÆ° <code>Maybe</code> nÃ³ cÃ³ hai hÃ m táº¡o, nhÆ°ng khÃ´ng giá»‘ng nhÆ° <code>Maybe</code> cáº£ hai Ä‘á»u nháº­n má»™t giÃ¡ trá»‹. NÃ³ cÃ³ thá»ƒ <code>Either</code> lÃ  má»™t <code>a</code> hoáº·c má»™t lÃ  <code>b</code>. Hai hÃ m táº¡o lÃ  <code>Left</code> and <code>Right</code>.</p><p>VÃ­ dá»¥:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; Left &quot;Haskell&quot; :: Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Left &quot;Haskell&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>hoáº·c</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; Right 7 :: Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Right 7</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng ta xem xÃ©t phÃ©p loáº¡i suy ngoáº¡i lá»‡ xa hÆ¡n má»™t chÃºt, thÃ¬ má»™t váº¥n Ä‘á» <code>Maybe</code> lÃ  náº¿u chÃºng ta quay trá»Ÿ láº¡i <code>Nothing</code>, khÃ´ng cÃ³ thÃ´ng bÃ¡o lá»—i. Tuy nhiÃªn, náº¿u chÃºng ta muá»‘n má»™t thá»© gÃ¬ Ä‘Ã³ Ä‘Æ°a ra má»™t thÃ´ng Ä‘iá»‡p, chÃºng ta cÃ³ thá»ƒ thay tháº¿ <code>Maybe</code>báº±ng <code>Either</code>.</p><p>Trong trÆ°á»ng há»£p Ä‘Ã³, <code>Right</code> cÃ³ thá»ƒ tÆ°Æ¡ng á»©ng vá»›i <code>Just</code>vÃ  <code>Left</code> cÃ³ thá»ƒ tÆ°Æ¡ng á»©ng vá»›i má»™t lá»—i, nhÆ° <code>Nothing</code> Ä‘Ã£ lÃ m. Tuy nhiÃªn, tÃ¹y thuá»™c vÃ o loáº¡i mÃ  chÃºng tÃ´i chá»n cho <code>a</code>, chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ°a ra cÃ¡c thÃ´ng bÃ¡o lá»—i thÃ­ch há»£p.</p><p>HÃ£y Ä‘á»‹nh nghÄ©a má»™t cÃ¡i gÃ¬ Ä‘Ã³ Ä‘Æ°á»£c gá»i <code>readEither</code> vÃ  xem nÃ³ lÃ m gÃ¬ khi cÃ³ thá»ƒ vÃ  khi nÃ o nÃ³ khÃ´ng thá»ƒ phÃ¢n tÃ­ch cÃº phÃ¡p Ä‘áº§u vÃ o cá»§a nÃ³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">readEither :: Read a =&gt; String -&gt; Either String a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">readEither s case readMaybe s of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Nothing -&gt; Left $ &quot;can&#x27;t parse: &quot; ++ s</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Just a  -&gt; Right a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Either&gt; readEither &quot;42&quot; :: Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Right 42</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Either&gt; readEither &quot;42+u&quot; :: Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Left &quot;can&#x27;t parse: 42+u&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Sá»­ dá»¥ng Ä‘iá»u nÃ y, bÃ¢y giá» chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i <code>foo</code> báº±ng <code>Either</code>. Äáº§u tiÃªn, sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p dÃ i dÃ²ng:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: String -&gt; String -&gt; String -&gt; Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo x y z = case readEither x of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Left err -&gt; Left err</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Right k  -&gt; case readEither y of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Left err -&gt; Left err</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Right l  -&gt; case readEither z of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Left err -&gt; Left err</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Right m  -&gt; Right (k + l + m)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y thá»­ nÃ³. Äáº§u tiÃªn, Ä‘Æ°á»ng dáº«n tá»‘t:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Either&gt; foo &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Right 6</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>sau Ä‘Ã³ cÃ³ váº¥n Ä‘á»:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Either&gt; foo &quot;ays&quot; &quot;2&quot; &quot;3&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Left &quot;can&#x27;t parse: ays&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>hÆ°ng, chÃºng tÃ´i cÃ³ cÃ¹ng má»™t váº¥n Ä‘á» mÃ  chÃºng tÃ´i Ä‘Ã£ gáº·p pháº£i <code>Maybe</code>; chÃºng tÃ´i cÃ³ ráº¥t nhiá»u sá»± láº·p láº¡i.</p><p>Giáº£i phÃ¡p cÅ©ng tÆ°Æ¡ng tá»±.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">bindEither :: Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindEither (Left err) _ = Left err</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindEither (Right x)  f = f x</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; :: String -&gt; String -&gt; String -&gt; Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; x y z = readEither x `bindEither` \k -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            readEither y `bindEither` \l -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            readEither z `bindEither` \m -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Right (k + l + m)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Báº¡n cÃ³ thá»ƒ cháº¡y láº¡i Ä‘iá»u nÃ y trong REPL vÃ  nÃ³ sáº½ hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° phiÃªn báº£n dÃ i dÃ²ng cá»§a nÃ³.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="writer"></a>Writer<a class="hash-link" href="#writer" title="Direct link to heading">#</a></h3><p>Cho Ä‘áº¿n nay chÃºng tÃ´i Ä‘Ã£ xem xÃ©t ba vÃ­ dá»¥: <code>IO a</code>, <code>Maybe a</code> vÃ  <code>Either String a</code>. <code>IO a</code> Ä‘áº¡i diá»‡n cho cÃ¡c káº¿ hoáº¡ch cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n cÃ¡c tÃ¡c dá»¥ng phá»¥ vÃ  khi Ä‘Æ°á»£c thá»±c hiá»‡n, táº¡o ra má»™t <code>a</code>. <code>Maybe a</code> vÃ  <code>Either String a</code> Ä‘áº¡i diá»‡n cho cÃ¡c phÃ©p tÃ­nh cÃ³ thá»ƒ táº¡o ra  <code>a</code> nhÆ°ng cÅ©ng cÃ³ thá»ƒ tháº¥t báº¡i. Sá»± khÃ¡c biá»‡t giá»¯a <code>Maybe</code> vÃ  <code>Either</code> chá»‰ <code>Maybe</code> khÃ´ng táº¡o ra báº¥t ká»³ thÃ´ng bÃ¡o lá»—i nÃ o, nhÆ°ng  <code>Either</code> thÃ¬ cÃ³.</p><p>BÃ¢y giá» chÃºng ta hÃ£y xem xÃ©t má»™t vÃ­ dá»¥ hoÃ n toÃ n khÃ¡c ghi láº¡i Ã½ tÆ°á»Ÿng vá» cÃ¡c phÃ©p tÃ­nh cÅ©ng cÃ³ thá»ƒ táº¡o ra Ä‘áº§u ra nháº­t kÃ½.</p><p>ChÃºng ta cÃ³ thá»ƒ biá»ƒu diá»…n Ä‘iá»u Ä‘Ã³ báº±ng má»™t kiá»ƒu.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data Writer a = Writer a [String]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   deriving Show</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ­ dá»¥, hÃ£y viáº¿t má»™t hÃ m tráº£ vá»  <code>Writer</code> cho  <code>Int</code> vÃ  viáº¿t má»™t thÃ´ng bÃ¡o nháº­t kÃ½.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">number :: Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">number n = Writer n $ [&quot;number: &quot; ++ show n]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Writer&gt; number 42</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Writer 42 [&quot;number: 42&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng ta hÃ£y lÃ m Ä‘iá»u gÃ¬ Ä‘Ã³ tÆ°Æ¡ng tá»± nhÆ° chÃºng ta Ä‘Ã£ lÃ m vá»›i <code>Maybe</code>vÃ   <code>Either</code>.</p><p>HÃ£y viáº¿t má»™t hÃ m sá»­ dá»¥ng ba phÃ©p tÃ­nh ghi nháº­t kÃ½ mÃ  má»—i phÃ©p tÃ­nh táº¡o ra má»™t <code>Int</code> vÃ  chÃºng ta muá»‘n tráº£ vá» má»™t phÃ©p tÃ­nh duy nháº¥t táº¡o ra tá»•ng cá»§a cÃ¡c phÃ©p tÃ­nh Ä‘Ã³ <code>Int</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: Writer Int -&gt; Writer Int -&gt; Writer Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo (Writer k xs) (Writer l ys) (Writer m zs) =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Writer (K + l + m) $ xs ++ ys ++ zs</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Writer&gt; foo (number 1) (number 2) (number 3)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Writer 6 [&quot;number: 1&quot;,&quot;number: 2&quot;,&quot;number: 3&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», hÃ£y viáº¿t má»™t hÃ m há»¯u Ã­ch khÃ¡c cÃ³ danh sÃ¡ch thÃ´ng bÃ¡o vÃ  cÃ¡c nhÃ  sáº£n xuáº¥t má»™t <code>Writer</code> khÃ´ng cÃ³ káº¿t quáº£ há»¯u Ã­ch.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">tell :: [String] -&gt; Writer ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">tell = Writer ()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng tÃ´i cÃ³ thá»ƒ cáº­p nháº­t <code>foo</code> Ä‘á»ƒ thÃªm má»™t thÃ´ng bÃ¡o nháº­t kÃ½ bá»• sung hiá»ƒn thá»‹ tá»•ng cÃ¡c sá»‘.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo :: Writer Int -&gt; Writer Int -&gt; Writer Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo (Writer k xs) (Writer l ys) (Writer m zs) =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">let</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   s = k + l + m</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Writer _ us = tell [&quot;sum: &quot; ++ show s]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">in</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Writer s $ xs ++ ys ++ zs ++ us</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In the REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Writer&gt; foo (number 1) (number 2) (number 3)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Writer 6 [&quot;number: 1&quot;,&quot;number: 2&quot;,&quot;number: 3&quot;,&quot;sum: 6&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NhÆ° trÆ°á»›c Ä‘Ã¢y, chÃºng ta cÃ³ thá»ƒ viáº¿t má»™t hÃ m rÃ ng buá»™c:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">bindWriter :: Writer a -&gt; (a -&gt; Writer b) -&gt; Writer b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindWriter (Writer a xs) f =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">let</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Writer b ys = f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">in</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   Writer b $ xs ++ ys</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y, <code>bindWriter</code> hÃ m Ä‘Æ°á»£c tráº£ láº¡i <code>Writer b</code> vÃ  sáº£n xuáº¥t thÃ´ng Ä‘iá»‡p log Ä‘Ã³ lÃ  má»™t ná»‘i cá»§a <code>xs</code> mÃ  chÃºng ta mÃ´ hÃ¬nh phÃ¹ há»£p trÃªn Ä‘áº§u vÃ o, vÃ  <code>ys</code> mÃ  chÃºng ta mÃ´ hÃ¬nh phÃ¹ há»£p khi gá»i <code>f a</code> Ä‘á»ƒ sáº£n xuáº¥t cÃ¡c <code>Writer b</code> .</p><p>BÃ¢y giá», chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i <code>foo</code> báº±ng <code>bindWriter</code> vÃ  lÃ m cho nÃ³ Ä‘áº¹p hÆ¡n nhiá»u.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; :: Writer Int -&gt; Writer Int -&gt; Writer Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27; x y z = x `bindWriter` \k -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            y `bindWriter` \l -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            z `bindWriter` \m -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            let s = k + l + m</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            in tell [&quot;sum: &quot; ++ show s] `bindWriter` \_ -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">               Writer s []</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Nhá»¯ng gÃ¬ chÃºng tÃ´i Ä‘Ã£ lÃ m vá»›i <code>foo\&#x27;</code>trÆ°á»›c Ä‘Ã¢y, bÃ¢y giá» chÃºng tÃ´i cÃ³ thá»ƒ lÃ m vá»›i foo &#x27; , vÃ  chÃºng tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»±.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Writer&gt; foo&#x27; (number 1) (number 2) (number 3)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Writer 6 [&quot;number: 1&quot;,&quot;number: 2&quot;,&quot;number: 3&quot;,&quot;sum: 6&quot;]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Pháº£i thá»«a nháº­n ráº±ng nÃ³ dÃ i hÆ¡n trÆ°á»›c, nhÆ°ng nÃ³ Ä‘áº¹p hÆ¡n ráº¥t nhiá»u. ChÃºng tÃ´i khÃ´ng cÃ²n cáº§n thá»±c hiá»‡n Ä‘á»‘i sÃ¡nh máº«u Ä‘á»ƒ trÃ­ch xuáº¥t cÃ¡c thÃ´ng bÃ¡o. ChÃºng tÃ´i khÃ´ng cáº§n pháº£i káº¿t há»£p cÃ¡c thÃ´ng bÃ¡o nháº­t kÃ½ má»™t cÃ¡ch rÃµ rÃ ng, nÆ¡i chÃºng tÃ´i cÃ³ thá»ƒ máº¯c lá»—i vÃ  quÃªn má»™t hoáº·c sai thá»© tá»±. Thay vÃ o Ä‘Ã³, chÃºng tÃ´i trá»«u tÆ°á»£ng hÃ³a táº¥t cáº£ nhá»¯ng thá»© Ä‘Ã³ Ä‘i vÃ  chá»‰ cÃ³ thá»ƒ táº­p trung vÃ o logic kinh doanh.</p><p>Máº·c dÃ¹ mÃ´ hÃ¬nh giá»‘ng nhÆ° vá»›i <code>Maybe</code> and <code>Either</code>, lÆ°u Ã½ ráº±ng khÃ­a cáº¡nh Ä‘áº·c biá»‡t cá»§a cÃ¡c tÃ­nh toÃ¡n nÃ y lÃ  hoÃ n toÃ n khÃ¡c nhau. Vá»›i <code>Maybe</code> and <code>Either</code>, chÃºng tÃ´i xá»­ lÃ½ khÃ¡i niá»‡m tháº¥t báº¡i, trong khi á»Ÿ Ä‘Ã¢y, vá»›i <code>Writer</code>, khÃ´ng cÃ³ tháº¥t báº¡i, mÃ  thay vÃ o Ä‘Ã³ chÃºng tÃ´i cÃ³ thÃªm Ä‘áº§u ra.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="what-is-a-monad"></a>What is a Monad?<a class="hash-link" href="#what-is-a-monad" title="Direct link to heading">#</a></h3><p>BÃ¢y giá», chÃºng ta cÃ³ thá»ƒ giáº£i thÃ­ch Monad lÃ  gÃ¬.</p><p>NhÃ¬n láº¡i bá»‘n vÃ­ dá»¥, chÃºng cÃ³ Ä‘iá»ƒm gÃ¬ chung? Trong táº¥t cáº£ bá»‘n trÆ°á»ng há»£p, ChÃºng tÃ´i Ä‘Ã£ cÃ³ má»™t constructor loáº¡i vá»›i má»™t tham sá»‘ kiá»ƒu -  <code>IO</code>,
<code>Maybe</code>, <code>Either String</code> and <code>Writer</code> cáº£ pháº£i máº¥t má»™t tham sá»‘ kiá»ƒu.</p><p>VÃ , Ä‘á»‘i vá»›i táº¥t cáº£ bá»‘n vÃ­ dá»¥ nÃ y, chÃºng tÃ´i cÃ³ má»™t hÃ m rÃ ng buá»™c. Äá»‘i vá»›i <code>IO</code>, chÃºng tÃ´i cÃ³ <code>\&gt;\&gt;=</code> chá»©c nÄƒng vÃ  Ä‘á»‘i vá»›i nhá»¯ng ngÆ°á»i khÃ¡c, chÃºng tÃ´i cÃ³ cÃ¡c chá»©c nÄƒng rÃ ng buá»™c mÃ  chÃºng tÃ´i tá»± viáº¿t. </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">bindWriter :: Writer a -&gt; (a -&gt; Writer b) -&gt; Writer b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindEither :: Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">bindMaybe :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a rÃ ng buá»™c tÃ¹y thuá»™c vÃ o tá»«ng trÆ°á»ng há»£p. Trong trÆ°á»ng há»£p cá»§a <code>IO</code> nÃ³ lÃ  phÃ©p thuáº­t tÃ­ch há»£p sáºµn, nhÆ°ng báº¡n cÃ³ thá»ƒ nghÄ© nÃ³ chá»‰ lÃ  káº¿t há»£p hai káº¿ hoáº¡ch mÃ´ táº£ cÃ¡c hÃ nh Ä‘á»™ng cáº§n thá»±c hiá»‡n trong quÃ¡ trÃ¬nh tÃ­nh toÃ¡n. Äá»‘i vá»›i <code>bindMaybe</code> vÃ  <code>bindEither</code> logic lÃ  toÃ n bá»™ káº¿ hoáº¡ch sáº½ tháº¥t báº¡i náº¿u báº¥t ká»³ pháº§n nÃ o cá»§a nÃ³ khÃ´ng thÃ nh cÃ´ng vÃ  Ä‘á»‘i vá»›i <code>bindWriter</code>, logic lÃ  káº¿t há»£p danh sÃ¡ch cÃ¡c thÃ´ng bÃ¡o nháº­t kÃ½.</p><p>VÃ  Ä‘Ã³ lÃ  Ã½ tÆ°á»Ÿng chÃ­nh cá»§a Monads. ÄÃ³ lÃ  má»™t khÃ¡i niá»‡m vá» tÃ­nh toÃ¡n vá»›i má»™t sá»‘ tÃ¡c dá»¥ng phá»¥ bá»• sung vÃ  kháº£ nÄƒng liÃªn káº¿t hai phÃ©p tÃ­nh Ä‘Ã³ láº¡i vá»›i nhau.</p><p>CÃ³ má»™t khÃ­a cáº¡nh khÃ¡c mÃ  chÃºng tÃ´i Ä‘Ã£ Ä‘á» cáº­p ngáº¯n gá»n trong trÆ°á»ng há»£p IO nhÆ°ng khÃ´ng pháº£i Ä‘á»‘i vá»›i cÃ¡c vÃ­ dá»¥ khÃ¡c - má»™t Ä‘iá»u khÃ¡c mÃ  chÃºng tÃ´i luÃ´n cÃ³ thá»ƒ lÃ m.</p><p>Báº¥t cá»© khi nÃ o chÃºng ta cÃ³ khÃ¡i niá»‡m tÃ­nh toÃ¡n vá»›i cÃ¡c tÃ¡c dá»¥ng phá»¥ nhÆ° váº­y, chÃºng ta cÅ©ng luÃ´n cÃ³ kháº£ nÄƒng táº¡o ra má»™t phÃ©p tÃ­nh kiá»ƒu nÃ y <code>doesn\&#x27;t</code> cÃ³ báº¥t ká»³ tÃ¡c dá»¥ng phá»¥ nÃ o.</p><p>Trong vÃ­ dá»¥ cá»§a <code>IO</code>, Ä‘iá»u nÃ y Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i <code>return</code>. Vá»›i má»™t <code>a</code>, báº¡n cÃ³ thá»ƒ táº¡o má»™t <code>IO a</code> cÃ´ng thá»©c luÃ´n tráº£ vá» Ä‘Æ¡n giáº£n mÃ  akhÃ´ng cÃ³ tÃ¡c dá»¥ng phá»¥. Má»—i vÃ­ dá»¥ khÃ¡c cÅ©ng cÃ³ kháº£ nÄƒng nÃ y, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ bÃªn dÆ°á»›i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">return              :: a -&gt; IO a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Just                :: a -&gt; Maybe a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Right               :: a -&gt; Either String a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(\a -&gt; Writer a []) :: a -&gt; Writer a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  chÃ­nh sá»± káº¿t há»£p cá»§a hai Ä‘áº·c Ä‘iá»ƒm nÃ y Ä‘Ã£ xÃ¡c Ä‘á»‹nh má»™t ÄÆ¡n nguyÃªn.</p><p>kháº£ nÄƒng liÃªn káº¿t hai phÃ©p tÃ­nh vá»›i nhau
kháº£ nÄƒng xÃ¢y dá»±ng má»™t phÃ©p tÃ­nh tá»« má»™t giÃ¡ trá»‹ thuáº§n tÃºy mÃ  khÃ´ng sá»­ dá»¥ng báº¥t ká»³ tÃ¡c dá»¥ng phá»¥ tiá»m áº©n nÃ o
Náº¿u chÃºng ta xem trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Monad</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Monad :: (` -&gt; `) -&gt; Constraint</span></div><div class="token-line" style="color:#393A34"><span class="token plain">class Applicative m =&gt; Monad m where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&gt;&gt;) :: m a -&gt; m b -&gt; m b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">return :: a -&gt; m a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{-# MINIMAL (&gt;&gt;=) #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad (Either e) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad [] -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad ((-&gt;) r) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b, Monoid c) =&gt; Monad ((,,,) a b c)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b) =&gt; Monad ((,,) a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid a =&gt; Monad ((,) a) -- Defined in â€˜GHC.Baseâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i tháº¥y chá»©c nÄƒng rÃ ng buá»™c</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  <code>return</code> hÃ m nháº­n má»™t giÃ¡ trá»‹ thuáº§n tÃºy vÃ  biáº¿n nÃ³ thÃ nh má»™t phÃ©p tÃ­nh tiá»m áº©n tÃ¡c dá»¥ng phá»¥, nhÆ°ng khÃ´ng sá»­ dá»¥ng chÃºng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">return :: a -&gt; m a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The other function <code>\&gt;\&gt;</code> can easily be defined in terms of <code>\&gt;\&gt;=</code>, but
is provided for convenience.
CÃ¡c chá»©c nÄƒng khÃ¡c <code>\&gt;\&gt;</code> cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh vá» máº·t <code>\&gt;\&gt;=</code>, nhÆ°ng Ä‘Æ°á»£c cung cáº¥p Ä‘á»ƒ thuáº­n tiá»‡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(&gt;&gt;) :: m a -&gt; m b -&gt; m b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Nhá»¯ng gÃ¬ hÃ m nÃ y lÃ m lÃ  loáº¡i bá» káº¿t quáº£ cá»§a phÃ©p tÃ­nh Ä‘áº§u tiÃªn, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh nÃ³ theo nghÄ©a <code>\&gt;\&gt;=</code> chá»‰ báº±ng cÃ¡ch bá» qua Ä‘á»‘i sá»‘ cá»§a tham sá»‘ hÃ m.</p><p>CÃ³ má»™t tÃ­nh toÃ¡n ká»¹ thuáº­t khÃ¡c. ChÃºng tÃ´i tháº¥y ráº±ng MonadcÃ³ siÃªu lá»›p <code>Applicative</code>, vÃ¬ váº­y má»i ÄÆ¡n nguyÃªn Ä‘á»u nhÆ° váº­y <code>Applicative</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Applicative</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Applicative :: (` -&gt; `) -&gt; Constraint</span></div><div class="token-line" style="color:#393A34"><span class="token plain">class Functor f =&gt; Applicative f where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">pure :: a -&gt; f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&lt;`&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">GHC.Base.liftA2 :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(`&gt;) :: f a -&gt; f b -&gt; f b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&lt;`) :: f a -&gt; f b -&gt; f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{-# MINIMAL pure, ((&lt;`&gt;) | liftA2) #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative (Either e) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative [] -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative ((-&gt;) r) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b, Monoid c) =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         Applicative ((,,,) a b c)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b) =&gt; Applicative ((,,) a b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid a =&gt; Applicative ((,) a) -- Defined in â€˜GHC.Baseâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i tháº¥y nÃ³ cÃ³ má»™t loáº¡t cÃ¡c chá»©c nÄƒng, nhÆ°ng chÃºng tÃ´i chá»‰ cáº§n hai chá»©c nÄƒng Ä‘áº§u tiÃªn.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pure :: a -&gt; f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&lt;`&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ m <code>pure</code> cÃ³ cÃ¹ng kiá»ƒu chá»¯ kÃ½ vá»›i <code>return</code>. Sau Ä‘Ã³, cÃ³ <code>\&lt;\&gt;</code> (phÃ¡t Ã¢m lÃ  &#x27;ap&#x27;) trÃ´ng phá»©c táº¡p hÆ¡n má»™t chÃºt. NhÆ°ng, sá»± tháº­t lÃ , má»™t khi báº¡n cÃ³ returnvÃ  <code>\&gt;\&gt;=</code> á»Ÿ trong ÄÆ¡n nguyÃªn, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng xÃ¡c Ä‘á»‹nh cáº£ hai purevÃ  <code>\&lt;\&gt;</code>.</p><p>ChÃºng tÃ´i tháº¥y ráº±ng <code>Applicative</code> cÅ©ng cÃ³ má»™t lá»›p cha <code>Functor</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; :i Functor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Functor :: (` -&gt; `) -&gt; Constraint</span></div><div class="token-line" style="color:#393A34"><span class="token plain">class Functor f where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fmap :: (a -&gt; b) -&gt; f a -&gt; f b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">(&lt;$) :: a -&gt; f b -&gt; f a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{-# MINIMAL fmap #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor (Either a) -- Defined in â€˜Data.Eitherâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor [] -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor Maybe -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor IO -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((-&gt;) r) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,,,) a b c) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,,) a b) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor ((,) a) -- Defined in â€˜GHC.Baseâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NhÆ° chÃºng ta Ä‘Ã£ Ä‘á» cáº­p trong ngá»¯ cáº£nh <code>IO</code>, <code>Functor</code> cÃ³ má»™t hÃ m <code>fmap</code>, Ä‘Æ°á»£c cho trÆ°á»›c má»™t hÃ m tá»« <code>a</code> to <code>b</code>sáº½ biáº¿n má»™t <code>f a</code> thÃ nh má»™t <code>f b</code>.</p><p>VÃ­ dá»¥ nguyÃªn máº«u cho <code>fmap</code> lÃ  danh sÃ¡ch á»Ÿ Ä‘Ã¢u chÃ­nh <code>fmap</code> lÃ  <code>fmap</code>. Cho má»™t hÃ m tá»« <code>a</code> to <code>b</code>, báº¡n cÃ³ thá»ƒ táº¡o má»™t danh sÃ¡ch kiá»ƒu btá»« má»™t danh sÃ¡ch kiá»ƒu abáº±ng cÃ¡ch Ã¡p dá»¥ng maphÃ m cho tá»«ng pháº§n tá»­ cá»§a danh sÃ¡ch.</p><p>Má»™t láº§n ná»¯a, má»™t khi báº¡n cÃ³ <code>return</code> and <code>\&gt;\&gt;=</code>, tháº­t dá»… dÃ ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh <code>fmap</code>.</p><p>VÃ¬ váº­y, báº¥t cá»© khi nÃ o báº¡n muá»‘n xÃ¡c Ä‘á»‹nh ÄÆ¡n nguyÃªn, báº¡n chá»‰ cáº§n xÃ¡c Ä‘á»‹nh <code>return</code> vÃ  <code>\&gt;\&gt;=</code>, vÃ  Ä‘á»ƒ lÃ m cho trÃ¬nh biÃªn dá»‹ch hÃ i lÃ²ng vÃ  Ä‘Æ°a ra cÃ¡c thá»ƒ hiá»‡n cho <code>Functor</code> and <code>Applicative</code>, luÃ´n cÃ³ má»™t cÃ¡ch tiÃªu chuáº©n Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³.</p><p>ChÃºng ta cÃ³ thá»ƒ lÃ m Ä‘iá»u nÃ y trong vÃ­ dá»¥ cá»§a <code>Writer</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import Control.Monad</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Functor Writer where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   fmap = liftM</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Applicative Writer where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   pure = return</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (&lt;`&gt;) = ap</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monad Writer where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   return a = Writer a []</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (&gt;&gt;=) = bindWriter</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta khÃ´ng cáº§n pháº£i lÃ m nhÆ° váº­y Ä‘á»‘i vá»›i <code>Maybe</code>, <code>Either</code> or <code>IO</code> vÃ¬ chÃºng Ä‘Ã£ lÃ  ÄÆ¡n nguyÃªn Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi KhÃºc dáº¡o Ä‘áº§u.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="táº¡i-sao-Ä‘iá»u-nÃ y-há»¯u-Ã­ch"></a>Táº¡i sao Ä‘iá»u nÃ y há»¯u Ã­ch?<a class="hash-link" href="#táº¡i-sao-Ä‘iá»u-nÃ y-há»¯u-Ã­ch" title="Direct link to heading">#</a></h3><p>NÃ³i chung, nÃ³ luÃ´n há»¯u Ã­ch Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»™t máº«u chung vÃ  Ä‘áº·t tÃªn cho nÃ³.</p><p>NhÆ°ng, cÃ³ láº½ lá»£i tháº¿ quan trá»ng nháº¥t lÃ  cÃ³ ráº¥t nhiá»u chá»©c nÄƒng khÃ´ng quan tÃ¢m Ä‘áº¿n ÄÆ¡n vá»‹ nÃ o mÃ  chÃºng ta Ä‘ang xá»­ lÃ½ - chÃºng sáº½ hoáº¡t Ä‘á»™ng vá»›i táº¥t cáº£ ÄÆ¡n vá»‹.</p><p>HÃ£y tá»•ng quÃ¡t hÃ³a vÃ­ dá»¥ nÆ¡i chÃºng ta tÃ­nh tá»•ng cá»§a ba sá»‘ nguyÃªn. ChÃºng tÃ´i sá»­ dá»¥ng má»™t <code>let</code> trong vÃ­ dá»¥ bÃªn dÆ°á»›i vÃ¬ nhá»¯ng lÃ½ do sáº½ trá»Ÿ nÃªn rÃµ rÃ ng trong giÃ¢y lÃ¡t.`</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">threeInts :: Monad m =&gt; m Int -&gt; m Int -&gt; m Int -&gt; m Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">threeInts mx my mz =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   mx &gt;&gt;= \k -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   my &gt;&gt;= \l -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   mz &gt;&gt;= \m -&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   let s = k + l + m in return s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá» chÃºng ta cÃ³ chá»©c nÄƒng nÃ y, chÃºng ta cÃ³ thá»ƒ quay láº¡i <code>Maybe</code> vÃ­ dá»¥ vÃ  viáº¿t láº¡i nÃ³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; :: String -&gt; String -&gt; String -&gt; Maybe Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; x y z = threeInts (readMaybe x) (readMaybe y) (readMaybe z)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta cÃ³ thá»ƒ lÃ m tÆ°Æ¡ng tá»± cho <code>Either</code> vÃ­ dá»¥. </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; :: String -&gt; String -&gt; String -&gt; Either String Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; x y z = threeInts (readEither x) (readEither y) (readEither z)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ¡c <code>Writer</code>  vÃ­ dá»¥ khÃ´ng pháº£i lÃ  giá»‘ng há»‡t nhau.</p><p>Náº¿u chÃºng tÃ´i khÃ´ng hÃ i lÃ²ng khi khÃ´ng cÃ³ thÃ´ng bÃ¡o nháº­t kÃ½ cho tá»•ng, nÃ³ ráº¥t Ä‘Æ¡n giáº£n vÃ¬ nÃ³ Ä‘Ã£ lÃ  má»™t vÃ­ dá»¥ cá»§a</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; :: Writer Int -&gt; Writer Int -&gt; Writer Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; x y z = threeInts</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Tuy nhiÃªn, náº¿u chÃºng ta muá»‘n thÃ´ng bÃ¡o nháº­t kÃ½ cuá»‘i cÃ¹ng, nÃ³ sáº½ trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n má»™t chÃºt.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; :: Writer Int -&gt; Writer Int -&gt; Writer Int -&gt; Writer Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo&#x27;&#x27; x y z = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   s &lt;- threeInts x y z</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   tell [&quot;sum: &quot; ++ show s]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   return s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u báº¡n nhÃ¬n vÃ o mÃ´-Ä‘un Control.Monad trong Haskell Prelude tiÃªu chuáº©n, báº¡n sáº½ tháº¥y ráº±ng cÃ³ ráº¥t nhiá»u chá»©c nÄƒng há»¯u Ã­ch mÃ  báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cho táº¥t cáº£ cÃ¡c ÄÆ¡n nguyÃªn.</p><p>Má»™t cÃ¡ch Ä‘á»ƒ nghÄ© vá» ÄÆ¡n nguyÃªn lÃ  tÃ­nh toÃ¡n vá»›i má»™t siÃªu nÄƒng lá»±c.</p><p>Trong trÆ°á»ng há»£p cá»§a <code>IO</code>, siÃªu sá»©c máº¡nh sáº½ cÃ³ tÃ¡c dá»¥ng phá»¥ trong tháº¿ giá»›i thá»±c. Trong trÆ°á»ng há»£p cá»§a <code>Maybe</code>, siÃªu sá»©c máº¡nh cÃ³ thá»ƒ bá»‹ há»ng. Sá»©c máº¡nh siÃªu viá»‡t cá»§a <code>Either</code>lÃ  khÃ´ng thÃ nh cÃ´ng vá»›i má»™t thÃ´ng bÃ¡o lá»—i. VÃ  trong trÆ°á»ng há»£p cá»§a <code>Writer</code>, siÃªu sá»©c máº¡nh lÃ  ghi láº¡i cÃ¡c tin nháº¯n.</p><p>CÃ³ má»™t cÃ¢u nÃ³i trong cá»™ng Ä‘á»“ng Haskell ráº±ng Haskell cÃ³ dáº¥u cháº¥m pháº©y quÃ¡ táº£i. Giáº£i thÃ­ch cho Ä‘iá»u nÃ y lÃ  trong nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh má»‡nh lá»‡nh, báº¡n cÃ³ dáº¥u cháº¥m pháº©y káº¿t thÃºc báº±ng dáº¥u cháº¥m pháº©y - má»—i cÃ¢u lá»‡nh Ä‘Æ°á»£c thá»±c thi láº§n lÆ°á»£t, má»—i cÃ¢u cÃ¡ch nhau báº±ng dáº¥u cháº¥m pháº©y. NhÆ°ng, chÃ­nh xÃ¡c dáº¥u cháº¥m pháº©y cÃ³ nghÄ©a lÃ  gÃ¬ phá»¥ thuá»™c vÃ o ngÃ´n ngá»¯. VÃ­ dá»¥, cÃ³ thá»ƒ cÃ³ má»™t ngoáº¡i lá»‡, trong trÆ°á»ng há»£p Ä‘Ã³, quÃ¡ trÃ¬nh tÃ­nh toÃ¡n sáº½ dá»«ng láº¡i vÃ  khÃ´ng tiáº¿p tá»¥c vá»›i cÃ¡c dÃ²ng tiáº¿p theo.</p><p>Theo má»™t nghÄ©a nÃ o Ä‘Ã³, <code>bind</code> giá»‘ng nhÆ° dáº¥u cháº¥m pháº©y. VÃ  Ä‘iá»u thÃº vá»‹ vá» Haskell lÃ  nÃ³ lÃ  má»™t dáº¥u cháº¥m pháº©y cÃ³ thá»ƒ láº­p trÃ¬nh Ä‘Æ°á»£c. ChÃºng ta cÃ³ thá»ƒ nÃ³i logic lÃ  gÃ¬ Ä‘á»ƒ káº¿t há»£p hai phÃ©p tÃ­nh vá»›i nhau.</p><p>Má»—i ÄÆ¡n nguyÃªn Ä‘i kÃ¨m vá»›i &quot;dáº¥u cháº¥m pháº©y&quot; riÃªng.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="kÃ½-hiá»‡u-do"></a>kÃ½ hiá»‡u \&#x27;do\&#x27;<a class="hash-link" href="#kÃ½-hiá»‡u-do" title="Direct link to heading">#</a></h3><p>Bá»Ÿi vÃ¬ mÃ´ hÃ¬nh nÃ y ráº¥t phá»• biáº¿n vÃ  cÃ¡c phÃ©p tÃ­nh Ä‘Æ¡n láº» á»Ÿ kháº¯p nÆ¡i, cÃ³ má»™t kÃ½ hiá»‡u Ä‘áº·c biá»‡t cho Ä‘iá»u nÃ y trong Haskell, Ä‘Æ°á»£c gá»i lÃ  kÃ½ hiá»‡u <code>do </code>.</p><p>NÃ³ lÃ  Ä‘Æ°á»ng cÃº phÃ¡p. HÃ£y viáº¿t láº¡i <code>threeInts</code> sbáº±ng cÃ¡ch sá»­ dá»¥ng kÃ½ hiá»‡u<code>do</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">threeInts&#x27; :: Monad m =&gt; m Int -&gt; m Int -&gt; m Int -&gt; m Int</span></div><div class="token-line" style="color:#393A34"><span class="token plain">threeInts&#x27; mx my mz = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   k &lt;- mx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   l &lt;- my</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   m &lt;- mz</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   let s = k + l + m</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   return s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y thá»±c hiá»‡n chÃ­nh xÃ¡c nhá»¯ng Ä‘iá»u tÆ°Æ¡ng tá»± nhÆ° <code>non-do</code> phiÃªn báº£n, nhÆ°ng nÃ³ cÃ³ Ã­t tiáº¿ng á»“n hÆ¡n.</p><p>LÆ°u Ã½ ráº±ng <code>let</code> cÃ¢u lá»‡nh khÃ´ng sá»­ dá»¥ng má»™t <code>in</code> pháº§n. NÃ³ khÃ´ng cáº§n pháº£i bÃªn trong má»™t khá»‘i <code>do</code>.</p><p>VÃ  Ä‘Ã³ lÃ  <code>Monads</code>. CÃ²n ráº¥t nhiá»u Ä‘iá»u Ä‘á»ƒ nÃ³i vá» chÃºng nhÆ°ng hy vá»ng bÃ¢y giá» báº¡n Ä‘Ã£ biáº¿t Ä‘Æ°á»£c <code>Monads</code> lÃ  gÃ¬ vÃ  chÃºng hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o.</p><p>ThÆ°á»ng thÃ¬ báº¡n á»Ÿ trong má»™t tÃ¬nh huá»‘ng mÃ  báº¡n muá»‘n cÃ³ nhiá»u hiá»‡u á»©ng cÃ¹ng má»™t lÃºc - vÃ­ dá»¥, báº¡n cÃ³ thá»ƒ muá»‘n andthÃ´ng bÃ¡o nháº­t kÃ½ lá»—i tÃ¹y chá»n . CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ trong Haskell. VÃ­ dá»¥, cÃ³ Monad Transformers nÆ¡i vá» cÆ¡ báº£n ngÆ°á»i ta cÃ³ thá»ƒ xÃ¢y dá»±ng cÃ¡c Monad tÃ¹y chá»‰nh vá»›i cÃ¡c tÃ­nh nÄƒng mÃ  báº¡n muá»‘n.</p><p>CÃ³ nhá»¯ng cÃ¡ch tiáº¿p cáº­n khÃ¡c. Má»™t Ä‘Æ°á»£c gá»i lÃ  Há»‡ thá»‘ng Hiá»‡u á»©ng, cÃ³ má»¥c tiÃªu tÆ°Æ¡ng tá»±. VÃ  Ä‘Ã¢y tÃ¬nh cá» lÃ  thá»© mÃ  Plutus sá»­ dá»¥ng cho cÃ¡c MÃ´n phÃ¡i quan trá»ng. Äáº·c biá»‡t lÃ  ÄÆ¡n vá»‹ liÃªn há»‡ trong vÃ­ vÃ  ÄÆ¡n vá»‹ theo dÃµi Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra mÃ£ Plutus.</p><p>Tin tá»‘t lÃ  báº¡n khÃ´ng cáº§n pháº£i hiá»ƒu Há»‡ thá»‘ng Hiá»‡u á»©ng Ä‘á»ƒ lÃ m viá»‡c vá»›i cÃ¡c ÄÆ¡n nguyÃªn nÃ y. Báº¡n chá»‰ cáº§n biáº¿t ráº±ng báº¡n Ä‘ang lÃ m viá»‡c vá»›i Monad, vÃ  nÃ³ cÃ³ siÃªu nÄƒng lá»±c nÃ o.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="plutus-monads"></a>Plutus Monads<a class="hash-link" href="#plutus-monads" title="Direct link to heading">#</a></h2><p>BÃ¢y giá» chÃºng ta Ä‘Ã£ tháº¥y cÃ¡ch viáº¿t mÃ£ Ä‘Æ¡n nguyÃªn, báº±ng cÃ¡ch sá»­ dá»¥ng rÃ ng buá»™c vÃ  tráº£ vá» hoáº·c báº±ng cÃ¡ch sá»­ dá»¥ng kÃ½ hiá»‡u, chÃºng ta cÃ³ thá»ƒ xem má»™t ÄÆ¡n nguyÃªn ráº¥t quan trá»ng, Ä‘Ã³ lÃ  ÄÆ¡n nguyÃªn há»£p Ä‘á»“ng, mÃ  báº¡n cÃ³ thá»ƒ Ä‘Ã£ nháº­n tháº¥y trong cÃ¡c vÃ­ dá»¥ mÃ£ trÆ°á»›c Ä‘Ã³.</p><p>ÄÆ¡n nguyÃªn há»£p Ä‘á»“ng xÃ¡c Ä‘á»‹nh mÃ£ sáº½ cháº¡y trong vÃ­, Ä‘Ã¢y lÃ  pháº§n ngoÃ i chuá»—i cá»§a Plutus.</p><p>Tuy nhiÃªn, trÆ°á»›c khi Ä‘i vÃ o chi tiáº¿t, chÃºng ta sáº½ nÃ³i vá» ÄÆ¡n nguyÃªn thá»© hai, ÄÆ¡n nguyÃªn EmulatorTrace.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="the-emulatortrace-monad"></a>The EmulatorTrace Monad<a class="hash-link" href="#the-emulatortrace-monad" title="Direct link to heading">#</a></h3><p>Báº¡n cÃ³ thá»ƒ Ä‘Ã£ tá»± há»i liá»‡u cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ thá»±c thi mÃ£ Plutus cho má»¥c Ä‘Ã­ch thá»­ nghiá»‡m mÃ  khÃ´ng cáº§n sá»­ dá»¥ng SÃ¢n chÆ¡i Plutus hay khÃ´ng. Thá»±c sá»± lÃ  cÃ³, vÃ  Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng <code>EmulatorTrace Monad</code>.</p><p>Báº¡n cÃ³ thá»ƒ nghÄ© vá» má»™t chÆ°Æ¡ng trÃ¬nh trong Ä‘Æ¡n nguyÃªn nÃ y giá»‘ng nhÆ° nhá»¯ng gÃ¬ chÃºng tÃ´i thá»±c hiá»‡n thá»§ cÃ´ng trong <code>simulator</code> tab cá»§a sÃ¢n chÆ¡i. NghÄ©a lÃ , chÃºng tÃ´i xÃ¡c Ä‘á»‹nh cÃ¡c Ä‘iá»u kiá»‡n ban Ä‘áº§u, chÃºng tÃ´i xÃ¡c Ä‘á»‹nh cÃ¡c hÃ nh Ä‘á»™ng cháº³ng háº¡n nhÆ° vÃ­ nÃ o gá»i Ä‘iá»ƒm cuá»‘i nÃ o vá»›i cÃ¡c tham sá»‘ nÃ o vÃ  chÃºng tÃ´i xÃ¡c Ä‘á»‹nh khoáº£ng thá»i gian chá» giá»¯a cÃ¡c hÃ nh Ä‘á»™ng.</p><p>CÃ¡c Ä‘á»‹nh nghÄ©a liÃªn quan náº±m trong gÃ³i <code>plutus-contract</code> trong mÃ´-Ä‘un <code>Plutus.Trace.Emulator</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">module Plutus.Trace.Emulator</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Chá»©c nÄƒng cÆ¡ báº£n nháº¥t Ä‘Æ°á»£c gá»i <code>runEmulatorTrace</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- | Run an emulator trace to completion, returning a tuple of the final state</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- of the emulator, the events, and any error, if any.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTrace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    :: EmulatorConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -&gt; EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -&gt; ([EmulatorEvent], Maybe EmulatorErr, EmulatorState)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTrace cfg trace =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    (\(xs :&gt; (y, z)) -&gt; (xs, y, z))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $ run</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $ runReader ((initialDist . _initialChainState) cfg)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $ foldEmulatorStreamM (generalize list)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $ runEmulatorStream cfg trace</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NÃ³ nháº­n Ä‘Æ°á»£c má»™t thá»© gá»i lÃ  má»™t <code>EmulatorConfig</code> vÃ  <code>EmulatorTrace ()</code>, lÃ  má»™t phÃ©p tÃ­nh thuáº§n tÃºy mÃ  khÃ´ng cÃ³ tÃ¡c dá»¥ng phá»¥ trong tháº¿ giá»›i thá»±c. NÃ³ lÃ  má»™t chá»©c nÄƒng thuáº§n tÃºy thá»±c hiá»‡n theo dÃµi trÃªn má»™t blockchain Ä‘Æ°á»£c mÃ´ phá»ng, sau Ä‘Ã³ Ä‘Æ°a ra káº¿t quáº£ lÃ  má»™t danh sÃ¡ch cÃ¡c <code>EmulatorState</code>, cÃ³ thá»ƒ lÃ  lá»—i, náº¿u cÃ³, vÃ  cuá»‘i cÃ¹ng lÃ  káº¿t quáº£ cuá»‘i cÃ¹ng <code>EmulatorState</code>.</p><p><code>EmulatorConfig</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong má»™t mÃ´-Ä‘un khÃ¡c trong cÃ¹ng má»™t gÃ³i:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">module Wallet.Emulator.Stream</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data EmulatorConfig =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">EmulatorConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    { _initialChainState      :: InitialChainState -- ^ State of the blockchain at the beginning of the simulation. Can be given as a map of funds to wallets, or as a block of transactions.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    } deriving (Eq, Show)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type InitialChainState = Either InitialDistribution Block</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i tháº¥y nÃ³ chá»‰ cÃ³ má»™t trÆ°á»ng, thuá»™c loáº¡i <code>InitialChainState</code> vÃ  nÃ³ lÃ <code>InitialDistribution</code> hoáº·c <code>Block</code>.</p><p><code>InitialDistribution</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong má»™t mÃ´-Ä‘un khÃ¡c trong cÃ¹ng má»™t gÃ³i vÃ  nÃ³ lÃ  má»™t tá»« Ä‘á»“ng nghÄ©a kiá»ƒu cho má»™t báº£n Ä‘á»“ cÃ¡c cáº·p giÃ¡ trá»‹ khÃ³a tá»«  <code>Wallet</code>s dáº¿n <code>Value</code>s, nhÆ° báº¡n mong Ä‘á»£i. <code>Value</code> cÃ³ thá»ƒ lÃ  mÃ£ thÃ´ng bÃ¡o Ä‘Ã¡ng yÃªu hoáº·c mÃ£ nguá»“n gá»‘c.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">module Plutus.Contract.Trace</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type InitialDistribution = Map Wallet Value</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Trong cÃ¹ng má»™t mÃ´-Ä‘un, chÃºng ta tháº¥y má»™t thá»© Ä‘Æ°á»£c gá»i lÃ  <code>defaultDist</code> nÃ³ tráº£ vá» phÃ¢n phá»‘i máº·c Ä‘á»‹nh cho táº¥t cáº£ cÃ¡c vÃ­. NÃ³ lÃ m Ä‘iá»u nÃ y báº±ng cÃ¡ch Ä‘i qua 10 vÃ­ xÃ¡c Ä‘á»‹nh bá»Ÿi <code>allWallets</code> Ä‘á»ƒ <code>defaultDistFor</code> mÃ  pháº£i mang má»™t danh sÃ¡ch cÃ¡c vÃ­.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- | The wallets used in mockchain simulations by default. There are</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--   ten wallets because the emulator comes with ten private keys.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">allWallets :: [EM.Wallet]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">allWallets = EM.Wallet &lt;$&gt; [1 .. 10]</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultDist :: InitialDistribution</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultDist = defaultDistFor allWallets</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultDistFor :: [EM.Wallet] -&gt; InitialDistribution</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultDistFor wallets = Map.fromList $ zip wallets (repeat (Ada.lovelaceValueOf 100_000_000))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i cÃ³ thá»ƒ thá»­ Ä‘iá»u nÃ y trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week04.Contract&gt; import Plutus.Trace.Emulator</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Week04.Contract&gt; import Plutus.Contract.Trace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Week04.Contract&gt; defaultDist</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fromList [(Wallet 1,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 2,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 3,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 4,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 5,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 6,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 7,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 8,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 9,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 10,Value (Map [(,Map [(&quot;&quot;,100000000)])]))]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng má»—i vÃ­ trong sá»‘ 10 vÃ­ Ä‘Ã£ Ä‘Æ°á»£c phÃ¢n phá»‘i ban Ä‘áº§u lÃ  100.000.000 lovelace.</p><p>ChÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ láº¥y sá»‘ dÆ° cho má»™t vÃ­ cá»¥ thá»ƒ hoáº·c cÃ¡c vÃ­:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Week04.Contract&gt; defaultDistFor [Wallet 1]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">fromList [(Wallet 1,Value (Map [(,Map [(&quot;&quot;,100000000)])]))]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u báº¡n muá»‘n cÃ¡c giÃ¡ trá»‹ ban Ä‘áº§u khÃ¡c nhau, náº¿u báº¡n muá»‘n mÃ£ thÃ´ng bÃ¡o gá»‘c, thÃ¬ báº¡n pháº£i chá»‰ Ä‘á»‹nh giÃ¡ trá»‹ Ä‘Ã³ theo cÃ¡ch thá»§ cÃ´ng.</p><p>HÃ£y xem nhá»¯ng gÃ¬ chÃºng ta cáº§n Ä‘á»ƒ cháº¡y dáº¥u váº¿t Ä‘áº§u tiÃªn cá»§a mÃ¬nh:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Week04.Contract&gt; :t runEmulatorTrace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTrace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">:: EmulatorConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; ([Wallet.Emulator.MultiAgent.EmulatorEvent], Maybe EmulatorErr,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Wallet.Emulator.MultiAgent.EmulatorState)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p> váº­y, chÃºng ta cáº§n má»™t <code>EmulatorConfig</code> cÃ¡i mÃ  chÃºng ta biáº¿t cáº§n má»™t cÃ¡i <code>InitialChainState</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Week04.Contract&gt; import Wallet.Emulator.Stream </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator.Stream Week04.Contract&gt; :i InitialChainState </span></div><div class="token-line" style="color:#393A34"><span class="token plain">type InitialChainState :: `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type InitialChainState =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Either InitialDistribution Ledger.Blockchain.Block</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      -- Defined in â€˜Wallet.Emulator.Streamâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng ta thá»±c hiá»‡n <code>Left</code> cá»§a <code>defaultDist</code> chÃºc sáº½ nháº­n Ä‘Æ°á»£c má»™t
<code>InitialDistribution</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator.Stream Week04.Contract&gt; :t Left defaultDist</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Left defaultDist :: Either InitialDistribution b</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ táº¡o má»™t <code>EmulatorConfig</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator.Stream Week04.Contract&gt; EmulatorConfig $ Left defaultDist</span></div><div class="token-line" style="color:#393A34"><span class="token plain">EmulatorConfig {_initialChainState = Left (fromList [(Wallet 1,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 2,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 3,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 4,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 5,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 6,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 7,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 8,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 9,Value (Map [(,Map [(&quot;&quot;,100000000)])])),(Wallet 10,Value (Map [(,Map [(&quot;&quot;,100000000)])]))])}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ¬ váº­y, chÃºng ta hÃ£y thá»­ <code>runEmulatorTrace</code>. Nhá»› láº¡i ráº±ng, cÅ©ng nhÆ° vÃ <code>EmulatorConfig</code>, chÃºng ta cÅ©ng cáº§n chuyá»ƒn vÃ o má»™t <code>EmulatorTrace</code>vÃ  cÃ¡i Ä‘Æ¡n giáº£n nháº¥t mÃ  chÃºng ta cÃ³ thá»ƒ táº¡o chá»‰ Ä‘Æ¡n giáº£n lÃ  má»™t cÃ¡i tráº£ vá» Unit - <code>return ()</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTrace (EmulatorConfig $ Left defaultDist) $ return ()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u báº¡n cháº¡y Ä‘iá»u nÃ y trong REPL, báº¡n sáº½ nháº­n Ä‘Æ°á»£c má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u xuáº¥t ra báº£ng Ä‘iá»u khiá»ƒn, máº·c dÃ¹ chÃºng tÃ´i khÃ´ng lÃ m gÃ¬ vá»›i dáº¥u váº¿t. Náº¿u báº¡n muá»‘n lÃ m cho nÃ³ trá»Ÿ nÃªn há»¯u Ã­ch, báº±ng cÃ¡ch nÃ o Ä‘Ã³, báº¡n pháº£i lá»c táº¥t cáº£ dá»¯ liá»‡u nÃ y thÃ nh má»™t thá»© há»£p lÃ½ vÃ  tá»•ng há»£p nÃ³ theo má»™t cÃ¡ch nÃ o Ä‘Ã³.</p><p>May máº¯n thay, cÃ³ nhá»¯ng chá»©c nÄƒng khÃ¡c <code>runEmulatorTrace</code>. Má»™t trong sá»‘ Ä‘Ã³ lÃ  <code>runEmulatorTraceIo</code> cháº¡y mÃ´ phá»ng sau Ä‘Ã³ xuáº¥t ra á»Ÿ dáº¡ng Ä‘áº¹p trÃªn mÃ n hÃ¬nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTraceIO</span></div><div class="token-line" style="color:#393A34"><span class="token plain">:: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTraceIO = runEmulatorTraceIO&#x27; def def</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äá»ƒ sá»­ dá»¥ng hÃ m nÃ y, chÃºng ta khÃ´ng cáº§n chá»‰ Ä‘á»‹nh <code>EmulatorConfig</code> nhÆ° chÃºng ta Ä‘Ã£ lÃ m trÆ°á»›c Ä‘Ã¢y, vÃ¬ theo máº·c Ä‘á»‹nh sáº½ chá»‰ sá»­ dá»¥ng phÃ¢n phá»‘i máº·c Ä‘á»‹nh.</p><p>Trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude...&gt; runEmulatorTraceIO $ return ()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 3: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 4: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 5: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 6: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 7: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 8: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 9: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>And we see a much more manageable, concise output. Nothing happens, but
we see the Genesis transaction and then the final balances for each
wallet.</p><p>If you want more control, there is also <code>runEmulatorTraceIO\&#x27;</code>, which
does take an <code>EmulatorConfig</code>, so we could specify a different
distribution.
VÃ  chÃºng tÃ´i tháº¥y má»™t Ä‘áº§u ra ngáº¯n gá»n, dá»… quáº£n lÃ½ hÆ¡n nhiá»u. KhÃ´ng cÃ³ gÃ¬ xáº£y ra, nhÆ°ng chÃºng tÃ´i tháº¥y giao dá»‹ch Genesis vÃ  sau Ä‘Ã³ lÃ  sá»‘ dÆ° cuá»‘i cÃ¹ng cho má»—i vÃ­.</p><p>Náº¿u báº¡n muá»‘n kiá»ƒm soÃ¡t nhiá»u hÆ¡n, thÃ¬ cÅ©ng cÃ³ <code>runEmulatorTraceIO\&#x27;</code>, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  <code>EmulatorConfig</code>, vÃ¬ váº­y chÃºng tÃ´i cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh má»™t phÃ¢n phá»‘i khÃ¡c.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTraceIO&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">:: TraceConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; EmulatorConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-&gt; IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">runEmulatorTraceIO&#x27; tcfg cfg trace</span></div><div class="token-line" style="color:#393A34"><span class="token plain">= runPrintEffect (outputHandle tcfg) $ runEmulatorTraceEff tcfg cfg trace</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NÃ³ cÅ©ng cÃ³ má»™t  <code>TraceConfig</code>, cÃ³ hai trÆ°á»ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data TraceConfig = TraceConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{ showEvent    :: EmulatorEvent&#x27; -&gt; Maybe String</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- ^ Function to decide how to print the particular events.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">, outputHandle :: Handle</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- ^ Where to print the outputs to. Default: &#x27;System.IO.stdout&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The first field, <code>showEvent</code> is a function that specifies which
<code>EmulatorEvent</code>s are displayed and how they are displayed. It takes an
<code>EmulatorEvent</code> as an argument and can return <code>Nothing</code> it the event
should not be displayed, or a <code>Just</code> with a <code>String</code> showing how the
event will be displayed.</p><p>Here is the default <code>TraceConfig</code> used by <code>runEmulatorTraceIO</code>. We can
see that most events are ignored and that we only get output for some of
the events.
TrÆ°á»ng Ä‘áº§u tiÃªn, <code>showEvent</code> lÃ  má»™t hÃ m chá»‰ Ä‘á»‹nh cÃ¡i mÃ  cÃ¡c <code>EmulatorEvent</code>s Ä‘Æ°á»£c hiá»ƒn thá»‹ vÃ  cÃ¡ch chÃºng Ä‘Æ°á»£c hiá»ƒn thá»‹. NÃ³ nháº­n má»™t <code>EmulatorEvent</code> Ä‘á»‘i sá»‘ nhÆ° má»™t Ä‘á»‘i sá»‘ vÃ  cÃ³ thá»ƒ tráº£ vá» <code>Nothing </code> nÃ³ náº¿u sá»± kiá»‡n sáº½ khÃ´ng Ä‘Æ°á»£c hiá»ƒn thá»‹ hoáº·c má»™t <code>Just</code> vá»›i má»™t <code>String</code> cÃ¡ch hiá»ƒn thá»‹ sá»± kiá»‡n sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹.</p><p>ÄÃ¢y lÃ  máº·c Ä‘á»‹nh <code>TraceConfig</code> Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi <code>runEmulatorTraceIO</code>. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng háº§u háº¿t cÃ¡c sá»± kiá»‡n Ä‘á»u bá»‹ bá» qua vÃ  chÃºng ta chá»‰ nháº­n Ä‘Æ°á»£c káº¿t quáº£ cho má»™t sá»‘ sá»± kiá»‡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">instance Default TraceConfig where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">def = TraceConfig</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            { showEvent     = defaultShowEvent</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            , outputHandle  = stdout</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultShowEvent :: EmulatorEvent&#x27; -&gt; Maybe String</span></div><div class="token-line" style="color:#393A34"><span class="token plain">defaultShowEvent = \case</span></div><div class="token-line" style="color:#393A34"><span class="token plain">UserThreadEvent (UserLog msg)                                        -&gt; Just $ &quot;*** USER LOG: &quot; &lt;&gt; msg</span></div><div class="token-line" style="color:#393A34"><span class="token plain">InstanceEvent (ContractInstanceLog (ContractLog (A.String msg)) _ _) -&gt; Just $ &quot;*** CONTRACT LOG: &quot; &lt;&gt; show msg</span></div><div class="token-line" style="color:#393A34"><span class="token plain">InstanceEvent (ContractInstanceLog (StoppedWithError err)       _ _) -&gt; Just $ &quot;*** CONTRACT STOPPED WITH ERROR: &quot; &lt;&gt; show err</span></div><div class="token-line" style="color:#393A34"><span class="token plain">InstanceEvent (ContractInstanceLog NoRequestsHandled            _ _) -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">InstanceEvent (ContractInstanceLog (HandledRequest _)           _ _) -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">InstanceEvent (ContractInstanceLog (CurrentRequests _)          _ _) -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">SchedulerEvent _                                                     -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ChainIndexEvent _ _                                                  -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">WalletEvent _ _                                                      -&gt; Nothing</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ev                                                                   -&gt; Just . renderString . layoutPretty defaultLayoutOptions . pretty $ ev</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>TrÆ°á»ng thá»© hai lÃ  má»™t xá»­ lÃ½ Ä‘Æ°á»£c Ä‘áº·t máº·c Ä‘á»‹nh <code>stdout</code>, nhÆ°ng chÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh má»™t tá»‡p á»Ÿ Ä‘Ã¢y.</p><p>BÃ¢y giá» chÃºng ta hÃ£y xem xÃ©t má»™t dáº¥u váº¿t thÃº vá»‹ hÆ¡n, sá»­ dá»¥ng <code>Vesting</code> há»£p Ä‘á»“ng tá»« bÃ i giáº£ng trÆ°á»›c.</p><p>Äáº§u tiÃªn, chÃºng tÃ´i xÃ¡c Ä‘á»‹nh má»™t <code>Trace</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myTrace :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">h1 &lt;- activateContractWallet (Wallet 1) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">h2 &lt;- activateContractWallet (Wallet 2) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">callEndpoint @&quot;give&quot; h1 $ GiveParams</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      { gpBeneficiary = pubKeyHash $ walletPubKey $ Wallet 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      , gpDeadline    = Slot 20</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      , gpAmount      = 1000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">void $ waitUntilSlot 20</span></div><div class="token-line" style="color:#393A34"><span class="token plain">callEndpoint @&quot;grab&quot; h2 ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">void $ waitNSlots 1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u Ä‘áº§u tiÃªn chÃºng ta pháº£i lÃ m lÃ  kÃ­ch hoáº¡t vÃ­ báº±ng cÃ¡ch sá»­ dá»¥ng chá»©c nÄƒng Ä‘Æ¡n nguyÃªn <code>activateContractWallet</code>. ChÃºng ta liÃªn káº¿t káº¿t quáº£ cá»§a hÃ m nÃ y vá»›i <code>h1</code>, vÃ  sau Ä‘Ã³ liÃªn káº¿t káº¿t quáº£ cá»§a cuá»™c gá»i thá»© hai (Ä‘á»‘i vá»›i Wallet 2) vá»›i <code>h2</code>. Hai giÃ¡ trá»‹ Ä‘Ã³ - <code>h1</code>vÃ  <code>h2</code>Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»‘i vá»›i vÃ­ tÆ°Æ¡ng á»©ng cá»§a chÃºng.</p><p>Tiáº¿p theo, chÃºng tÃ´i sá»­ dá»¥ng <code>callEndpoint</code> Ä‘á»ƒ mÃ´ phá»ng VÃ­ 1 gá»i <code>give</code> Ä‘iá»ƒm cuá»‘i, vá»›i cÃ¡c thÃ´ng sá»‘ Ä‘Æ°á»£c hiá»ƒn thá»‹. Sau Ä‘Ã³, chÃºng tÃ´i chá» Ä‘á»£i Ä‘áº¿n vá»‹ trÃ­ 20. HÃ m <code>waitUntilSlot</code> thá»±c sá»± tráº£ vá» má»™t giÃ¡ trá»‹ Ä‘áº¡i diá»‡n cho vá»‹ trÃ­ Ä‘Ã£ Ä‘áº¡t Ä‘áº¿n, nhÆ°ng vÃ¬ chÃºng tÃ´i khÃ´ng quan tÃ¢m Ä‘áº¿n giÃ¡ trá»‹ Ä‘Ã³ á»Ÿ Ä‘Ã¢y, chÃºng tÃ´i sá»­ dá»¥ng <code>void</code> Ä‘á»ƒ bá» qua nÃ³. Sau Ä‘Ã³, chÃºng tÃ´i mÃ´ phá»ng cuá»™c gá»i Ä‘áº¿n <code>grab</code> Ä‘iá»ƒm cuá»‘i báº±ng VÃ­ 2.</p><p>BÃ¢y giá», chÃºng ta cÃ³ thá»ƒ viáº¿t má»™t hÃ m Ä‘á»ƒ gá»i <code>runEmulatorTraceIO</code> vá»›i out <code>Trace</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">test :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test = runEmulatorTraceIO myTrace</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ , sau Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ cháº¡y Ä‘iá»u nÃ y trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; test</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;give&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;gpAmount&quot;,Number 1000.0),(&quot;gpBeneficiary&quot;,Object (fromList [(&quot;getPubKeyHash&quot;,String &quot;39f713d0a644253f04529421b9f51b9b08979d08295959c4f3990ee617f5139f&quot;)])),(&quot;gpDeadline&quot;,Object (fromList [(&quot;getSlot&quot;,Number 20.0)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W1: TxSubmit: 49f326a21c09ba52eddee46b65bdb5fb33b3444745e9af1510a68f9043696eba</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 49f326a21c09ba52eddee46b65bdb5fb33b3444745e9af1510a68f9043696eba</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: *** CONTRACT LOG: &quot;made a gift of 1000 lovelace to 39f713d0a644253f04529421b9f51b9b08979d08295959c4f3990ee617f5139f with deadline Slot {getSlot = 20}&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: SlotAdd Slot 3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00003: SlotAdd Slot 4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00004: SlotAdd Slot 5</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00005: SlotAdd Slot 6</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00006: SlotAdd Slot 7</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00007: SlotAdd Slot 8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00008: SlotAdd Slot 9</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00009: SlotAdd Slot 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00010: SlotAdd Slot 11</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00011: SlotAdd Slot 12</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00012: SlotAdd Slot 13</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00013: SlotAdd Slot 14</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00014: SlotAdd Slot 15</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00015: SlotAdd Slot 16</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00016: SlotAdd Slot 17</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00017: SlotAdd Slot 18</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00018: SlotAdd Slot 19</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00019: SlotAdd Slot 20</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00020: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;grab&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Array [])]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00020: W2: TxSubmit: d9a2028384b4472242371f27cb51727f5c7c04327972e4278d1f69f606019a8b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00020: TxnValidate d9a2028384b4472242371f27cb51727f5c7c04327972e4278d1f69f606019a8b</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00020: SlotAdd Slot 21</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00021: *** CONTRACT LOG: &quot;collected gifts&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00021: SlotAdd Slot 22</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99998990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 3: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 4: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 5: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 6: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 7: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 8: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 9: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äáº§u ra nÃ y ráº¥t giá»‘ng vá»›i Ä‘áº§u ra mÃ  chÃºng ta tháº¥y trong playground. ChÃºng ta cÃ³ thá»ƒ tháº¥y giao dá»‹ch Genesis cÅ©ng nhÆ° cáº£ giao dá»‹ch <code>give</code>vÃ  <code>grab</code> giao dá»‹ch tá»« <code>Trace</code>. ChÃºng ta cÅ©ng cÃ³ thá»ƒ tháº¥y má»™t sá»‘ Ä‘áº§u ra nháº­t kÃ½ tá»« chÃ­nh há»£p Ä‘á»“ng, cÃ³ tiá»n tá»‘ lÃ  <code>CONTRACT LOG</code>.</p><p>ChÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ Ä‘Äƒng nháº­p tá»« bÃªn trong <code>Trace</code> Ä‘Æ¡n nguyÃªn. VÃ­ dá»¥, chÃºng tÃ´i cÃ³ thá»ƒ xem káº¿t quáº£ cá»§a <code>waitNSlots</code> cuá»™c gá»i cuá»‘i cÃ¹ng :</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myTrace :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">s &lt;- waitNSlots 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Extras.logInfo $ &quot;reached slot &quot; ++ show s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Sau Ä‘Ã³, chÃºng tÃ´i sáº½ tháº¥y káº¿t quáº£ nÃ y khi chÃºng tÃ´i cháº¡y mÃ´ phá»ng:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00020: SlotAdd Slot 21</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00021: *** USER LOG: reached slot Slot {getSlot = 21}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00021: *** CONTRACT LOG: &quot;collected gifts&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00021: SlotAdd Slot 22</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá» chÃºng ta hÃ£y nhÃ¬n vÃ o Contract Monad.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="the-contract-monad"></a>The Contract Monad<a class="hash-link" href="#the-contract-monad" title="Direct link to heading">#</a></h3><p>Má»¥c Ä‘Ã­ch cá»§a ÄÆ¡n nguyÃªn há»£p Ä‘á»“ng lÃ  xÃ¡c Ä‘á»‹nh mÃ£ ngoÃ i chuá»—i cháº¡y trong vÃ­. NÃ³ cÃ³ bá»‘n tham sá»‘ kiá»ƒu:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">newtype Contract w s e a = Contract { unContract :: Eff (ContractEffs w s e) a }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      deriving newtype (Functor, Applicative, Monad)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><code>a</code> nhÆ° trong má»i ÄÆ¡n nguyÃªn - nÃ³ biá»ƒu thá»‹ kiá»ƒu káº¿t quáº£ cá»§a phÃ©p tÃ­nh.</p><p>ChÃºng ta sáº½ Ä‘i vÃ o chi tiáº¿t hÆ¡n ba pháº§n khÃ¡c sau nhÆ°ng chá»‰ ngáº¯n gá»n:</p><ul><li>w giá»‘ng nhÆ° vÃ­ dá»¥ Ä‘Æ¡n nguyÃªn <code>Writer</code> cá»§a chÃºng tÃ´i, nÃ³ cho phÃ©p chÃºng tÃ´i viáº¿t cÃ¡c thÃ´ng bÃ¡o kiá»ƒu nháº­t kÃ½ <code>w</code>.</li><li>s mÃ´ táº£ cÃ¡c kháº£ nÄƒng cá»§a blockchain, vÃ­ dá»¥ nhÆ° Ä‘á»£i má»™t vá»‹ trÃ­, gá»­i giao dá»‹ch, láº¥y khÃ³a cÃ´ng khai cá»§a vÃ­. NÃ³ cÅ©ng cÃ³ thá»ƒ chá»©a cÃ¡c Ä‘iá»ƒm cuá»‘i cá»¥ thá»ƒ.</li><li>e mÃ´ táº£ loáº¡i thÃ´ng bÃ¡o lá»—i mÃ  Ä‘Æ¡n nguyÃªn nÃ y cÃ³ thá»ƒ nÃ©m ra.
HÃ£y viáº¿t má»™t vÃ­ dá»¥.</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myContract1 :: Contract () BlockchainActions Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myContract1 = Contract.logInfo @String &quot;Hello from the contract!&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>á» Ä‘Ã¢y , Chung tÃ´i Ä‘Æ°a <code>Contract</code> xÃ¢y dá»±ng vá»›i <code>Unit</code> nhÆ° lÃ  kiá»ƒu <code>w</code>vÃ  <code>BlockchainActions</code> nhÆ° lÃ  Ä‘á»‘i sá»‘ thá»© 2 <code>s</code>. Äiá»u nÃ y cho phÃ©p chÃºng tÃ´i truy cáº­p vÃ o táº¥t cáº£ cÃ¡c hÃ nh Ä‘á»™ng cá»§a blockchain - Ä‘iá»u duy nháº¥t chÃºng tÃ´i khÃ´ng thá»ƒ lÃ m lÃ  gá»i cÃ¡c Ä‘iá»ƒm cuá»‘i cá»¥ thá»ƒ.</p><p>Äá»‘i vá»›i <code>e</code> - loáº¡i thÃ´ng bÃ¡o lá»—i, ChÃºng tÃ´i sá»­ dá»¥ng <code>Text</code>. <code>Text</code> trong Haskell Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° lÃ  <code>String</code>, nhÆ°ng nÃ³ hiá»‡u quáº£ hÆ¡n nhiá»u</p><p>ChÃºng tÃ´i khÃ´ng muá»‘n má»™t káº¿t quáº£ cá»¥ thá»ƒ, vÃ¬ váº­y chÃºng tÃ´i sá»­ dá»¥ng <code>Unit</code> thay cho  <code>a</code>.</p><p>Äá»‘i vá»›i pháº§n thÃ¢n hÃ m, chÃºng tÃ´i viáº¿t má»™t thÃ´ng bÃ¡o nháº­t kÃ½. ChÃºng tÃ´i sá»­ dá»¥ng <code>\@String</code>. bá»Ÿi vÃ¬, chÃºng tÃ´i Ä‘Ã£ imported kiá»ƒ <code>Data.Text</code> VÃ  sá»­ dá»¥ng <code>OverloadedStrings</code> trong GHC biÃªn dá»‹ch, vÃ¬ váº­y trÃ¬nh biÃªn dá»‹ch cáº§n biáº¿t loáº¡i mÃ  chÃºng tÃ´i Ä‘ang tham chiáº¿u - má»™t <code>Text</code> hoáº·c má»™t <code>String</code>. Chung tÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng<code>\@String</code> Náº¿u chÃºng tÃ´i sá»­ dá»¥ng tÃ¹y biáº¿n biÃªn dichij <code>TypeApplications</code>.</p><p>BÃ¢y giá» chung ta Ä‘á»‹nh nghÄ©a <code>Trace</code> báº¯t Ä‘áº§u cháº¡y há»£p Ä‘á»“ng trong vÃ­ vÃ  hÃ m <code>test</code> Ä‘á»ƒ cháº¡y nÃ³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myTrace1 :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace1 = void $ activateContractWallet (Wallet 1) myContract1</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test1 :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test1 = runEmulatorTraceIO myTrace1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng tÃ´i cháº¡y Ä‘iá»u nÃ y trong REPL, chÃºng tÃ´i sáº½ tháº¥y thÃ´ng bÃ¡o nháº­t kÃ½ cá»§a chÃºng tÃ´i tá»« há»£p Ä‘á»“ng..</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.Prelude"><div tabindex="0" class="prism-code language-{.Prelude codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: *** CONTRACT LOG: \&quot;Hello from the contract!\&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance stopped (no errors)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 3: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 4: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 5: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 6: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 7: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 8: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 9: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, \&quot;\&quot;}: 100000000}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», hÃ£y xÃ©m má»™t ngoáº¡i lá»‡.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myContract1 :: Contract () BlockchainActions Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myContract1 = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">void $ Contract.throwError &quot;BOOM!&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract.logInfo @String &quot;Hello from the contract!&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Nhá»› láº¡i ráº±ng chÃºng tÃ´i Ä‘Ã£ chá»n loáº¡i <code>Text</code> lÃ m thÃ´ng bÃ¡o lá»—i. </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; test1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: *** CONTRACT STOPPED WITH ERROR: &quot;\&quot;BOOM!\&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 3: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 4: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 5: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 6: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 7: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 8: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 9: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng tÃ´i khÃ´ng nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o nháº­t kÃ½, nhÆ°ng chÃºng tÃ´i Ä‘Æ°á»£c thÃ´ng bÃ¡o ráº±ng há»£p Ä‘á»“ng Ä‘Ã£ dá»«ng do lá»—i vÃ  chÃºng tÃ´i tháº¥y thÃ´ng bÃ¡o ngoáº¡i lá»‡ cá»§a mÃ¬nh.</p><p>Má»™t Ä‘iá»u khÃ¡c báº¡n cÃ³ thá»ƒ lÃ m lÃ  xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p ngoáº¡i lá»‡. ChÃºng tÃ´i sáº½ sá»­ dá»¥ng hÃ m <code>handleError</code> tá»« mÃ´-Ä‘un<code>Plutus.Contract.Types</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">handleError ::</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      forall w s e e&#x27; a.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      (e -&gt; Contract w s e&#x27; a)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      -&gt; Contract w s e a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      -&gt; Contract w s e&#x27; a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">handleError f (Contract c) = Contract c&#x27; where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      c&#x27; = E.handleError @e (raiseUnderN @&#x27;[E.Error e&#x27;] c) (fmap unContract f)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ¡c hÃ m <code>handleError</code> vÃ  hÃ m <code>Contract</code> xá»­ lÃ½ lá»—i . TTrÃ¬nh xá»­ lÃ½ lá»—i nháº­n má»™t Ä‘á»‘i sá»‘ kiá»ƒu <code>e</code> tá»« há»£p Ä‘á»“ng cá»§a chÃºng tÃ´i vÃ  tráº£ vá» má»™t Ä‘á»‘i sá»‘ má»›i  <code>Contract</code> nhÆ° má»™t tham sá»‘ thá»© nháº¥t, nhÆ°ng chÃºng ta cÃ³ thá»ƒ thay Ä‘á»•i kiá»ƒu cá»§a <code>e</code>  - kiá»ƒu lá»—i, Ä‘Æ°á»£c thá»ƒ hiá»‡n trong danh sÃ¡ch Ä‘á»‘i sá»‘ <code>Contract</code> nhÆ° lÃ  <code>e\&#x27;</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myContract2 :: Contract () BlockchainActions Void ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myContract2 = Contract.handleError</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      (\err -&gt; Contract.logError $ &quot;Caught error: &quot; ++ unpack err)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      myContract1</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace2 :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace2 = void $ activateContractWallet (Wallet 1) myContract2</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test2 :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test2 = runEmulatorTraceIO myTrace2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i sá»­ dá»¥ng loáº¡i <code>Void</code> lÃ m loáº¡i lá»—i. <code>Void</code> lÃ  má»™t loáº¡i khÃ´ng cÃ³ giÃ¡ trá»‹, vÃ¬ váº­y, báº±ng cÃ¡ch sá»­ dá»¥ng loáº¡i nÃ y, chÃºng tÃ´i muá»‘n nÃ³i ráº±ng khÃ´ng thá»ƒ cÃ³ báº¥t ká»³ sai sÃ³t nÃ o Ä‘á»‘i vá»›i há»£p Ä‘á»“ng nÃ y.</p><p><em>ChÃº Ã½</em></p><p>HÃ m <code>unpack</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong module <code>Data.Text</code>. nÃ³ chuyá»ƒn Ä‘á»•i má»™t giÃ¡ trá»‹ kiá»ƒu <code>Text</code> thÃ nh giÃ¡ trá»‹ kiá»ƒu <code>String</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; test2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: *** CONTRACT LOG: &quot;Caught error: BOOM!&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance stopped (no errors)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i khÃ´ng cÃ²n nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o lá»—i ná»¯a, nhÆ°ng thay vÃ o Ä‘Ã³ chÃºng tÃ´i nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o tá»« trÃ¬nh xá»­ lÃ½ lá»—i hiá»ƒn thá»‹ ngoáº¡i lá»‡ Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi Contract1. LÆ°u Ã½ ráº±ng chÃºng tÃ´i váº«n khÃ´ng nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o &quot;Xin chÃ o tá»« há»£p Ä‘á»“ng!&quot;. Há»£p Ä‘á»“ng 1 váº«n ngá»«ng xá»­ lÃ½ sau lá»—i cá»§a nÃ³, nhÆ°ng khÃ´ng cÃ³ lá»—i tá»•ng thá»ƒ cá»§a há»£p Ä‘á»“ng do ngoáº¡i lá»‡ Ä‘Æ°á»£c phÃ¡t hiá»‡n vÃ  xá»­ lÃ½.</p><p>Táº¥t nhiÃªn, cÃ¡c trÆ°á»ng há»£p ngoáº¡i lá»‡ cÅ©ng cÃ³ thá»ƒ xáº£y ra ngay cáº£ khi chÃºng khÃ´ng Ä‘Æ°á»£c mÃ£ há»£p Ä‘á»“ng cá»§a báº¡n Ä‘Æ°a ra má»™t cÃ¡ch rÃµ rÃ ng. CÃ³ nhá»¯ng hoáº¡t Ä‘á»™ng, cháº³ng háº¡n nhÆ° gá»­i má»™t giao dá»‹ch mÃ  khÃ´ng cÃ³ Ä‘á»§ Ä‘áº§u vÃ o Ä‘á»ƒ thanh toÃ¡n cho má»™t Ä‘áº§u ra, trong Ä‘Ã³ Plutus sáº½ Ä‘Æ°a ra má»™t ngoáº¡i lá»‡.</p><p>Tiáº¿p theo, hÃ£y xem tham sá»‘<code>s</code>, tham sá»‘ thá»© hai <code>Contract</code>, xÃ¡c Ä‘á»‹nh cÃ¡c hÃ nh Ä‘á»™ng blockchain cÃ³ sáºµn.</p><p>Trong hai vÃ­ dá»¥ Ä‘áº§u tiÃªn, chÃºng tÃ´i chá»‰ sá»­ dá»¥ng <code>BlockChainActions</code> kiá»ƒu cÃ³ táº¥t cáº£ cÃ¡c chá»©c nÄƒng tiÃªu chuáº©n nhÆ°ng khÃ´ng há»— trá»£ cho cÃ¡c Ä‘iá»ƒm cuá»‘i cá»¥ thá»ƒ. Náº¿u chÃºng tÃ´i muá»‘n há»— trá»£ cho cÃ¡c Ä‘iá»ƒm cuá»‘i cá»¥ thá»ƒ, chÃºng tÃ´i pháº£i sá»­ dá»¥ng má»™t loáº¡i khÃ¡c.</p><p>CÃ¡ch thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n lÃ  sá»­ dá»¥ng tá»« Ä‘á»“ng nghÄ©a loáº¡i. VÃ­ dá»¥ sau Ä‘Ã¢y sáº½ táº¡o ra má»™t tá»« Ä‘á»“ng nghÄ©a kiá»ƒu <code>MySchema</code> cÃ³ táº¥t cáº£ cÃ¡c kháº£ nÄƒng <code>BlockChainActions</code> nhÆ°ng vá»›i viá»‡c bá»• sung kháº£ nÄƒng gá»i Ä‘iá»ƒm cuá»‘i <code>foo</code> vá»›i má»™t Ä‘á»‘i sá»‘ kiá»ƒu <code>Int</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">type MySchema = BlockchainActions .\/ Endpoint &quot;foo&quot; Int</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><em>ChÃº Ã½</em></p><p>ToÃ¡n tá»­ <code>.\\/</code> lÃ  má»™t kiá»ƒu hoáº¡t Ä‘á»™ng - nÃ³ hoáº¡t Ä‘á»™ng trÃªn kiá»ƒu khÃ´ng giÃ¡ trá»‹. Äá»ƒ sá»­ dá»¥ng Ä‘iá»u nÃ y chÃºng ta sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n <code>TypeOperators</code> vÃ  <code>DataKinds</code> biÃªn dá»‹ch.</p><p>Now, we can use the <code>MySchema</code> type to define our contract.
BÃ¢y giá», chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng khiá»ƒu <code>MySchema</code> Ä‘á»ƒ xÃ¡c Ä‘á»‹nh há»£p Ä‘á»“ng cá»§a mÃ¬nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myContract3 :: Contract () MySchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myContract3 = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      n &lt;- endpoint @&quot;foo&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Contract.logInfo n</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Há»£p Ä‘á»“ng nÃ y sáº½ cháº·n cho Ä‘áº¿n khi Ä‘iá»ƒm cuá»‘i <code>foo</code> Ä‘Æ°á»£c gá»i, trong trÆ°á»ng há»£p cá»§a chÃºng tÃ´i, lÃ  má»™t <code>Int</code>. Khi Ä‘Ã³ giÃ¡ trá»‹ cá»§a tham  sá»‘<code>Int</code> sáº½ Ä‘Æ°á»£c rÃ ng buá»™c vá»›i n. Bá»Ÿi vÃ¬ Ä‘iá»u nÃ y, chÃºng tÃ´i khÃ´ng cÃ²n Ä‘á»§ Ä‘á»ƒ chá»‰ cáº§n kÃ­ch hoáº¡t há»£p Ä‘á»“ng Ä‘á»ƒ kiá»ƒm tra nÃ³. BÃ¢y giá», chÃºng ta cÅ©ng pháº£i gá»i Ä‘iá»ƒm cuá»‘i (endpoint).</p><p>Äá»ƒ lÃ m Ä‘iá»u nÃ y, bÃ¢y giá» chÃºng ta cáº§n pháº£i xá»­ lÃ½ tá»« <code>activateContractWallet</code> Ä‘Ã³, sau Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ gá»i Ä‘iá»ƒm cuá»‘i .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myTrace3 :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace3 = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      h &lt;- activateContractWallet (Wallet 1) myContract3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      callEndpoint @&quot;foo&quot; h 42</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test3 :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test3 = runEmulatorTraceIO myTrace3</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Cháº¡y Ä‘iá»u nÃ y trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; test3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;foo&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Number 42.0)]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract log: Number 42.0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">{, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Cuá»‘i cÃ¹ng, hÃ£y xem tham sá»‘ kiá»ƒu Ä‘áº§u tiÃªn, ngÆ°á»i viáº¿t. KhÃ´ng thá»ƒ <code>w</code>  lÃ  má»™t kiá»ƒu tÃ¹y Ã½, nÃ³ pháº£i lÃ  má»™t thá»ƒ hiá»‡n cá»§a lá»›p kiá»ƒu <code>Monoid</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; :i Monoid</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Monoid :: ` -&gt; Constraint</span></div><div class="token-line" style="color:#393A34"><span class="token plain">class Semigroup a =&gt; Monoid a where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mempty :: a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mappend :: a -&gt; a -&gt; a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mconcat :: [a] -&gt; a</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{-# MINIMAL mempty #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid [a] -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid Ordering -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Semigroup a =&gt; Monoid (Maybe a) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid a =&gt; Monoid (IO a) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid b =&gt; Monoid (a -&gt; b) -- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b, Monoid c, Monoid d, Monoid e) =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Monoid (a, b, c, d, e)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b, Monoid c, Monoid d) =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      Monoid (a, b, c, d)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b, Monoid c) =&gt; Monoid (a, b, c)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance (Monoid a, Monoid b) =&gt; Monoid (a, b)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Defined in â€˜GHC.Baseâ€™</span></div><div class="token-line" style="color:#393A34"><span class="token plain">instance Monoid () -- Defined in â€˜GHC.Baseâ€™</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ÄÃ¢y lÃ  má»™t lá»›p kiá»ƒu ráº¥t quan trá»ng vÃ  ráº¥t phá»• biáº¿n trong Haskell. NÃ³ Ä‘á»‹nh nghÄ©a <code>mempty</code> vÃ  <code>mappend</code>.</p><p>HÃ m <code>mempty</code> giá»‘ng nhÆ° pháº§n tá»­ trung láº­p vÃ  <code>mappend</code> káº¿t há»£p hai pháº§n tá»­ cá»§a loáº¡i nÃ y Ä‘á»ƒ táº¡o ra má»™t pháº§n tá»­ má»›i cÃ¹ng loáº¡i.</p><p>VÃ­ dá»¥ <code>Monoid</code> lÃ  <code>List</code>, khi <code>mempty</code> lÃ  danh sÃ¡ch empty <code>\[\]</code>, vÃ  <code>mappend</code> lÃ  ná»‘i <code>++</code>.</p><p>VÃ­ dá»¥:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude&gt; mempty :: [Int]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude&gt; mappend [1, 2, 3 :: Int] [4, 5, 6]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[1,2,3,4,5,6]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ³ ráº¥t nhiá»u vÃ­ dá»¥ khÃ¡c vá» <code>Monoid</code>, vÃ  chÃºng ta sáº½ tháº¥y cÃ¡c trÆ°á»ng há»£p khÃ¡c trong khÃ³a há»c nÃ y.</p><p>NhÆ°ng bÃ¢y giá», chÃºng ta hÃ£y gáº¯n bÃ³ vá»›i cÃ¡c danh sÃ¡ch vÃ  viáº¿t vÃ­ dá»¥ cuá»‘i cÃ¹ng cá»§a chÃºng ta.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myContract4 :: Contract [Int] BlockchainActions Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myContract4 = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Contract.waitNSlots 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    tell [1]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Contract.waitNSlots 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    tell [2]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Contract.waitNSlots 10</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Thay vÃ¬ sá»­ dá»¥ng <code>Unit</code> nhÆ° lÃ  kiá»ƒu <code>w</code>, ChÃºng tÃ´i sá»­ dá»¥ng<code>\[Int\]</code>.Äiá»u nÃ y cho phÃ©p chÃºng tÃ´i sá»­ dá»¥ng <code>tell</code> nhÆ° lÃ  show.</p><p>Äiá»u nÃ y bÃ¢y giá» cho phÃ©p chÃºng tÃ´i truy cáº­p vÃ o cÃ¡c thÃ´ng bÃ¡o Ä‘Ã³ trong quÃ¡ trÃ¬nh theo dÃµi, báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>observableState</code> .</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">myTrace4 :: EmulatorTrace ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">myTrace4 = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    h &lt;- activateContractWallet (Wallet 1) myContract4</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 5</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    xs &lt;- observableState h</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Extras.logInfo $ show xs</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ys &lt;- observableState h</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Extras.logInfo $ show ys</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    zs &lt;- observableState h</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Extras.logInfo $ show zs</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test4 :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test4 = runEmulatorTraceIO myTrace4</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng ta cháº¡y Ä‘iá»u nÃ y trong REPL, chÃºng ta cÃ³ thá»ƒ tháº¥y cÃ¡c <code>USER LOG</code> thÃ´ng bÃ¡o Ä‘Æ°á»£c táº¡o báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>tell</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.Trace.Emulator Plutus.Contract.Trace Wallet.Emulator Week04.Trace Wallet.Emulator.Stream Week04.Contract&gt; test4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00005: SlotAdd Slot 6</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00006: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Sending contract state to Thread 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00006: SlotAdd Slot 7</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00007: *** USER LOG: []</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00007: SlotAdd Slot 8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00015: SlotAdd Slot 16</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00016: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Sending contract state to Thread 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00016: SlotAdd Slot 17</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00017: *** USER LOG: [1]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00017: SlotAdd Slot 18</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00025: SlotAdd Slot 26</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00026: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Sending contract state to Thread 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00026: SlotAdd Slot 27</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00027: *** USER LOG: [1,2]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Sá»­ dá»¥ng cÆ¡ cháº¿ nÃ y, cÃ³ thá»ƒ truyá»n thÃ´ng tin tá»« há»£p Ä‘á»“ng Ä‘ang cháº¡y trong vÃ­ ra tháº¿ giá»›i bÃªn ngoÃ i. Sá»­ dá»¥ng thiáº¿t bá»‹ Ä‘áº§u cuá»‘i, chÃºng tÃ´i cÃ³ thá»ƒ chuyá»ƒn thÃ´ng tin vÃ o má»™t há»£p Ä‘á»“ng. VÃ  báº±ng cÃ¡ch sá»­ dá»¥ng cÆ¡ cháº¿ <code>tell</code>, chÃºng tÃ´i cÃ³ thá»ƒ láº¥y thÃ´ng tin ra khá»i vÃ­.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/cardano2vn/cardanovn-portal/edit/main/docs/dr-lars-lession/week4.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/dr-lars-lession/week3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Week 03 - Script Context</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tá»•ng-quat" class="table-of-contents__link">Tá»•ng quat</a></li><li><a href="#monads" class="table-of-contents__link">Monads</a><ul><li><a href="#hello-world" class="table-of-contents__link">Hello World</a></li><li><a href="#getline" class="table-of-contents__link">getLine</a></li><li><a href="#maybe" class="table-of-contents__link">Maybe</a></li><li><a href="#má»™t-trong-hai-either" class="table-of-contents__link">Má»™t trong hai (Either)</a></li><li><a href="#writer" class="table-of-contents__link">Writer</a></li><li><a href="#what-is-a-monad" class="table-of-contents__link">What is a Monad?</a></li><li><a href="#táº¡i-sao-Ä‘iá»u-nÃ y-há»¯u-Ã­ch" class="table-of-contents__link">Táº¡i sao Ä‘iá»u nÃ y há»¯u Ã­ch?</a></li><li><a href="#kÃ½-hiá»‡u-do" class="table-of-contents__link">kÃ½ hiá»‡u &#39;do&#39;</a></li></ul></li><li><a href="#plutus-monads" class="table-of-contents__link">Plutus Monads</a><ul><li><a href="#the-emulatortrace-monad" class="table-of-contents__link">The EmulatorTrace Monad</a></li><li><a href="#the-contract-monad" class="table-of-contents__link">The Contract Monad</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">TÃ i liá»‡u</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a></li></ul></div><div class="col footer__col"><div class="footer__title">Cá»™ng Ä‘á»“ng</div><ul class="footer__items"><li class="footer__item"><a href="https://t.me/cardano2vn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCJTdAQPGJntJet5v-nk9ebA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/about-us">About Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">The content of this site is referenced and copied from the <a href="https://developers.cardano.org/" target="_blank" rel="noopener noreferrer">Cardano Developer</a>, 2021</div></div></div></footer></div>
<script src="/assets/js/runtime~main.38f84b10.js"></script>
<script src="/assets/js/main.c8d132ad.js"></script>
</body>
</html>