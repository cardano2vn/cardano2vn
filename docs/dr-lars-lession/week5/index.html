<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cardano2vn Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cardano2vn Blog Atom Feed"><title data-react-helmet="true">Week 05 - Native Tokens | Cardano2vn</title><meta data-react-helmet="true" property="og:url" content="https://cardano2vn.io/docs/dr-lars-lession/week5"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Week 05 - Native Tokens | Cardano2vn"><meta data-react-helmet="true" name="description" content="Ghi chÃº"><meta data-react-helmet="true" property="og:description" content="Ghi chÃº"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/2.png"><link data-react-helmet="true" rel="canonical" href="https://cardano2vn.io/docs/dr-lars-lession/week5"><link data-react-helmet="true" rel="alternate" href="https://cardano2vn.io/docs/dr-lars-lession/week5" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://cardano2vn.io/docs/dr-lars-lession/week5" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8b54419c.css">
<link rel="preload" href="/assets/js/runtime~main.1a53d0b2.js" as="script">
<link rel="preload" href="/assets/js/main.bea7ec5b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Cardano2vn</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo/2.png" alt="Cardano2vn Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Cardano2vn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Táº¡o Há»£p Ä‘á»“ng thÃ´ng minh</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/overview">Tá»•ng quan</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/marlowe">NgÃ´n ngá»¯ Marlowe</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-contracts/plutus">NgÃ´n ngá»¯ Plutus</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TÃ­ch há»£p vá»›i Cardano</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/integrate-cardano/note">Note</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Váº­n hÃ nh má»™t Stake Pool</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/operate-a-stake-pool/note">Note</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">KhoÃ¡ Ä‘Ã o táº¡o Plutus cá»§a Dr. Lars</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/overview">Plutus Pioneer Program</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week1">Week 01 - English Auction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week2">Week 02 - Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week3">Week 03 - Script Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week4">Week 04 - Monads</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/dr-lars-lession/week5">Week 05 - Native Tokens</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dr-lars-lession/week6">Week 06 - Oracles</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Week 05 - Native Tokens</h1></header><div class="markdown"><p>Ghi chÃº</p><p>ÄÃ¢y lÃ  phiÃªn báº£n viáº¿t cá»§a <a href="https://youtu.be/6VbhY162GQA" target="_blank" rel="noopener noreferrer">BÃ i giáº£ng sá»‘ 5</a>.</p><p>Trong bÃ i giáº£ng nÃ y, chÃºng ta tÃ¬m hiá»ƒu vá» mÃ£ thÃ´ng bÃ¡o gá»‘c, chÃ­nh sÃ¡ch khai thÃ¡c vÃ  NFT.</p><p>Nhá»¯ng ghi chÃº nÃ y sá»­ dá»¥ng Plutus cam káº¿t0c3c310cab61dbff8cbc1998a3678b367be6815a</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="tá»•ng-quat"></a>Tá»•ng quat<a class="hash-link" href="#tá»•ng-quat" title="Direct link to heading">#</a></h2><p>ChÃºng ta sáº½ nÃ³i vá» cÃ¡ch Plutus há»— trá»£ cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c vÃ  cÃ¡ch xÃ¡c Ä‘á»‹nh cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Ãºc vÃ  Ä‘á»‘t trong nhá»¯ng Ä‘iá»u kiá»‡n nÃ o. NhÆ°ng trÆ°á»›c khi Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³, hÃ£y cÃ¹ng khÃ¡m phÃ¡ xem <code>value</code> Cardano cÃ³ Ã½ nghÄ©a gÃ¬ .</p><p>Khi chÃºng ta nÃ³i vá» mÃ´ hÃ¬nh (E) UTxO, chÃºng ta Ä‘Ã£ biáº¿t ráº±ng má»—i UTxO (giao dá»‹ch chÆ°a sá»­ dá»¥ng) Ä‘á»u cÃ³ má»™t Ä‘á»‹a chá»‰ vÃ  má»™t giÃ¡ trá»‹. VÃ , chÃºng tÃ´i tháº¥y ráº±ng, do Ä‘Æ°á»£c má»Ÿ rá»™ng sang mÃ´ hÃ¬nh (E) UTxO, má»—i UTxO cÅ©ng cÃ³ má»™t <code>Datum</code>. ChÃºng ta Ä‘Ã£ tháº¥y cÃ¡c vÃ­ dá»¥ vá» UTxO nhÆ° váº­y trong cÃ¡c bÃ i giáº£ng trÆ°á»›c.</p><p>Trong háº§u háº¿t cÃ¡c vÃ­ dá»¥ mÃ  chÃºng ta Ä‘Ã£ tháº¥y cho Ä‘áº¿n nay, giÃ¡ trá»‹ chá»‰ Ä‘Æ¡n giáº£n lÃ  má»™t giÃ¡ trá»‹ Ada, Ä‘Æ°á»£c gá»i lÃ  lovelace. Ngoáº¡i lá»‡ lÃ  vÃ­ dá»¥ Ä‘áº§u tiÃªn, tá»« bÃ i giáº£ng 1, cá»¥ thá»ƒ lÃ  vÃ­ dá»¥ <code>English Auction</code> . Trong vÃ­ dá»¥ Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ bÃ¡n Ä‘áº¥u giÃ¡ má»™t NFT. Tuy nhiÃªn, NFT chá»‰ Ä‘Æ°á»£c táº¡o ra tá»« khÃ´ng khÃ­ má»ng trong sÃ¢n chÆ¡i.</p><p>Tuy nhiÃªn, trong chuá»—i khá»‘i Cardano thá»±c, ban Ä‘áº§u chá»‰ cÃ³ Ada, khÃ´ng cÃ³ mÃ£ thÃ´ng bÃ¡o gá»‘c nÃ o khÃ¡c. VÃ¬ váº­y, báº¡n pháº£i lÃ m gÃ¬ Ä‘Ã³ Ä‘á»ƒ táº¡o cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c má»›i hoáº·c ghi cÃ¡c mÃ£ hiá»‡n cÃ³. Trong bÃ i giáº£ng nÃ y, chÃºng ta sáº½ xem cÃ¡ch thá»±c hiá»‡n Ä‘iá»u Ä‘Ã³.</p><p>NhÆ°ng trÆ°á»›c háº¿t hÃ£y nÃ³i vá» cÃ¡c giÃ¡ trá»‹ trÃªn.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="value"></a>Value<a class="hash-link" href="#value" title="Direct link to heading">#</a></h2><p>CÃ¡c loáº¡i liÃªn quan Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trong gÃ³i <code>plutus-ledger-api</code>. CÃ¡c mÃ´-Ä‘un quan tÃ¢m lÃ </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">module Plutus.V1.Ledger.Value</span></div><div class="token-line" style="color:#393A34"><span class="token plain">module Plutus.V1.Ledger.Ada</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="kiá»ƒu-value"></a>Kiá»ƒu Value<a class="hash-link" href="#kiá»ƒu-value" title="Direct link to heading">#</a></h3><p><code>Value</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  map tá»« <code>CurrencySymbol</code> tá»›i maps. tá»«
<code>TokenName</code>tá»« <code>Integers</code>, nghe cÃ³ váº» hÆ¡i ká»³ cá»¥c vÃ  phá»©c táº¡p.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">newtype Value = Value { getValue :: Map.Map CurrencySymbol (Map.Map TokenName Integer) }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving stock (Generic)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving anyclass (ToJSON, FromJSON, Hashable, NFData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving newtype (Serialise, PlutusTx.IsData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving Pretty via (PrettyShow Value)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u Ä‘áº§u tiÃªn cáº§n lÆ°u Ã½ lÃ  má»—i mÃ£ thÃ´ng bÃ¡o gá»‘c, bao gá»“m cáº£ Ada, Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng hai pháº§n dá»¯ liá»‡u -  <code>CurrencySymbol</code> vÃ 
<code>TokenName</code>.</p><p>Má»™t <code>CurrencySymbol</code> lÃ  <code>newtype</code> bao quanh lÃ  má»™t <code>ByteString</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">newtype CurrencySymbol = CurrencySymbol { unCurrencySymbol :: Builtins.ByteString }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving (IsString, Show, Serialise, Pretty) via LedgerBytes</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving stock (Generic)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving newtype (Haskell.Eq, Haskell.Ord, Eq, Ord, PlutusTx.IsData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving anyclass (Hashable, ToJSONKey, FromJSONKey,  NFData)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  Ä‘iwwÃ¹ nÃ y cÅ©ng Ä‘Ãºng vá»›i <code>TokenName</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">newtype TokenName = TokenName { unTokenName :: Builtins.ByteString }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving (Serialise) via LedgerBytes</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving stock (Generic)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving newtype (Haskell.Eq, Haskell.Ord, Eq, Ord, PlutusTx.IsData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving anyclass (Hashable, NFData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    deriving Pretty via (PrettyShow TokenName)    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta cÃ³ hai <code>ByteStrings</code> Ä‘á»‹nh nghÄ©a lÃ  coin, hoáº·c nÃ³ cÃ²n Ä‘Æ°á»£c gá»i lÃ  <code>asset class</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">assetClass :: CurrencySymbol -&gt; TokenName -&gt; AssetClass</span></div><div class="token-line" style="color:#393A34"><span class="token plain">assetClass s t = AssetClass (s, t)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Ada lÃ  má»™t lá»›p tÃ i sáº£n vÃ  cÃ¡c Token gá»‘c tÃ¹y chá»‰nh sáº½ lÃ  cÃ¡c lá»›p tÃ i sáº£n khÃ¡c.</p><p>Má»™t <code>Value</code> chá»‰ Ä‘Æ¡n giáº£n cho tháº¥y cÃ³ bao nhiÃªu Ä‘Æ¡n vá»‹ tá»“n táº¡i cho má»™t loáº¡i tÃ i sáº£n nháº¥t Ä‘á»‹nh.</p><p>HÃ£y báº¯t Ä‘áº§u REPL vÃ  nháº­p hai mÃ´-Ä‘un cÃ³ liÃªn quan.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">cabal repl</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Free&gt; import Plutus.V1.Ledger.Ada</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Week05.Free&gt; import Plutus.V1.Ledger.Value </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; :set -XOverloadedStrings</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Ghi chÃº:</p><p>ChÃºng tÃ´i cÅ©ng Ä‘Ã£ kÃ­ch hoáº¡t <code>OverloadedStrings</code> tiá»‡n Ã­ch má»Ÿ rá»™ng. ChÃºng ta cÃ³ thá»ƒ Ä‘Æ°a vÃ o <code>ByteString</code>dÆ°á»›i dáº¡ng chuá»—i kÃ½ tá»±.</p><p>BÃ¢y giá» chÃºng ta hÃ£y xem xÃ©t má»™t sá»‘ giÃ¡ trá»‹. HÃ£y báº¯t Ä‘áº§u vá»›i cÃ¡c giÃ¡ trá»‹ lovelace. TÆ°Æ¡ng tá»± <code>Ledger.Ada</code> module nÃ y Ä‘Æ°á»£c gá»i lÃ <code>adaSymbol</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; :t adaSymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">adaSymbol :: CurrencySymbol</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y cho chÃºng ta kÃ½ hiá»‡u tiá»n tá»‡ cá»§a loáº¡i tÃ i sáº£n Ada, chá»‰ lÃ  loáº¡i trá»‘ng <code>ByteString</code>. TÆ°Æ¡ng tá»±, cÃ³ má»™t hÃ m <code>adaToken</code>, sáº½ cung cáº¥p cho chÃºng ta tÃªn token.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; :t adaToken</span></div><div class="token-line" style="color:#393A34"><span class="token plain">adaToken :: TokenName</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t láº§n ná»¯a, Ä‘Ã¢y cÅ©ng lÃ  trá»‘ng <code>ByteString</code>.</p><p>ChÃºng ta Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã¢y trong cÃ¡c vÃ­ dá»¥ vá» cÃ¡ch táº¡o má»™t biá»ƒu tÆ°á»£ng cÃ³ <code>Value</code> lÃ  lovelace. HÃ m  <code>lovelaceValueOf</code> nay vá»›i giÃ¡ trá»‹ <code>Integer</code>, chÃºng ta Ä‘Æ°a vÃ o <code>Value</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; :t lovelaceValueOf</span></div><div class="token-line" style="color:#393A34"><span class="token plain">lovelaceValueOf :: Integer -&gt; Value</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ­ dá»¥ ta Ä‘Æ°a vÃ o 123 lovelace, ChÃºng ta cÃ³ thá»ƒ lÃ m:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; lovelaceValueOf 123</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Value (Map [(,Map [(&quot;&quot;,123)])])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Báº¡n sáº½ luÃ´n sá»­ dá»¥ng má»™t hÃ m trá»£ giÃºp cháº³ng háº¡n nhÆ° <code>lovelaceValueOf</code> Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c map giÃ¡ trá»‹ - báº¡n sáº½ khÃ´ng bao giá» cáº§n pháº£i táº¡o má»™t map trá»±c tiáº¿p.</p><p>á» Ä‘Ã¢y chÃºng tÃ´i xem map. Map bÃªn ngoÃ i cá»§a cÃ¡c kÃ½ hiá»‡u tiá»n tá»‡ cÃ³ má»™t khÃ³a, lÃ  kÃ½ hiá»‡u trá»‘ng cho Ada vÃ  báº£n Ä‘á»“ bÃªn trong tÃªn mÃ£ thÃ´ng bÃ¡o cÃ³ má»™t khÃ³a, chuá»—i trá»‘ng cho Ada vÃ  giÃ¡ trá»‹ lÃ  123.</p><p>OMá»™t Ä‘iá»u chÃºng ta cÃ³ thá»ƒ lÃ m vá»›i cÃ¡c giÃ¡ trá»‹ lÃ  káº¿t há»£p chÃºng. CÃ¡c lá»›p <code>Value</code> lÃ  thá»ƒ hiá»‡n cá»§a <code>Monoid</code>, vÃ¬ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng <code>mappend</code>, nÃ³ cÃ³ thá»ƒ viáº¿t <code>&lt;&gt;</code>, xuáº¥t phÃ¡t tá»«  super class cá»§a <code>Monoid</code> gá»i lÃ  <code>Semigroup</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; lovelaceValueOf 123 &lt;&gt; lovelaceValueOf 10</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Value (Map [(,Map [(&quot;&quot;,133)])])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ¬ váº­y, lÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta táº¡o ra <code>Value</code> bao gá»“m tokens gá»‘c?</p><p>CÃ³ má»™t chá»©c nÄƒng ráº¥t há»¯u Ã­ch Ä‘Æ°á»£c gá»i lÃ  <code>singleton</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free&gt; :t singleton</span></div><div class="token-line" style="color:#393A34"><span class="token plain">singleton :: CurrencySymbol -&gt; TokenName -&gt; Integer -&gt; Value</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y sáº½ táº¡o ra má»™t  <code>Value</code> cho token Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh bá»Ÿi <code>CurrencySymbol</code>
vÃ  <code>TokenName</code>, vÃ  cho má»™t sá»‘ tiá»n nháº¥t Ä‘á»‹nh <code>Integer</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; singleton &quot;a8ff&quot; &quot;ABC&quot; 7</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Value (Map [(a8ff,Map [(&quot;ABC&quot;,7)])])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äá»‘i sá»‘ Ä‘áº§u tiá»n lÃ  \&quot;a8ff\&quot; cho <code>CurrencySymbol</code> lÃ  chuá»—i kÃ½ tá»± mÃ£ hexa value, lÃ  lyd ro cho nÃ³ rÃµ rÃ ng hÆ¡n. Äá»‘i sá»‘ thá»© 2 lÃ  &quot;ABC&quot; cho <code>TokenName</code> cÃ³ thá»ƒ lÃ  chuyooix kÃ½ tá»± tÃ¹ Ã½.</p><p>VÃ , chÃºng ta cÃ³ thá»ƒ káº¿t há»£p, nhÆ° trÆ°á»›c Ä‘Ã¢y toÃ¡n tá»­ <code>mappend</code>. BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ táº¡o má»™t map thÃº vá»‹ hÆ¡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; singleton &quot;a8ff&quot; &quot;ABC&quot; 7 &lt;&gt; lovelaceValueOf 42 &lt;&gt; singleton &quot;a8ff&quot; &quot;XYZ&quot; 100</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Value (Map [(,Map [(&quot;&quot;,42)]),(a8ff,Map [(&quot;ABC&quot;,7),(&quot;XYZ&quot;,100)])])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng ta tháº¥y má»™t báº£n Ä‘á»“ Ä‘áº¡i diá»‡n cho 42 lovelace cÅ©ng nhÆ° hai mÃ£ thÃ´ng bÃ¡o <code>ABC</code> vÃ  <code>XYZ</code> cáº£ hai Ä‘á»u thuá»™c vá» <code>CurrencySymbol</code> &quot;af88&quot;, vÃ  má»—i mÃ£ cÃ³ sá»‘ nguyÃªn tÆ°Æ¡ng á»©ng.</p><p>HÃ£y Ä‘áº·t tÃªn cho giÃ¡ trá»‹ nÃ y:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; let v = singleton &quot;a8ff&quot; &quot;ABC&quot; 7 &lt;&gt; lovelaceValueOf 42 &lt;&gt; singleton &quot;a8ff&quot; &quot;XYZ&quot; 100</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; v</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Value (Map [(,Map [(&quot;&quot;,42)]),(a8ff,Map [(&quot;ABC&quot;,7),(&quot;XYZ&quot;,100)])])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t chá»©c nÄƒng há»¯u Ã­ch khÃ¡c lÃ  <code>valueOf</code> cho phÃ©p chÃºng tÃ´i láº¥y giÃ¡ trá»‹ cá»§a má»™t kÃ½ hiá»‡u tiá»n tá»‡ vÃ  tÃªn mÃ£ thÃ´ng bÃ¡o nháº¥t Ä‘á»‹nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; :t valueOf</span></div><div class="token-line" style="color:#393A34"><span class="token plain">valueOf :: Value -&gt; CurrencySymbol -&gt; TokenName -&gt; Integer</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; valueOf v &quot;a8ff&quot; &quot;XYZ&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">100    </span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; valueOf v &quot;a8ff&quot; &quot;ABC&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">7</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; valueOf v &quot;a8ff&quot; &quot;abc&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t chá»©c nÄƒng há»¯u Ã­ch lÃ  <code>flattenValue</code>. NhÆ° tÃªn cho tháº¥y, nÃ³ lÃ m pháº³ng báº£n Ä‘á»“ cá»§a cÃ¡c báº£n Ä‘á»“ thÃ nh má»™t danh sÃ¡ch pháº³ng gá»“m cÃ¡c bá»™ ba.</p><blockquote><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; :t flattenValue</span></div><div class="token-line" style="color:#393A34"><span class="token plain">flattenValue :: Value -&gt; [(CurrencySymbol, TokenName, Integer)]</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Week05.Free&gt; flattenValue v</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[(a8ff,&quot;ABC&quot;,7),(a8ff,&quot;XYZ&quot;,100),(,&quot;&quot;,42)]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="chÃ­nh-sÃ¡ch-Ä‘Ãºc-tiá»n"></a>ChÃ­nh sÃ¡ch Ä‘Ãºc tiá»n<a class="hash-link" href="#chÃ­nh-sÃ¡ch-Ä‘Ãºc-tiá»n" title="Direct link to heading">#</a></h2><p>BÃ¢y giá» cÃ¢u há»i lÃ  táº¡i sao? Táº¡i sao chÃºng ta cáº§n cáº£ biá»ƒu tÆ°á»£ng tiá»n tá»‡ vÃ  tÃªn mÃ£ thÃ´ng bÃ¡o? Táº¡i sao chÃºng ta khÃ´ng chá»‰ sá»­ dá»¥ng má»™t mÃ£ Ä‘á»‹nh danh cho má»™t loáº¡i ná»™i dung? VÃ  táº¡i sao kÃ½ hiá»‡u tiá»n tá»‡ pháº£i á»Ÿ dáº¡ng chá»¯ sá»‘ tháº­p lá»¥c phÃ¢n?</p><p>ÄÃ¢y lÃ  nÆ¡i mÃ  cÃ¡i gá»i lÃ  chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n xuáº¥t hiá»‡n.</p><p>Quy táº¯c lÃ , nÃ³i chung, má»™t giao dá»‹ch khÃ´ng thá»ƒ táº¡o hoáº·c xÃ³a mÃ£ thÃ´ng bÃ¡o. CÃ¡i gÃ¬ vÃ o cÅ©ng ra, trá»« phÃ­. LuÃ´n luÃ´n cÃ³ má»™t cáº£m giÃ¡c Ä‘Ã¡ng yÃªu pháº£i Ä‘Æ°á»£c tráº£ báº±ng má»—i giao dá»‹ch. PhÃ­ phá»¥ thuá»™c vÃ o quy mÃ´ cá»§a giao dá»‹ch vÃ  sá»‘ bÆ°á»›c mÃ  táº­p lá»‡nh xÃ¡c thá»±c thá»±c hiá»‡n cÅ©ng nhÆ° má»©c tiÃªu thá»¥ bá»™ nhá»› cá»§a táº­p lá»‡nh.</p><p>NhÆ°ng, náº¿u Ä‘Ã³ lÃ  toÃ n bá»™ cÃ¢u chuyá»‡n thÃ¬ chÃºng ta khÃ´ng bao giá» cÃ³ thá»ƒ táº¡o ra cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c. VÃ  Ä‘Ã¢y lÃ  lÃºc cÃ¡c chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n Ä‘Æ°á»£c Ä‘Æ°a ra, vÃ  sá»± liÃªn quan cá»§a biá»ƒu tÆ°á»£ng tiá»n tá»‡ xuáº¥t hiá»‡n.</p><p>LÃ½ do mÃ  kÃ½ hiá»‡u tiá»n tá»‡ pháº£i bao gá»“m cÃ¡c chá»¯ sá»‘ tháº­p lá»¥c phÃ¢n lÃ  vÃ¬ nÃ³ thá»±c sá»± lÃ  hÃ m bÄƒm cá»§a má»™t táº­p lá»‡nh. VÃ  táº­p lá»‡nh nÃ y Ä‘Æ°á»£c gá»i lÃ  chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n vÃ  náº¿u chÃºng ta cÃ³ má»™t giao dá»‹ch mÃ  chÃºng ta dá»± kiáº¿n â€‹â€‹táº¡o hoáº·c ghi mÃ£ thÃ´ng bÃ¡o gá»‘c thÃ¬ Ä‘á»‘i vá»›i má»—i mÃ£ thÃ´ng bÃ¡o gá»‘c mÃ  chÃºng ta cá»‘ gáº¯ng táº¡o hoáº·c Ä‘á»‘t, kÃ½ hiá»‡u tiá»n tá»‡ sáº½ Ä‘Æ°á»£c tra cá»©u. VÃ¬ váº­y, táº­p lá»‡nh tÆ°Æ¡ng á»©ng cÅ©ng pháº£i Ä‘Æ°á»£c chá»©a trong giao dá»‹ch. VÃ  táº­p lá»‡nh Ä‘Ã³ Ä‘Æ°á»£c thá»±c thi cÃ¹ng vá»›i cÃ¡c táº­p lá»‡nh xÃ¡c thá»±c khÃ¡c.</p><p>VÃ , tÆ°Æ¡ng tá»± nhÆ° cÃ¡c táº­p lá»‡nh xÃ¡c thá»±c mÃ  chÃºng ta Ä‘Ã£ tháº¥y Ä‘á»ƒ xÃ¡c thá»±c Ä‘áº§u vÃ o, má»¥c Ä‘Ã­ch cá»§a cÃ¡c táº­p lá»‡nh in nÃ y lÃ  Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem giao dá»‹ch nÃ y cÃ³ quyá»n Ä‘Ãºc hoáº·c ghi mÃ£ thÃ´ng bÃ¡o hay khÃ´ng. Ada cÅ©ng phÃ¹ há»£p vá»›i káº¿ hoáº¡ch nÃ y. HÃ£y nhá»› ráº±ng biá»ƒu tÆ°á»£ng tiá»n tá»‡ cá»§a Ada chá»‰ lÃ  má»™t chuá»—i rá»—ng, khÃ´ng pháº£i lÃ  mÃ£ bÄƒm cá»§a báº¥t ká»³ táº­p lá»‡nh nÃ o. VÃ¬ váº­y, khÃ´ng cÃ³ táº­p lá»‡nh nÃ o bÄƒm thÃ nh chuá»—i trá»‘ng, vÃ¬ váº­y khÃ´ng cÃ³ táº­p lá»‡nh nÃ o cho phÃ©p Ä‘Ãºc hoáº·c Ä‘á»‘t Ada, cÃ³ nghÄ©a lÃ  Ada khÃ´ng bao giá» cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Ãºc hoáº·c Ä‘á»‘t.</p><p>Táº¥t cáº£ Ada tá»“n táº¡i Ä‘áº¿n tá»« giao dá»‹ch Genesis vÃ  tá»•ng sá»‘ Ada trong há»‡ thá»‘ng lÃ  cá»‘ Ä‘á»‹nh vÃ  khÃ´ng bao giá» cÃ³ thá»ƒ thay Ä‘á»•i. Chá»‰ cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c tÃ¹y chá»‰nh má»›i cÃ³ thá»ƒ cÃ³ cÃ¡c chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n tÃ¹y chá»‰nh.</p><p>VÃ¬ váº­y, chÃºng ta sáº½ xem xÃ©t má»™t vÃ­ dá»¥ vá» chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n tiáº¿p theo vÃ  sáº½ tháº¥y ráº±ng nÃ³ ráº¥t giá»‘ng vá»›i má»™t táº­p lá»‡nh xÃ¡c thá»±c, nhÆ°ng khÃ´ng giá»‘ng há»‡t nhau.</p><p>TrÆ°á»›c khi chÃºng tÃ´i viáº¿t ra chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n Ä‘áº§u tiÃªn, hÃ£y nhá»› láº¡i ngáº¯n gá»n cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a xÃ¡c thá»±c.</p><p>Khi chÃºng ta khÃ´ng cÃ³ Ä‘á»‹a chá»‰ khÃ³a cÃ´ng khai mÃ  cÃ³ Ä‘á»‹a chá»‰ táº­p lá»‡nh vÃ  UTxO náº±m táº¡i Ä‘á»‹a chá»‰ Ä‘Ã³, thÃ¬ Ä‘á»‘i vá»›i báº¥t ká»³ giao dá»‹ch nÃ o cá»‘ gáº¯ng sá»­ dá»¥ng UTxO Ä‘Ã³, má»™t táº­p lá»‡nh xÃ¡c thá»±c sáº½ Ä‘Æ°á»£c cháº¡y.</p><p>Táº­p lá»‡nh xÃ¡c thá»±c Ä‘Ã³, dÆ°á»›i dáº¡ng Ä‘áº§u vÃ o, dá»¯ liá»‡u, Ä‘áº¿n tá»« UTxO, trÃ¬nh mua láº¡i, Ä‘áº¿n tá»« Ä‘áº§u vÃ o vÃ  ngá»¯ cáº£nh.</p><p>Nhá»› láº¡i ráº±ng <code>ScriptContext</code> cÃ³ hai trÆ°á»ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data ScriptContext = ScriptContext{scriptContextTxInfo :: TxInfo, scriptContextPurpose :: ScriptPurpose }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t trong nhá»¯ng trÆ°á»ng Ä‘Ã³ lÃ  <code>ScriptPurpose</code>, vÃ  trong trÆ°á»ng nÃ y
má»i thá»© chÃºng ta tháº¥y cho Ä‘áº¿n bÃ¢y giá» Ä‘á»u thuá»™c loáº¡i <code>Spending</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data ScriptPurpose</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    = Minting CurrencySymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    | Spending TxOutRef</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    | Rewarding StakingCredential</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    | Certifying DCert</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>TrÆ°á»ng khÃ¡c lÃ   <code>TxInfo</code> chá»©a táº¥t cáº£ thÃ´ng tin ngá»¯ cáº£nh vá» giao dá»‹ch.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- | A pending transaction. This is the view as seen by validator scripts, so some details are stripped out.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data TxInfo = TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    { txInfoInputs      :: [TxInInfo] -- ^ Transaction inputs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoInputsFees  :: [TxInInfo]     -- ^ Transaction inputs designated to pay fees</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoOutputs     :: [TxOut] -- ^ Transaction outputs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoFee         :: Value -- ^ The fee paid by this transaction.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoForge       :: Value -- ^ The &#x27;Value&#x27; forged by this transaction.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoDCert       :: [DCert] -- ^ Digests of certificates included in this transaction</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoWdrl        :: [(StakingCredential, Integer)] -- ^ Withdrawals</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoValidRange  :: SlotRange -- ^ The valid range for the transaction.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoSignatories :: [PubKeyHash] -- ^ Signatures provided with the transaction, attested that they all signed the tx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoData        :: [(DatumHash, Datum)]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , txInfoId          :: TxId</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- ^ Hash of the pending transaction (excluding witnesses)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    } deriving (Generic)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äá»‘i vá»›i cÃ¡c chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n, Ä‘iá»u nÃ y Ä‘Æ°á»£c kÃ­ch hoáº¡t náº¿u <code>txInfoForge</code> trÆ°á»ng cá»§a giao dá»‹ch chá»©a giÃ¡ trá»‹ khÃ¡c 0. Trong táº¥t cáº£ cÃ¡c giao dá»‹ch mÃ  chÃºng tÃ´i Ä‘Ã£ tháº¥y cho Ä‘áº¿n nay, giÃ¡ trá»‹ trÆ°á»ng nÃ y báº±ng 0 - chÃºng tÃ´i chÆ°a bao giá» táº¡o hoáº·c phÃ¡ há»§y báº¥t ká»³ mÃ£ thÃ´ng bÃ¡o nÃ o.</p><p>Náº¿u nÃ³ <code>is</code> khÃ¡c 0, thÃ¬ Ä‘á»‘i vá»›i má»—i kÃ½ hiá»‡u tiá»n tá»‡ cÃ³ trong <code>Value</code>, táº­p lá»‡nh chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n tÆ°Æ¡ng á»©ng sáº½ Ä‘Æ°á»£c cháº¡y.</p><p>Trong khi cÃ¡c táº­p lá»‡nh xÃ¡c thá»±c cÃ³ ba Ä‘áº§u vÃ o - dá»¯ liá»‡u, trÃ¬nh Ä‘á»•i vÃ  ngá»¯ cáº£nh, cÃ¡c táº­p lá»‡nh chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n nÃ y chá»‰ cÃ³ má»™t Ä‘áº§u vÃ o - ngá»¯ cáº£nh. VÃ  Ä‘Ã³ lÃ  bá»‘i cáº£nh giá»‘ng nhÆ° chÃºng ta Ä‘Ã£ cÃ³ trÆ°á»›c Ä‘Ã¢y - <code>ScriptContext</code>. Sáº½ khÃ´ng cÃ³ Ã½ nghÄ©a gÃ¬ náº¿u cÃ³ dá»¯ liá»‡u, vÃ¬ nÃ³ thuá»™c vá» UTxO vÃ  sáº½ khÃ´ng cÃ³ Ã½ nghÄ©a gÃ¬ náº¿u cÃ³ ngÆ°á»i mua láº¡i vÃ¬ nÃ³ thuá»™c vá» táº­p lá»‡nh xÃ¡c thá»±c. ChÃ­nh sÃ¡ch Ä‘Ãºc tiá»n thuá»™c vá» báº£n thÃ¢n giao dá»‹ch, khÃ´ng pháº£i Ä‘áº§u vÃ o hoáº·c Ä‘áº§u ra cá»¥ thá»ƒ.</p><p>Äá»‘i vá»›i <code>ScriptPurpose</code>, Ä‘iá»u nÃ y sáº½ khÃ´ng Ä‘Æ°á»£c <code>Spending</code> nhÆ° nÃ³ Ä‘Ã£ Ä‘Æ°á»£c cho Ä‘áº¿n bÃ¢y giá», nhÆ°ng sáº½ lÃ  Minting.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="vÃ­-dá»¥-1---free"></a>VÃ­ dá»¥ 1 - Free<a class="hash-link" href="#vÃ­-dá»¥-1---free" title="Direct link to heading">#</a></h2><p>HÃ£y viáº¿t má»™t chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n Ä‘Æ¡n giáº£n.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="on-chain"></a>On chain<a class="hash-link" href="#on-chain" title="Direct link to heading">#</a></h3><p>Khi chÃºng tÃ´i viáº¿t trÃ¬nh xÃ¡c thá»±c, chÃºng tÃ´i viáº¿t mÃ£ On-chain nhÆ° sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkValidator :: Datum -&gt; Redeemer -&gt; ScriptContext -&gt; Bool</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>hÃºng tÃ´i cÅ©ng Ä‘Ã£ tháº¥y phiÃªn báº£n cáº¥p tháº¥p trong Ä‘Ã³ chÃºng tÃ´i cÃ³ ba Ä‘á»‘i sá»‘ <code>Data</code> vÃ  tráº£ vá» <code>Unit</code>. VÃ  chÃºng tÃ´i tháº¥y ráº±ng cÃ³ thá»ƒ cÃ³ cÃ¡c Ä‘á»‘i sá»‘ bá»• sung trÆ°á»›c sá»‘ liá»‡u, náº¿u chÃºng tÃ´i viáº¿t má»™t táº­p lá»‡nh Ä‘Æ°á»£c tham sá»‘ hÃ³a.</p><p>ChÃºng ta cÅ©ng cÃ³ thá»ƒ cÃ³ cÃ¡c ká»‹ch báº£n chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n Ä‘Æ°á»£c tham sá»‘ hÃ³a vÃ  chÃºng ta sáº½ tháº¥y Ä‘iá»u Ä‘Ã³ trong má»™t vÃ­ dá»¥ sau. NhÆ°ng trÆ°á»›c tiÃªn chÃºng ta sáº½ xem xÃ©t má»™t cÃ¡i khÃ´ng Ä‘Æ°á»£c tham sá»‘ hÃ³a.</p><p>Äáº§u tiÃªn, hÃ£y Ä‘á»•i tÃªn hÃ m thÃ nh <code>mkPolicy</code>, xÃ³a <code>Datum</code> vÃ  <code>Redeemer</code>, vÃ  viáº¿t thÃ nh Ä‘Æ¡n giáº£n nháº¥t mÃ  chÃºng ta cÃ³ thá»ƒ..</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: ScriptContext -&gt; Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy _ = True</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y bá» qua context vÃ  luÃ´n tráº£ vá» <code>True</code>. Äiá»u nÃ y sáº½ cho phÃ©p Ä‘Ãºc vÃ  ghi mÃ£ thÃ´ng bÃ¡o tÃ¹y Ã½ vÃ  tÃªn mÃ£ thÃ´ng bÃ¡o thuá»™c vá» kÃ½ hiá»‡u tiá»n tá»‡ Ä‘Æ°á»£c liÃªn káº¿t vá»›i chÃ­nh sÃ¡ch nÃ y.</p><p>HÃ£y nhá»› ráº±ng, khi chÃºng tÃ´i viáº¿t trÃ¬nh xÃ¡c thá»±c, chÃºng tÃ´i cáº§n sá»­ dá»¥ng Template Haskell Ä‘á»ƒ biÃªn dá»‹ch hÃ m nÃ y sang mÃ£ Plutus. ChÃºng tÃ´i cáº§n lÃ m Ä‘iá»u gÃ¬ Ä‘Ã³ tÆ°Æ¡ng tá»± cho chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n cá»§a mÃ¬nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">policy :: Scripts.MonetaryPolicy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">policy = mkMonetaryPolicyScript $$(PlutusTx.compile [|| Scripts.wrapMonetaryPolicy mkPolicy ||])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ , nhÆ° trÆ°á»›c Ä‘Ã¢y, chÃºng ta cáº§n táº¡o hÃ m <code>mkPolicy</code> vÃ  <code>INLINABLE</code>,vÃ¬ má»i thá»© trong ngoáº·c Oxford {} cáº§n pháº£i cÃ³ sáºµn táº¡i thá»i Ä‘iá»ƒm biÃªn dá»‹ch.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{-# INLINABLE mkPolicy #-}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: ScriptContext -&gt; Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy _ = True</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá» chÃºng tÃ´i cÃ³ má»™t chÃ­nh sÃ¡ch, chÃºng tÃ´i cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c má»™t kÃ½ hiá»‡u tiá»n tá»‡ tá»« chÃ­nh sÃ¡ch.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol :: CurrencySymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol = scriptCurrencySymbol policy</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ , chÃºng ta cÃ³ thá»ƒ xem xÃ©t Ä‘iá»u nÃ y trong REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Free&gt; curSymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  Ä‘iá»u nÃ y hoÃ n thÃ nh pháº§n on-chain, cho viá»‡c Ä‘Ãºc tiá»n Ä‘Æ¡n giáº£n nÃ y. NhÆ°ng Ä‘á»ƒ dÃ¹ng thá»­ vÃ  tÆ°Æ¡ng tÃ¡c vá»›i nÃ³, chÃºng ta cáº§n má»™t pháº§n off-chain.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="off-chain"></a>Off chain<a class="hash-link" href="#off-chain" title="Direct link to heading">#</a></h3><p>Pháº§n off-chain nÃªn lÃ m gÃ¬? ChÃ , nÃ³ sáº½ cho phÃ©p cÃ¡c vÃ­ tÃ¹y Ã½ Ä‘Ãºc vÃ  Ä‘á»‘t cÃ¡c mÃ£ thÃ´ng bÃ¡o cá»§a biá»ƒu tÆ°á»£ng tiá»n tá»‡ nÃ y.</p><p>ChÃºng tÃ´i cÃ³ biá»ƒu tÆ°á»£ng tiá»n tá»‡, vÃ¬ váº­y Ä‘iá»u cÃ²n thiáº¿u lÃ  tÃªn mÃ£ thÃ´ng bÃ¡o vÃ  sá»‘ tiá»n chÃºng tÃ´i muá»‘n Ä‘Ãºc hoáº·c Ä‘á»‘t. VÃ  Ä‘á»‘i vá»›i Ä‘iá»u nÃ y, chÃºng tÃ´i sáº½ xÃ¡c Ä‘á»‹nh má»™t kiá»ƒu dá»¯ liá»‡u <code>MintParams</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">data MintParams = MintParams</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    { mpTokenName :: !TokenName</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    , mpAmount    :: !Integer</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    } deriving (Generic, ToJSON, FromJSON, ToSchema)    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i tháº¥y hai trÆ°á»ng - <code>mpTokenName</code> and <code>mpAmount</code>. Ã tÆ°á»Ÿng lÃ  náº¿u giÃ¡ trá»‹ <code>mpAmount</code> lÃ  DÆ°Æ¡ng, chÃºng ta nÃªn táº¡o mÃ£ thÃ´ng bÃ¡o, vÃ  náº¿u nÃ³ lÃ  Ã‚m, chÃºng ta nÃªn Ä‘á»‘t mÃ£ thÃ´ng bÃ¡o.</p><p>BÆ°á»›c tiáº¿p theo lÃ  xÃ¡c Ä‘á»‹nh lÆ°á»£c Ä‘á»“. Nhá»› láº¡i ráº±ng má»™t trong nhá»¯ng tham sá»‘ cá»§a <code>Contact</code> monad lÃ  lÆ°á»£c Ä‘á»“ xÃ¡c Ä‘á»‹nh cÃ¡c hÃ nh Ä‘á»™ng cÃ³ sáºµn mÃ  chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">type FreeSchema =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    BlockchainActions</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        .\/ Endpoint &quot;mint&quot; MintParams</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NhÆ° má»i khi, chÃºng ta cÃ³ <code>BlockchainActions</code> cung cáº¥p cho chÃºng tÃ´i quyá»n truy cáº­p vÃ o nhá»¯ng thá»© chung chung nhÆ° láº¥y khÃ³a cÃ´ng khai cá»§a riÃªng báº¡n. VÃ  á»Ÿ Ä‘Ã¢y, chÃºng tÃ´i Ä‘Ã£ thÃªm má»™t Ä‘iá»ƒm cuá»‘i <code>mint</code> báº±ng cÃ¡ch sá»­ dá»¥ng toÃ¡n tá»­ cáº¥p kiá»ƒu mÃ  chÃºng tÃ´i Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã¢y.</p><p>VÃ¬ váº­y, bÃ¢y giá» chÃºng ta cÃ³ thá»ƒ xem xÃ©t báº£n há»£p Ä‘á»“ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mint :: MintParams -&gt; Contract w FreeSchema Text ()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Trong quÃ¡ khá»©, chÃºng tÃ´i Ä‘Ã£ khÃ´ng Ä‘i sÃ¢u vÃ o chi tiáº¿t vá» pháº§n ngoÃ i chuá»—i cá»§a há»£p Ä‘á»“ng. NhÆ°ng, nhÆ° bÃ¢y giá» chÃºng ta Ä‘Ã£ biáº¿t vá» <code>Contract monad</code>   tá»« bÃ i giáº£ng trÆ°á»›c, chÃºng ta Ä‘Ã£ sáºµn sÃ ng Ä‘i vÃ o chi tiáº¿t hÆ¡n nhiá»u.</p><p>Nhá»› láº¡i ráº±ng <code>Contract</code> monad Nháº­n 4 tham sá»‘.</p><p>Äáº§u tiÃªn lÃ  Ä‘Æ¡n nguyÃªn cá»§a ngÆ°á»i viáº¿t cho phÃ©p chÃºng ta sá»­ dá»¥ng má»™t hÃ m <code>tell</code>. Báº±ng cÃ¡ch Ä‘á»ƒ tham sá»‘ nÃ y báº±ng má»™t sá»‘ nhá» w, chÃºng tÃ´i chá»‰ ra ráº±ng chÃºng tÃ´i sáº½ khÃ´ng sá»­ dá»¥ng tham sá»‘ nÃ y - chÃºng tÃ´i sáº½ khÃ´ng cÃ³ hÃ m <code>tell</code> vá»›i báº¥t ká»³ tráº¡ng thÃ¡i nÃ o.</p><p>Tham sá»‘ tiáº¿p theo lÃ  lÆ°á»£c Ä‘á»“ mÃ  chÃºng ta vá»«a tháº£o luáº­n. NhÆ° Ä‘Ã£ lÆ°u Ã½ á»Ÿ trÃªn, báº±ng cÃ¡ch sá»­ dá»¥ng, <code>FreeSchema</code>chÃºng tÃ´i cÃ³ quyá»n truy cáº­p vÃ o cÃ¡c hÃ nh Ä‘á»™ng chuá»—i khá»‘i thÃ´ng thÆ°á»ng, cÅ©ng nhÆ° endpoint<code>mint</code> .</p><p>Tham sá»‘ thá»© ba lÃ  loáº¡i thÃ´ng bÃ¡o lá»—i, vÃ  nhÆ° chÃºng ta Ä‘Ã£ tháº¥y, <code>Text</code> thÆ°á»ng lÃ  má»™t lá»±a chá»n tá»‘t.</p><p>Cuá»‘i cÃ¹ng, tham sá»‘ cuá»‘i cÃ¹ng lÃ  kiá»ƒu tráº£ vá», vÃ  há»£p Ä‘á»“ng cá»§a chÃºng ta sáº½ chá»‰ cÃ³ kiá»ƒu tráº£ vá» Unit.</p><p>BÃ¢y giá» pháº§n thÃ¢n hÃ m, nhÆ° lÃ  <code>Contact</code> lÃ  má»™t monad, ChÃºng ta cÃ³ thá»ƒ sá»­ sÃ¹ng<code>do</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mint mp = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    let val     = Value.singleton curSymbol (mpTokenName mp) (mpAmount mp)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        lookups = Constraints.monetaryPolicy policy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        tx      = Constraints.mustForgeValue val</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ledgerTx &lt;- submitTxConstraintsWith @Void lookups tx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ awaitTxConfirmed $ txId ledgerTx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Contract.logInfo @String $ printf &quot;forged %s&quot; (show val)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u Ä‘áº§u tiÃªn mÃ  chÃºng tÃ´i xÃ¡c Ä‘á»‹nh lÃ  giÃ¡ trá»‹ mÃ  chÃºng tÃ´i muá»‘n rÃ¨n luyá»‡n. Äá»‘i vá»›i Ä‘iá»u nÃ y, chÃºng tÃ´i Ä‘ang sá»­ dá»¥ng hÃ m <code>singleton</code> mÃ  chÃºng tÃ´i Ä‘Ã£ thá»­ trong REPL trÆ°á»›c Ä‘Ã³.</p><p>CÃ¡c Ä‘á»‘i sá»‘ cá»§a hÃ m <code>singleton</code>  lÃ  kÃ½ hiá»‡u tiá»n tá»‡ Ä‘áº¡i diá»‡n cho hÃ m bÄƒm cá»§a chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n, cá»™ng vá»›i tÃªn mÃ£ thÃ´ng bÃ¡o vÃ  sá»‘ tiá»n Ä‘Æ°á»£c trÃ­ch xuáº¥t tá»« <code>MintParams</code>.</p><p>bÃ¢y giá» ChÃºng ta sáº½ táº¡m thá»i bá» qua Ä‘á»‘i sá»‘ <code>lookups</code> ,vÃ  chuyá»ƒn sang Ä‘á»‘i sá»‘ <code>tx</code>.</p><p>Má»™t trong nhá»¯ng má»¥c Ä‘Ã­ch chÃ­nh cá»§a <code>Contract</code> monad lÃ  xÃ¢y dá»±ng vÃ  gá»­i cÃ¡c giao dá»‹ch. Con Ä‘Æ°á»ng mÃ  nhÃ³m Plutus Ä‘Ã£ thá»±c hiá»‡n lÃ  cung cáº¥p má»™t cÃ¡ch Ä‘á»ƒ chá»‰ Ä‘á»‹nh cÃ¡c rÃ ng buá»™c cá»§a giao dá»‹ch mÃ  báº¡n Ä‘ang xÃ¡c Ä‘á»‹nh. Sau Ä‘Ã³, cÃ¡c thÆ° viá»‡n Plutus sáº½ Ä‘áº£m nháº­n viá»‡c xÃ¢y dá»±ng giao dá»‹ch chÃ­nh xÃ¡c (náº¿u cÃ³ thá»ƒ). Äiá»u nÃ y trÃ¡i ngÆ°á»£c vá»›i viá»‡c yÃªu cáº§u chá»‰ Ä‘á»‹nh táº¥t cáº£ cÃ¡c Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra theo cÃ¡ch thá»§ cÃ´ng, Ä‘iá»u nÃ y sáº½ ráº¥t táº» nháº¡t vÃ¬ nhiá»u yÃªu cáº§u, cháº³ng háº¡n nhÆ° gá»­i tiá»n láº» trá»Ÿ láº¡i vÃ­ gá»­i, thÆ°á»ng giá»‘ng nhau.</p><p>CÃ¡c Ä‘iá»u kiá»‡n nÃ y Ä‘á»u cÃ³ tÃªn báº¯t Ä‘áº§u báº±ng <code>must</code>. CÃ³ nhá»¯ng thá»© nhÆ° <code>mustSpendScriptOutput</code>, <code>mustPayToPublicKey</code> vÃ  táº¥t cáº£ cÃ¡c loáº¡i Ä‘iá»u kiá»‡n cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t vÃ o má»™t Ä‘iá»u kiá»‡n.</p><p>Trong vÃ­ dá»¥ cá»§a chÃºng tÃ´i, chÃºng tÃ´i Ä‘ang sá»­ dá»¥ng <code>mustForgeValue</code> vÃ  chÃºng tÃ´i chuyá»ƒn nÃ³ vÃ o giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c Ä‘Ã³ <code>val</code>. Káº¿t quáº£ cá»§a viá»‡c giáº£ máº¡o cÃ¡c mÃ£ thÃ´ng bÃ¡o Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh <code>val</code> lÃ  chÃºng sáº½ káº¿t thÃºc trong vÃ­ cá»§a chÃ­nh chÃºng ta.</p><p>Khi cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh, báº¡n cáº§n gá»i má»™t hÃ m Ä‘á»ƒ gá»­i giao dá»‹ch. CÃ³ ráº¥t nhiá»u chá»©c nÄƒng nhÆ° váº­y, nhÆ°ng trong trÆ°á»ng há»£p nÃ y, chá»©c nÄƒng thÃ­ch há»£p lÃ  <code>submitTxConstraintsWith</code>.</p><p>Táº¥t cáº£ cÃ¡c hÃ m <code>submitTx</code> Ä‘á»u nháº­n cÃ¡c Ä‘iá»u kiá»‡n khai bÃ¡o nÃ y mÃ  giao dá»‹ch pháº£i thá»a mÃ£n, vÃ  sau Ä‘Ã³ chÃºng cá»‘ gáº¯ng xÃ¢y dá»±ng má»™t giao dá»‹ch Ä‘Ã¡p á»©ng cÃ¡c Ä‘iá»u kiá»‡n Ä‘Ã³. Trong trÆ°á»ng há»£p cá»§a chÃºng tÃ´i, Ä‘iá»u kiá»‡n duy nháº¥t lÃ  chÃºng tÃ´i muá»‘n giáº£ máº¡o giÃ¡ trá»‹.</p><p>VÃ¬ váº­y, nhá»¯ng gÃ¬ pháº£i lÃ m <code>submitTxConstraintsWith</code> Ä‘á»ƒ táº¡o ra má»™t giao dá»‹ch há»£p lá»‡? VÃ­ dá»¥, nÃ³ pháº£i cÃ¢n báº±ng cÃ¡c Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra. Trong trÆ°á»ng há»£p nÃ y, vÃ¬ chÃºng tÃ´i luÃ´n cÃ³ phÃ­ giao dá»‹ch, chÃºng tÃ´i cáº§n thÃ´ng tin Ä‘áº§u vÃ o bao gá»“m phÃ­ giao dá»‹ch. VÃ¬ váº­y, Ä‘á»ƒ táº¡o giao dá»‹ch, hÃ m sáº½ xem xÃ©t cÃ¡c UTxO cá»§a chÃ­nh chÃºng ta vÃ  tÃ¬m má»™t hoáº·c nhiá»u UTxO cÃ³ thá»ƒ bao tráº£ phÃ­ giao dá»‹ch vÃ  sá»­ dá»¥ng chÃºng lÃ m Ä‘áº§u vÃ o cho giao dá»‹ch.</p><p>HÆ¡n ná»¯a, náº¿u chÃºng ta Ä‘ang giáº£ máº¡o giÃ¡ trá»‹ (náº¿u <code>mpAmount</code> lÃ  giÃ¡ trá»‹ dÆ°Æ¡ng), thÃ¬ giÃ¡ trá»‹ Ä‘Ã³ pháº£i Ä‘i Ä‘Ã¢u Ä‘Ã³. Trong trÆ°á»ng há»£p nÃ y <code>submitTxConstraintsWith</code>, sáº½ táº¡o má»™t Ä‘áº§u ra gá»­i giÃ¡ trá»‹ má»›i Ä‘Æ°á»£c Ä‘Ãºc Ä‘áº¿n vÃ­ cá»§a chÃ­nh chÃºng ta.</p><p>Máº·t khÃ¡c, náº¿u chÃºng tÃ´i Ä‘á»‘t cÃ¡c mÃ£ thÃ´ng bÃ¡o (náº¿u <code>mpAmount</code> lÃ  sá»‘ Ã¢m), thÃ¬ cÃ¡c mÃ£ thÃ´ng bÃ¡o Ä‘Ã³ pháº£i Ä‘áº¿n tá»« má»™t nÆ¡i nÃ o Ä‘Ã³. Trong trÆ°á»ng há»£p Ä‘Ã³, hÃ m <code>submitTxConstraintsWith</code> sáº½ tÃ¬m má»™t Ä‘áº§u vÃ o trong vÃ­ cá»§a chÃ­nh chÃºng ta Ä‘á»ƒ láº¥y cÃ¡c mÃ£ thÃ´ng bÃ¡o.</p><p>Chá»©c nÄƒng gá»­i cÅ©ng cÃ³ thá»ƒ khÃ´ng thÃ nh cÃ´ng. VÃ­ dá»¥, náº¿u chÃºng ta muá»‘n thanh toÃ¡n cho ai Ä‘Ã³, nhÆ°ng chÃºng ta khÃ´ng cÃ³ Ä‘á»§ tiá»n trong vÃ­, nÃ³ sáº½ khÃ´ng thÃ nh cÃ´ng. Hoáº·c, náº¿u chÃºng tÃ´i yÃªu cáº§u ghi cÃ¡c mÃ£ thÃ´ng bÃ¡o mÃ  chÃºng tÃ´i khÃ´ng cÃ³, nÃ³ cÅ©ng sáº½ tháº¥t báº¡i. Khi khÃ´ng thÃ nh cÃ´ng, má»™t ngoáº¡i lá»‡ sáº½ Ä‘Æ°á»£c Ä‘Æ°a ra, vá»›i má»™t thÃ´ng bÃ¡o lá»—i thuá»™c kiá»ƒu <code>Text</code>.</p><p>BÃ¢y giá», trá»Ÿ láº¡i <code>lookups</code>.  Äá»ƒ Ä‘Ã¡p á»©ng cÃ¡c Ä‘iá»u kiá»‡n trong hÃ m
<code>mustForgeValue</code>, Ä‘Ã´i khi thÆ° viá»‡n cáº§n thÃªm thÃ´ng tin. Trong trÆ°á»ng há»£p nÃ y, Ä‘á»ƒ xÃ¡c thá»±c má»™t giao dá»‹ch giáº£ máº¡o giÃ¡ trá»‹, cÃ¡c nÃºt xÃ¡c thá»±c giao dá»‹ch pháº£i cháº¡y táº­p lá»‡nh chÃ­nh sÃ¡ch.</p><p>Tuy nhiÃªn, kÃ½ hiá»‡u tiá»n tá»‡ chá»‰ lÃ  mÃ£ bÄƒm cá»§a táº­p lá»‡nh chÃ­nh sÃ¡ch. Äá»ƒ tá»± cháº¡y táº­p lá»‡nh, nÃ³ pháº£i Ä‘Æ°á»£c bao gá»“m trong giao dá»‹ch. CÃ³ nghÄ©a lÃ , trong bÆ°á»›c xÃ¢y dá»±ng cá»§a giao dá»‹ch, khi thuáº­t toÃ¡n nhÃ¬n tháº¥y rÃ ng buá»™c <code>mustForgeValue</code>,  nÃ³ biáº¿t ráº±ng nÃ³ pháº£i Ä‘Ã­nh kÃ¨m táº­p lá»‡nh chÃ­nh sÃ¡ch tÆ°Æ¡ng á»©ng vÃ o giao dá»‹ch.</p><p>Äá»ƒ cho thuáº­t toÃ¡n biáº¿t táº­p lá»‡nh chÃ­nh sÃ¡ch á»Ÿ Ä‘Ã¢u, chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ°a ra cÃ¡c gá»£i Ã½ vÃ  Ä‘Ã¢y lÃ  cÃ¡c báº£n tra cá»©u. CÃ³ thá»ƒ sá»­ dá»¥ng nhiá»u cÃ¡ch tra cá»©u khÃ¡c nhau - báº¡n cÃ³ thá»ƒ cung cáº¥p UTxO, táº­p lá»‡nh trÃ¬nh xÃ¡c thá»±c vÃ , nhÆ° chÃºng tÃ´i lÃ m á»Ÿ Ä‘Ã¢y, báº¡n cÃ³ thá»ƒ cung cáº¥p táº­p lá»‡nh chÃ­nh sÃ¡ch tiá»n tá»‡.</p><p>Trong trÆ°á»ng há»£p cá»§a chÃºng tÃ´i, Ä‘iá»u duy nháº¥t chÃºng tÃ´i cáº§n cung cáº¥p khi tra cá»©u lÃ  chÃ­nh sÃ¡ch mÃ  chÃºng tÃ´i Ä‘Ã£ xÃ¡c Ä‘á»‹nh trÆ°á»›c Ä‘Ã³ trong táº­p lá»‡nh.</p><p>CÃ³ nhá»¯ng biáº¿n thá»ƒ cá»§a <code>submitTxConstraintsWith</code> khÃ´ng cÃ³ biáº¿n thá»ƒ <code>with</code> khÃ´ng cáº§n tra cá»©u, nhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong cÃ¡c bÃ i giáº£ng trÆ°á»›c.</p><p>Cuá»‘i cÃ¹ng,  <code>@Void</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">ledgerTx &lt;- submitTxConstraintsWith @Void lookups tx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Háº§u háº¿t cÃ¡c hÃ m rÃ ng buá»™c Ä‘á»u hÆ°á»›ng tá»›i viá»‡c sá»­ dá»¥ng má»™t táº­p lá»‡nh trÃ¬nh xÃ¡c nháº­n cá»¥ thá»ƒ. ThÃ´ng thÆ°á»ng, báº¡n cÃ³ tÃ¬nh huá»‘ng ráº±ng báº¡n Ä‘ang lÃ m viá»‡c trÃªn má»™t há»£p Ä‘á»“ng thÃ´ng minh cá»¥ thá»ƒ. VÃ  há»£p Ä‘á»“ng thÃ´ng minh cá»¥ thá»ƒ Ä‘Ã³ cÃ³ má»©c dá»¯ liá»‡u vÃ  kiá»ƒu ngÆ°á»i mua, vÃ  háº§u háº¿t cÃ¡c chá»©c nÄƒng rÃ ng buá»™c lÃ  tham sá»‘ trong kiá»ƒu dá»¯ liá»‡u vÃ  kiá»ƒu ngÆ°á»i mua. Trong trÆ°á»ng há»£p Ä‘Ã³, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trá»±c tiáº¿p kiá»ƒu dá»¯ liá»‡u mÃ  khÃ´ng cáº§n pháº£i chuyá»ƒn Ä‘á»•i nÃ³ sang kiá»ƒu Plutus
<code>Datum</code>.</p><p>NhÆ°ng trong trÆ°á»ng há»£p nÃ y, chÃºng tÃ´i khÃ´ng táº­n dá»¥ng Ä‘iá»u Ä‘Ã³. ChÃºng tÃ´i khÃ´ng cÃ³ báº¥t ká»³ táº­p lá»‡nh xÃ¡c thá»±c nÃ o. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  <code>submitTxConstraintsWith</code> sáº½ khÃ´ng biáº¿t loáº¡i nÃ o Ä‘á»ƒ sá»­ dá»¥ng cho datum vÃ  Redeemer vÃ¬ chÃºng tÃ´i khÃ´ng cÃ³ chÃºng trong vÃ­ dá»¥ nÃ y. VÃ¬ váº­y, trong trÆ°á»ng há»£p Ä‘Ã³, chÃºng ta pháº£i cho trÃ¬nh biÃªn dá»‹ch biáº¿t loáº¡i nÃ o sáº½ sá»­ dá»¥ng. ChÃºng tÃ´i khÃ´ng quan tÃ¢m, vÃ¬ khÃ´ng cÃ³ datum vÃ  Redeemer, vÃ¬ váº­y chÃºng tÃ´i sá»­ dá»¥ng loáº¡i<code>Void</code>.</p><p>NgoÃ i ra, trong cÃ¹ng má»™t dÃ²ng, chÃºng ta tháº¥y má»™t rÃ ng buá»™c Ä‘Æ¡n nguyÃªn, vÃ¬ váº­y chÃºng ta biáº¿t ráº±ng Ä‘Ã¢y lÃ  má»™t hÃ nh Ä‘á»™ng Ä‘Æ¡n nguyÃªn xáº£y ra trong <code>Contract</code> monad. LÃ½ do cho Ä‘iá»u nÃ y lÃ , Ä‘á»ƒ tra cá»©u, cháº³ng háº¡n nhÆ° cÃ¡c UTxO cá»§a chÃºng ta, hÃ m <code>submitTxConstraintsWith</code> pháº£i sá»­ dá»¥ng sá»©c máº¡nh siÃªu viá»‡t cá»§a <code>Contract</code> Ä‘Æ¡n nguyÃªn, Ä‘Ã³ lÃ  Ä‘á»ƒ truy cáº­p <code>BlockchainActions</code>.</p><p>BÃ¢y giá», <code>ledgerTx</code> vá» cÆ¡ báº£n lÃ  má»™t xá»­ lÃ½ cho giao dá»‹ch mÃ  chÃºng tÃ´i vá»«a gá»­i.</p><p>Sau Ä‘Ã³, chÃºng tÃ´i Ä‘á»£i giao dá»‹ch Ä‘Æ°á»£c xÃ¡c nháº­n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">void $ awaitTxConfirmed $ txId ledgerTx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Hiá»‡n táº¡i, náº¿u xÃ¡c thá»±c giao dá»‹ch khÃ´ng thÃ nh cÃ´ng, dÃ²ng chá» xÃ¡c nháº­n sáº½ bá»‹ cháº·n vÄ©nh viá»…n. Tuy nhiÃªn, Ä‘iá»u nÃ y sáº½ sá»›m thay Ä‘á»•i trong báº£n phÃ¡t hÃ nh sáº¯p tá»›i cá»§a Plutus Ä‘á»ƒ cho phÃ©p chÃºng tÃ´i láº¯ng nghe cÃ¡c thay Ä‘á»•i vá» tráº¡ng thÃ¡i, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ phÃ¡t hiá»‡n xem xÃ¡c thá»±c cÃ³ tháº¥t báº¡i hay khÃ´ng.</p><p>Sau khi xÃ¡c nháº­n, chÃºng tÃ´i chá»‰ cáº§n viáº¿t má»™t thÃ´ng bÃ¡o nháº­t kÃ½.</p><p>Cuá»‘i cÃ¹ng, chÃºng ta cáº§n thÃªm má»™t sá»‘ báº£n soáº¡n sáºµn Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm cuá»‘i cá»§a chÃºng ta, Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi hÃ m <code>mint</code>, vÃ­ dá»¥, trong playground.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">endpoints :: Contract () FreeSchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">endpoints = mint&#x27; &gt;&gt; endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    mint&#x27; = endpoint @&quot;mint&quot; &gt;&gt;= mint    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i xÃ¡c Ä‘á»‹nh má»™t há»£p Ä‘á»“ng khÃ¡c <code>endpoints</code>, vÃ  Ä‘Ã³ luÃ´n lÃ  tÃªn cá»§a há»£p Ä‘á»“ng mÃ  playground sáº½ cháº¡y. VÃ¬ váº­y, náº¿u báº¡n muá»‘n thá»­ nghiá»‡m Ä‘iá»u gÃ¬ Ä‘Ã³ trong playground, báº¡n luÃ´n cáº§n má»™t thá»© Ä‘Æ°á»£c gá»i lÃ  <code>endpoints</code>.</p><p>á» Ä‘Ã¢y chÃºng ta chá»‰ Ä‘á»‹nh nghÄ©a má»™t hÃ m Ä‘Æ°á»£c gá»i <code>mint&#x27;</code>vÃ  sau Ä‘Ã³ gá»i Ä‘á»‡ quy <code>endpoints</code>, vÃ¬ váº­y khi nÃ³ Ä‘Ã£ Ä‘Æ°á»£c thá»±c thi, nÃ³ sáº½ cÃ³ sáºµn Ä‘á»ƒ Ä‘Æ°á»£c thá»±c thi láº¡i.</p><p>VÃ¬ <code>mint&#x27;</code> báº±ng cÃ¡ch nÃ o Ä‘Ã³ chÃºng ta pháº£i cÃ³ Ä‘Æ°á»£c <code>MintParams</code> vÃ  Ä‘á»ƒ sá»­ dá»¥ng <code>endpoint</code>. HÃ m <code>endpoint</code> cung cáº¥p má»™t tham sá»‘ cho Contract. Khi tham sá»‘ cá»§a <code>MintParams</code> Ä‘Æ°á»£c cung cáº¥p, chÃºng tÃ´i sá»­ dá»¥ng rÃ ng buá»™c Ä‘Æ¡n nguyÃªn Ä‘á»ƒ gá»i <code>mint</code> vá»›i ccacs Ä‘á»‘i sá»‘ Ä‘Ã³.</p><p>Hai dÃ²ng cuá»‘i cÃ¹ng, nhÆ° chÃºng ta Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã¢y, chá»‰ cáº§n thiáº¿t cho giao diá»‡n ngÆ°á»i dÃ¹ng cá»§a playground.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkSchemaDefinitions &#x27;&#x27;FreeSchema</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkKnownCurrencies []    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="trong-playground"></a>Trong Playground<a class="hash-link" href="#trong-playground" title="Direct link to heading">#</a></h3><p>ChÃºng tÃ´i Ä‘Ã£ thiáº¿t láº­p má»™t ká»‹ch báº£n trong Ä‘Ã³ VÃ­ 1 Ä‘Ãºc 555 mÃ£ thÃ´ng bÃ¡o ABC vÃ  VÃ­ 2 Ä‘Ãºc 444 mÃ£ thÃ´ng bÃ¡o ABC. Sau Ä‘Ã³, sau khi chá» 1 khe, VÃ­ 1 Ä‘á»‘t 222 mÃ£ thÃ´ng bÃ¡o ABC. Cuá»‘i cÃ¹ng, chÃºng ta Ä‘á»£i 1 slot á»Ÿ cuá»‘i.</p><p><img src="/assets/images/week05__00007-270b982ffe4af5e16f350eeb431aec66.png"></p><p>BÃ¢y giá», náº¿u chÃºng ta Ä‘Ã¡nh giÃ¡ Ä‘iá»u nÃ y, trÆ°á»›c tiÃªn chÃºng ta sáº½ tháº¥y giao dá»‹ch khá»Ÿi Ä‘áº§u trong Ä‘Ã³ cÃ¡c vÃ­ Ä‘Æ°á»£c cáº¥p 1000 lovelace má»—i vÃ­.</p><p><img src="/assets/images/week05__00008-8d0dd93b6829f9cea9f29bc3342803fd.png"></p><p>Tiáº¿p theo, chÃºng tÃ´i tháº¥y hai giao dá»‹ch táº¡i Vá»‹ trÃ­ 1. Äáº§u tiÃªn lÃ  giao dá»‹ch tá»« VÃ­ 2, nÆ¡i 444 mÃ£ thÃ´ng bÃ¡o ABC Ä‘Æ°á»£c Ä‘Ãºc vÃ  má»™t khoáº£n phÃ­ 10 lovelace Ä‘Æ°á»£c thanh toÃ¡n. UTxO Ä‘á»ƒ thanh toÃ¡n phÃ­ Ä‘Ã£ Ä‘Æ°á»£c tá»± Ä‘á»™ng tÃ¬m tháº¥y bá»Ÿi chá»©c nÄƒng táº¡o giao dá»‹ch <code>submitTxConstraintsWith</code>, nhÆ° Ä‘Ã£ tháº£o luáº­n trÆ°á»›c Ä‘Ã¢y.</p><p>ChÃºng tÃ´i tháº¥y á»Ÿ Ä‘Ã¢y má»™t thá»© mÃ  chÃºng tÃ´i chÆ°a tá»«ng tháº¥y trÆ°á»›c Ä‘Ã¢y - <code>Forge</code> má»™t pháº§n cá»§a giao dá»‹ch, nÆ¡i cÃ¡c mÃ£ thÃ´ng bÃ¡o gá»‘c thá»±c sá»± Ä‘Æ°á»£c táº¡o ra. Há»™p chá»©a kÃ½ hiá»‡u tiá»n tá»‡ (bÄƒm chÃ­nh sÃ¡ch) vÃ  tÃªn mÃ£ thÃ´ng bÃ¡o.</p><p>ChÃºng tÃ´i cÅ©ng tháº¥y hai káº¿t quáº£ Ä‘áº§u ra - má»™t láº§n vá»›i sá»± thay Ä‘á»•i 990 lovelace vÃ  má»™t káº¿t quáº£ khÃ¡c vá»›i cÃ¡c mÃ£ thÃ´ng bÃ¡o má»›i Ä‘Æ°á»£c Ä‘Ãºc. TrÃªn thá»±c táº¿, cÃ¡c káº¿t quáº£ Ä‘áº§u ra nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i nhau, nhÆ°ng á»Ÿ Ä‘Ã¢y chÃºng Ä‘Æ°á»£c thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng hai UTxO riÃªng biá»‡t.</p><p><img src="/assets/images/week05__00009-764a94ea804c12f7cedfd0ad39283118.png"></p><p>Sau Ä‘Ã³, chÃºng tÃ´i tháº¥y giao dá»‹ch tá»« VÃ­ 1, nÆ¡i cÃ³ 555 mÃ£ thÃ´ng bÃ¡o ABC Ä‘Æ°á»£c Ä‘Ãºc vÃ  má»™t khoáº£n phÃ­ 10 lovelace Ä‘Æ°á»£c thanh toÃ¡n.</p><p><img src="/assets/images/week05__00010-2229fd8ca240af8ba246c7de1752e6b0.png"></p><p>Cuá»‘i cÃ¹ng, chÃºng tÃ´i tháº¥y viá»‡c Ä‘á»‘t 222 mÃ£ thÃ´ng bÃ¡o báº±ng VÃ­ 1. á» Ä‘Ã¢y, chÃºng tÃ´i tháº¥y ráº±ng thuáº­t toÃ¡n Ä‘Ã£ lÃ m má»™t Ä‘iá»u gÃ¬ Ä‘Ã³ hÆ¡i khÃ¡c má»™t chÃºt. Khi nháº­n tháº¥y ráº±ng má»™t Ä‘á»£t ghi Ä‘ang diá»…n ra, nÃ³ Ä‘Ã£ tÃ¬m tháº¥y ABC token UTxO trong Wallet 1 vÃ  sá»­ dá»¥ng chÃºng lÃ m Ä‘áº§u vÃ o. ChÃºng tÃ´i cÅ©ng lÆ°u Ã½ á»Ÿ Ä‘Ã¢y ráº±ng UTxO Ä‘áº§u ra Ä‘Æ°á»£c káº¿t há»£p, nhÆ° chÃºng tÃ´i Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n thay vÃ¬ sá»­ dá»¥ng hai UTxO Ä‘áº§u ra.</p><p><img src="/assets/images/week05__00011-ae746f5050bda534c483912702da91aa.png"></p><p>VÃ  chÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ xem cÃ¡c sá»‘ dÆ° cuá»‘i cÃ¹ng Ä‘á»ƒ kiá»ƒm tra láº¡i xem táº¥t cáº£ Ä‘Ã£ diá»…n ra theo Ä‘Ãºng káº¿ hoáº¡ch chÆ°a.</p><p><img src="/assets/images/week05__00012-69d34b65fcb4c74f35cc1ebe90b9ef96.png"></p><p>Vá»›i chÃ­nh sÃ¡ch tiá»n tá»‡ cá»§a chÃºng tÃ´i, chÃºng tÃ´i cÃ³ thá»ƒ táº¡o cÃ¡c giao dá»‹ch giáº£ máº¡o vÃ  Ä‘á»‘t tÃ¹y Ã½ báº±ng báº¥t ká»³ vÃ­ nÃ o. VÃ¬ váº­y, Ä‘Ã¢y cÃ³ láº½ khÃ´ng pháº£i lÃ  má»™t chÃ­nh sÃ¡ch tiá»n tá»‡ tá»‘t. Má»¥c Ä‘Ã­ch cá»§a mÃ£ thÃ´ng bÃ¡o lÃ  Ä‘áº¡i diá»‡n cho giÃ¡ trá»‹, nhÆ°ng náº¿u báº¥t ká»³ ai táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o cÃ³ thá»ƒ táº¡o ra mÃ£ thÃ´ng bÃ¡o má»›i, thÃ¬ mÃ£ thÃ´ng bÃ¡o nÃ y sáº½ khÃ´ng cÃ³ nhiá»u Ã½ nghÄ©a. CÃ³ thá»ƒ cÃ³ má»™t sá»‘ trÆ°á»ng há»£p sá»­ dá»¥ng ká»³ láº¡ cho nÃ³, nhÆ°ng trÃªn thá»±c táº¿, chÃ­nh sÃ¡ch nÃ y khÃ¡ vÃ´ dá»¥ng.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="thá»­-nghiá»‡m-vá»›i-emulatortrace"></a>Thá»­ nghiá»‡m vá»›i EmulatorTrace<a class="hash-link" href="#thá»­-nghiá»‡m-vá»›i-emulatortrace" title="Direct link to heading">#</a></h3><p>HÃ£y cÅ©ng kiá»ƒm tra Ä‘iá»u nÃ y tá»« dÃ²ng lá»‡nh, thay vÃ¬ trong playground.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">test :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test = runEmulatorTraceIO $ do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    let tn = &quot;ABC&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    h1 &lt;- activateContractWallet (Wallet 1) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    h2 &lt;- activateContractWallet (Wallet 2) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    callEndpoint @&quot;mint&quot; h1 $ MintParams</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        { mpTokenName = tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        , mpAmount    = 555</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    callEndpoint @&quot;mint&quot; h2 $ MintParams</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        { mpTokenName = tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        , mpAmount    = 444</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    callEndpoint @&quot;mint&quot; h1 $ MintParams</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        { mpTokenName = tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        , mpAmount    = -222</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng tÃ´i cháº¡y Ä‘iá»u nÃ y trong REPL, chÃºng tÃ´i sáº½ tháº¥y nhá»¯ng gÃ¬ chÃºng tÃ´i Ä‘Ã£ tháº¥y trong sÃ¢n chÆ¡i, nhÆ°ng thay vÃ o Ä‘Ã³ trÃªn báº£ng Ä‘iá»u khiá»ƒn. NÃ³ khÃ´ng Ä‘áº¹p, nhÆ°ng nÃ³ nhanh hÆ¡n.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Free&gt; test</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number 555.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W1: TxSubmit: 7c01d39fc031815eaf05d97709e4973a24dfa38e9dd68a4fd1ec92bb80cf76e4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number 444.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W2: TxSubmit: 6ba7eb4441992284e687d184080d4a8693e7b188fc45150d6e7ccd1243968f53</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 6ba7eb4441992284e687d184080d4a8693e7b188fc45150d6e7ccd1243968f53</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 7c01d39fc031815eaf05d97709e4973a24dfa38e9dd68a4fd1ec92bb80cf76e4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\&quot;ABC\&quot;,555)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\&quot;ABC\&quot;,444)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number -222.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: W1: TxSubmit: 95d42e93ee41ab5bed7857b176be5a4e16602323eaacaa90f3bb807a9fd235c0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: TxnValidate 95d42e93ee41ab5bed7857b176be5a4e16602323eaacaa90f3bb807a9fd235c0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: SlotAdd Slot 3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00003: `` CONTRACT LOG: &quot;forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\&quot;ABC\&quot;,-222)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00003: SlotAdd Slot 4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999980</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf, &quot;ABC&quot;}: 333</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf, &quot;ABC&quot;}: 444</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...    </span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="vÃ­-dá»¥-2---signed"></a>VÃ­ dá»¥ 2 - Signed<a class="hash-link" href="#vÃ­-dá»¥-2---signed" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="on-chain-1"></a>On-chain<a class="hash-link" href="#on-chain-1" title="Direct link to heading">#</a></h3><p>HÃ£y xem má»™t vÃ­ dá»¥ thá»±c táº¿ hÆ¡n.</p><p>ChÃºng tÃ´i sáº½ láº¥y má»™t báº£n sao cá»§a mÃ´-Ä‘un Miá»…n phÃ­ vÃ  gá»i nÃ³ lÃ  ÄÃ£ kÃ½.</p><p>CÃ³ láº½ vÃ­ dá»¥ dá»… nháº¥t vá» chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n thá»±c táº¿ lÃ  má»™t chÃ­nh sÃ¡ch mÃ  viá»‡c Ä‘Ãºc vÃ  Ä‘á»‘t mÃ£ thÃ´ng bÃ¡o bá»‹ háº¡n cháº¿ Ä‘á»‘i vá»›i cÃ¡c giao dá»‹ch Ä‘Æ°á»£c kÃ½ bá»Ÿi má»™t hÃ m bÄƒm khÃ³a cÃ´ng khai cá»¥ thá»ƒ. Äiá»u Ä‘Ã³ tÆ°Æ¡ng tá»± nhÆ° má»™t ngÃ¢n hÃ ng trung Æ°Æ¡ng, báº±ng cÃ¡c loáº¡i tiá»n tá»‡ fiat.</p><p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  cÃ¡c chÃ­nh sÃ¡ch cá»§a chÃºng tÃ´i khÃ´ng cÃ²n lÃ  khÃ´ng cÃ³ cÃ¡c tham sá»‘. ChÃºng tÃ´i cáº§n mÃ£ bÄƒm khÃ³a cÃ´ng khai. NgoÃ i ra, chÃºng ta cÅ©ng cáº§n pháº£i xem xÃ©t bá»‘i cáº£nh, vÃ¬ váº­y chÃºng ta khÃ´ng thá»ƒ bá» qua nhÆ° láº§n trÆ°á»›c.</p><p>ChÃºng tÃ´i nhá»› ráº±ng <code>scriptContextTxInfo</code> tá»« ngá»¯ cáº£nh cÃ³ chá»©a danh sÃ¡ch táº¥t cáº£ cÃ¡c bÃªn kÃ½ káº¿t cá»§a giao dá»‹ch. VÃ¬ váº­y, chÃºng tÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘iá»u nÃ y Ä‘á»ƒ xem liá»‡u ngÆ°á»i kÃ½ Ä‘Æ°á»£c yÃªu cáº§u cÃ³ pháº£i lÃ  má»™t trong sá»‘ há» hay khÃ´ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: PubKeyHash -&gt; ScriptContext -&gt; Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy pkh ctx = txSignedBy (scriptContextTxInfo ctx) pkh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ¡c hÃ m <code>txSignedBy</code> lÃ  má»™t cÃ¡ch thuáº­n tiá»‡n Ä‘á»ƒ kiá»ƒm tra nÃ y. Trong cÃ¡c vÃ­ dá»¥ trÆ°á»›c, chÃºng tÃ´i Ä‘Ã£ sá»­ dá»¥ng hÃ m <code>elem</code> Ä‘á»ƒ kiá»ƒm tra xem nÃ³ cÃ³ tá»“n táº¡i trong danh sÃ¡ch hay khÃ´ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Free&gt; import Ledger</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Ledger Week05.Free&gt; :t txSignedBy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">txSignedBy :: TxInfo -&gt; PubKeyHash -&gt; Bool</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng ta cáº§n cáº­p nháº­t pháº§n mÃ£ biÃªn dá»‹ch hÃ m <code>mkPolicy</code>  cá»§a chÃºng ta thÃ nh mÃ£ Plutus. ChÃºng tÃ´i sáº½ sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t tÆ°Æ¡ng tá»± mÃ  chÃºng tÃ´i Ä‘Ã£ sá»­ dá»¥ng khi viáº¿t cÃ¡c táº­p lá»‡nh trÃ¬nh xÃ¡c thá»±c. Cá»¥ thá»ƒ, chÃºng tÃ´i sá»­ dá»¥ng hÃ m <code>applyCode</code> Ä‘á»ƒ cho phÃ©p chÃºng tÃ´i tham chiáº¿u <code>pkh</code>, giÃ¡ trá»‹ cá»§a nÃ³ chá»‰ Ä‘Æ°á»£c biáº¿t trong thá»i gian cháº¡y.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">policy :: PubKeyHash -&gt; Scripts.MonetaryPolicy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">policy pkh = mkMonetaryPolicyScript $</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $$(PlutusTx.compile [|| Scripts.wrapMonetaryPolicy . mkPolicy ||])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    `PlutusTx.applyCode`</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    PlutusTx.liftCode pkh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i cÅ©ng cáº§n cáº­p nháº­t hÃ m <code>curSymbol</code>, vÃ¬ nÃ³ hiá»‡n phá»¥ thuá»™c vÃ o hÃ m bÄƒm cá»§a khÃ³a cÃ´ng khai. NÃ³ phá»¥ thuá»™c vÃ o nÃ³ Ä‘á»ƒ nÃ³ cÃ³ thá»ƒ chuyá»ƒn nÃ³ Ä‘áº¿n hÃ m <code>policy</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol :: PubKeyHash -&gt; CurrencySymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol = scriptCurrencySymbol . policy</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>LÆ°u Ã½, dÃ²ng thá»© hai á»Ÿ Ä‘Ã¢y, pháº§n ná»™i dung, lÃ  cÃ¡ch viáº¿t ngáº¯n hÆ¡n:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol pkh = scriptCurrencySymbol $ policy pkh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y rÃµ rÃ ng, khi báº¡n xem xÃ©t má»™t cÃ¡i gÃ¬ Ä‘Ã³ nhÆ° sau, Ä‘Ã¢u <code>timesSix</code> chá»‰ lÃ  má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ viáº¿t káº¿t quáº£ cá»§a viá»‡c káº¿t há»£p cÃ¡c hÃ m <code>timesTwo</code> and <code>timesThree</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">timesSix x = timesTwo $ timesThree x </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>giá»‘ng há»‡t nhÆ° ...</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">timesSix = timesTwo . timesThree</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>QuÃ¡ trÃ¬nh Ä‘Æ¡n giáº£n hÃ³a nÃ y Ä‘Æ°á»£c gá»i lÃ  giáº£m ETA, vÃ¬ váº­y náº¿u báº¡n tá»«ng tháº¥y IDE cá»§a mÃ¬nh gá»£i Ã½ ráº±ng báº¡n cÃ³ thá»ƒ giáº£m ETA, thÃ¬ Ä‘Ã¢y chÃ­nh lÃ  nhá»¯ng gÃ¬ nÃ³ Ä‘ang nÃ³i Ä‘áº¿n.</p><p>BÃ¢y giá» cho mÃ£ off-chain.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="off-chain-1"></a>Off-chain<a class="hash-link" href="#off-chain-1" title="Direct link to heading">#</a></h3><p>We don\&#x27;t need to extend the <code>MintParams</code> ChÃºng tÃ´i khÃ´ng cáº§n má»Ÿ rá»™ng <code>MintParams</code> kiá»ƒu dá»¯ liá»‡u cho Off-chain. VÃ­ muá»‘n Ä‘Ãºc hoáº·c Ä‘á»‘t tiá»n tá»‡ cÃ³ thá»ƒ kÃ½ báº±ng mÃ£ bÄƒm khÃ³a cÃ´ng khai cá»§a chÃ­nh nÃ³. ÄÃ¢y lÃ  chá»¯ kÃ½ duy nháº¥t mÃ  vÃ­ cÃ³ thá»ƒ cung cáº¥p vÃ  nÃ³ cÃ³ kháº£ nÄƒng tá»± tra cá»©u.</p><p>ChÃºng tÃ´i sáº½ thá»±c hiá»‡n má»™t thay Ä‘á»•i Ä‘á»‘i vá»›i tÃªn cá»§a lÆ°á»£c Ä‘á»“ cho rÃµ rÃ ng. Táº¥t nhiÃªn, chÃºng tÃ´i cÅ©ng sáº½ cáº­p nháº­t tÃªn nÃ y báº¥t cá»© nÆ¡i nÃ o nÃ³ xuáº¥t hiá»‡n trong táº­p lá»‡nh há»£p Ä‘á»“ng.t
script.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">type SignedSchema =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    BlockchainActions</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        .\/ Endpoint &quot;mint&quot; MintParams</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», Ä‘á»‘i vá»›i hÃ m <code>mint</code>, chÃºng ta cáº§n chuyá»ƒn hÃ m bÄƒm khÃ³a cÃ´ng khai cho hÃ m <code>curSymbol</code>. Náº¯m giá»¯ khÃ³a cÃ´ng khai lÃ  thá»© Ä‘Æ°á»£c cung cáº¥p bá»Ÿi <code>BlockchainActions</code>. VÃ¬ váº­y, chÃºng tÃ´i sáº½ láº¥y Ä‘iá»u nÃ y tá»« <code>Contract</code> vÃ  Ã¡p dá»¥ng hÃ m <code>pubKeyHash</code>cho nÃ³.</p><p>Má»™t cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y sáº½ lÃ </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pk &lt;- Contract.ownPubKey</span></div><div class="token-line" style="color:#393A34"><span class="token plain">let pkh = pubKeyHash pk</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Tuy nhiÃªn, nhÆ° <code>Contract</code> lÃ  má»™t monad, vÃ  do Ä‘Ã³ lÃ  má»™t thá»ƒ hiá»‡n cá»§a <code>Functor</code>,  chÃºng ta cÃ³ hÃ m <code>fmap</code> , hÃ m nÃ y sáº½ biáº¿n
<code>Contract a</code> thÃ nh <code>Contract b</code>. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng Ä‘iá»u Ä‘Ã³ báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>pubKeyHash</code> nhÆ° lÃ  (a -&gt; b) cá»§a hÃ m fmap vÃ  sáº½ chuyá»ƒn <code>Contract pubKey</code> thÃ nh <code>Contract pubKeyHash</code>,vÃ  sau Ä‘Ã³ cÃ³ thá»ƒ hÃ m grab Ä‘á»ƒ láº¥y giÃ¡ trá»‹.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pkh &lt;- fmap pubKeyHash Contract.ownPubKey</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>CÃ²n má»™t Ä‘iá»u ná»¯a chÃºng tÃ´i cÃ³ thá»ƒ lÃ m Ä‘á»ƒ cáº£i thiá»‡n Ä‘iá»u nÃ y. CÃ³ má»™t nhÃ  Ä‘iá»u hÃ nh cho <code>fmap</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pkh &lt;- pubKeyHash &lt;$&gt; Contract.ownPubKey</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ÄÆ°á»£c rá»“i, bÃ¢y giá» chÃºng ta hÃ£y cáº­p nháº­t dÃ²ng tra cá»©u Ä‘á»ƒ chuyá»ƒn trong hÃ m bÄƒm khÃ³a cÃ´ng khai.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">lookups = Constraints.monetaryPolicy $ policy pkh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  bÃ¢y giá» chÃºng ta Ä‘Ã£ hoÃ n thÃ nh viá»‡c sá»­a Ä‘á»•i hÃ m <code>mint</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mint :: MintParams -&gt; Contract w SignedSchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mint mp = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    pkh &lt;- pubKeyHash &lt;$&gt; Contract.ownPubKey</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    let val     = Value.singleton (curSymbol pkh) (mpTokenName mp) (mpAmount mp)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        lookups = Constraints.monetaryPolicy $ policy pkh</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        tx      = Constraints.mustForgeValue val</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ledgerTx &lt;- submitTxConstraintsWith @Void lookups tx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ awaitTxConfirmed $ txId ledgerTx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Contract.logInfo @String $ printf &quot;forged %s&quot; (show val)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ¬ váº­y, chÃºng ta hÃ£y thá»­ nÃ³ báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>test</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.}"><div tabindex="0" class="prism-code language-{.} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Ledger Week05.Signed&gt; Week05.Signed.test</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number 555.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W1: TxSubmit: 20289e7b1bb6692b35e24e0f9293327f9169d843ae0ea431186fdefae6092a44</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number 444.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W2: TxSubmit: 1c367cf81dd2da478abb96235ee16facf9f7d47374c9455d5fdd516aaf04d0c2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 1c367cf81dd2da478abb96235ee16facf9f7d47374c9455d5fdd516aaf04d0c2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 20289e7b1bb6692b35e24e0f9293327f9169d843ae0ea431186fdefae6092a44</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521,Map [(\&quot;ABC\&quot;,555)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(2a964fa6314803cf1b61165aeb1d758e355aae9480a29e282b58e76983f101ba,Map [(\&quot;ABC\&quot;,444)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;mpAmount&quot;,Number -222.0),(&quot;mpTokenName&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: W1: TxSubmit: 6e20d243447d7f49de509ef6b52c6d947769d95a6451c9cda53e42a0ba02fa69</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: TxnValidate 6e20d243447d7f49de509ef6b52c6d947769d95a6451c9cda53e42a0ba02fa69</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: SlotAdd Slot 3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00003: `` CONTRACT LOG: &quot;forged Value (Map [(7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521,Map [(\&quot;ABC\&quot;,-222)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00003: SlotAdd Slot 4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999980</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521, &quot;ABC&quot;}: 333</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {2a964fa6314803cf1b61165aeb1d758e355aae9480a29e282b58e76983f101ba, &quot;ABC&quot;}: 444</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u nÃ y trÃ´ng ráº¥t giá»‘ng vá»›i trÆ°á»›c Ä‘Ã¢y, nhÆ°ng láº§n nÃ y, hÃ£y lÆ°u Ã½ ráº±ng, trong khi tÃªn mÃ£ thÃ´ng bÃ¡o giá»‘ng nhau, cÃ¡c kÃ½ hiá»‡u tiá»n tá»‡ khÃ¡c nhau cho má»—i vÃ­.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="nft---non-fungible-tokens"></a>NFT - Non-Fungible Tokens<a class="hash-link" href="#nft---non-fungible-tokens" title="Direct link to heading">#</a></h2><p>BÃ¢y giá» chÃºng ta hÃ£y nÃ³i vá» NFT - Token khÃ´ng Fungible. NFT lÃ  cÃ¡c mÃ£ thÃ´ng bÃ¡o cÃ³ sá»‘ lÆ°á»£ng chÃ­nh xÃ¡c lÃ  1.</p><p>CÃ¡c vÃ­ dá»¥ vá» mÃ£ thÃ´ng bÃ¡o gá»‘c mÃ  chÃºng tÃ´i Ä‘Ã£ nghiÃªn cá»©u cho Ä‘áº¿n nay cháº¯c cháº¯n khÃ´ng pháº£i lÃ  NFT vÃ¬ chÃºng tÃ´i cÃ³ thá»ƒ dá»… dÃ ng Ä‘Ãºc bao nhiÃªu tÃ¹y thÃ­ch. Äiá»u nÃ y khÃ´ng chá»‰ Ä‘Ãºng trong vÃ­ dá»¥ Ä‘áº§u tiÃªn, nÆ¡i báº¥t ká»³ ai cÅ©ng cÃ³ thá»ƒ Ä‘Ãºc mÃ£ thÃ´ng bÃ¡o, mÃ  cÃ²n trong vÃ­ dá»¥ thá»© hai, trong Ä‘Ã³, miá»…n lÃ  báº¡n lÃ  chá»§ sá»Ÿ há»¯u cá»§a mÃ£ bÄƒm khÃ³a cÃ´ng khai chÃ­nh xÃ¡c, báº¡n cÃ³ thá»ƒ Ä‘Ãºc mÃ£ thÃ´ng bÃ¡o khÃ´ng giá»›i háº¡n cho kÃ½ hiá»‡u tiá»n tá»‡ vÃ  mÃ£ thÃ´ng bÃ¡o liÃªn quan TÃªn.</p><p>Äá»ƒ táº¡o ra má»™t NFT, cÃ³ láº½ Ã½ tÆ°á»Ÿng ngÃ¢y thÆ¡ Ä‘áº§u tiÃªn sáº½ lÃ  xem xÃ©t trÆ°á»ng giáº£ máº¡o trong chÃ­nh sÃ¡ch vÃ  thá»±c thi má»™t chÃ­nh sÃ¡ch trong Ä‘Ã³ sá»‘ tiá»n lÃ  má»™t.</p><p>NhÆ°ng Ä‘iá»u Ä‘Ã³ khÃ´ng giÃºp Ä‘Æ°á»£c gÃ¬ cho chÃºng tÃ´i. Äiá»u Ä‘Ã³ chá»‰ cÃ³ nghÄ©a lÃ  trong má»™t giao dá»‹ch, báº¡n chá»‰ cÃ³ thá»ƒ Ä‘Ãºc má»™t mÃ£ thÃ´ng bÃ¡o. NhÆ°ng khÃ´ng ai cÃ³ thá»ƒ ngÄƒn chÃºng tÃ´i gá»­i bao nhiÃªu trong sá»‘ cÃ¡c giao dá»‹ch Ä‘Ã³ tÃ¹y thÃ­ch.</p><p>TÃ¹y chá»n thá»© hai thá»±c sá»± Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn chuá»—i khá»‘i Cardano. NFT Ä‘Ã£ cÃ³ sáºµn ká»ƒ tá»« Mary fork, cÃ³ trÆ°á»›c Plutus, vÃ  Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng thá»i háº¡n.</p><p>Trong cÃ¡c vÃ­ dá»¥ trÆ°á»›c, chÃºng ta Ä‘Ã£ tháº¥y cÃ¡ch thá»i gian cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p trong cÃ¡c táº­p lá»‡nh xÃ¡c thá»±c vÃ  Ä‘iá»u tÆ°Æ¡ng tá»± cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n trong cÃ¡c táº­p lá»‡nh chÃ­nh sÃ¡ch.</p><p>Ã tÆ°á»Ÿng á»Ÿ Ä‘Ã¢y lÃ  chá»‰ cho phÃ©p Ä‘Ãºc tiá»n trÆ°á»›c khi thá»i háº¡n nháº¥t Ä‘á»‹nh trÃ´i qua. Sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p nÃ y, náº¿u báº¡n muá»‘n Ä‘Ãºc NFT, báº¡n Ä‘Ãºc má»™t mÃ£ thÃ´ng bÃ¡o trÆ°á»›c thá»i háº¡n, sau Ä‘Ã³ cho phÃ©p thá»i háº¡n trÃ´i qua. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng, sau thá»i háº¡n, sáº½ khÃ´ng cÃ³ mÃ£ thÃ´ng bÃ¡o má»›i nÃ o Ä‘Æ°á»£c Ä‘Ãºc.</p><p>Tuy nhiÃªn, Ä‘á»ƒ kiá»ƒm tra ráº±ng báº¡n chá»‰ Ä‘Ãºc má»™t mÃ£ thÃ´ng bÃ¡o trÆ°á»›c thá»i háº¡n, báº¡n cáº§n má»™t cÃ¡i gÃ¬ Ä‘Ã³ giá»‘ng nhÆ° má»™t cÃ´ng cá»¥ khÃ¡m phÃ¡ chuá»—i khá»‘i. VÃ¬ váº­y, theo nghÄ©a nÃ y, chÃºng khÃ´ng pháº£i lÃ  NFT thá»±c sá»±, trong chá»«ng má»±c báº£n thÃ¢n biá»ƒu tÆ°á»£ng tiá»n tá»‡ Ä‘áº£m báº£o ráº±ng chÃºng lÃ  duy nháº¥t.</p><p>Sá»­ dá»¥ng Plutus, cÃ³ thá»ƒ táº¡o ra cÃ¡c NFT thá»±c sá»±. Náº¿u báº¡n biáº¿t táº­p lá»‡nh chÃ­nh sÃ¡ch tÆ°Æ¡ng á»©ng vá»›i kÃ½ hiá»‡u tiá»n tá»‡, báº¡n cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng chá»‰ cÃ³ má»™t mÃ£ thÃ´ng bÃ¡o Ä‘ang tá»“n táº¡i mÃ  khÃ´ng cáº§n pháº£i sá»­ dá»¥ng Ä‘áº¿n má»™t thá»© gÃ¬ Ä‘Ã³ nhÆ° trÃ¬nh khÃ¡m phÃ¡ chuá»—i khá»‘i.</p><p>VÃ , suy nghÄ© vá» cÃ¡ch lÃ m Ä‘iá»u Ä‘Ã³, pháº£i cÃ³ má»™t cÃ¡ch Ä‘á»ƒ ngÄƒn cháº·n viá»‡c cÃ³ nhiá»u hÆ¡n má»™t giao dá»‹ch Ä‘Ãºc tiá»n cho mÃ£ thÃ´ng bÃ¡o Ä‘Æ°á»£c Ä‘á» cáº­p. Báº¥t cá»© Ä‘iá»u gÃ¬ báº¡n viáº¿t trong táº­p lá»‡nh chÃ­nh sÃ¡ch cá»§a mÃ¬nh, nÃ³ chá»‰ pháº£i tráº£ vá» true cho má»™t giao dá»‹ch, do Ä‘Ã³ khÃ´ng thá»ƒ thá»±c hiá»‡n láº¡i Ä‘iá»u tÆ°Æ¡ng tá»± trong má»™t giao dá»‹ch khÃ¡c.</p><p>LÃºc Ä‘áº§u, Ä‘iá»u nÃ y nghe cÃ³ váº» khÃ´ng thá»ƒ. Táº¡i sao báº¡n khÃ´ng thá»ƒ cháº¡y láº¡i cÃ¹ng má»™t giao dá»‹ch vÃ  xÃ¡c thá»±c láº¡i thÃ nh cÃ´ng? Ngay cáº£ khi xem xÃ©t thá»i háº¡n, Ä‘iá»u gÃ¬ ngÄƒn giao dá»‹ch thá»© hai trong cÃ¹ng má»™t vá»‹ trÃ­ vÆ°á»£t qua xÃ¡c thá»±c?</p><p>ChÃ¬a khÃ³a á»Ÿ Ä‘Ã¢y lÃ  chÃºng ta cáº§n má»™t cÃ¡i gÃ¬ Ä‘Ã³ Ä‘á»™c Ä‘Ã¡o. Má»™t thá»© chá»‰ cÃ³ thá»ƒ tá»“n táº¡i trong má»™t láº§n giao dá»‹ch vÃ  khÃ´ng bao giá» láº·p láº¡i. ÄÃ¢y lÃ  má»™t thá»§ thuáº­t quan trá»ng vÃ  cáº§n ghi nhá»›.</p><p>Ã tÆ°á»Ÿng lÃ  sá»­ dá»¥ng UTxOs. UTxO lÃ  duy nháº¥t. UTxO lÃ  Ä‘áº§u ra cá»§a má»™t giao dá»‹ch vÃ  sá»‘ nháº­n dáº¡ng duy nháº¥t cá»§a nÃ³ lÃ  ID giao dá»‹ch vÃ  chá»‰ má»¥c cá»§a nÃ³ trong danh sÃ¡ch cÃ¡c Ä‘áº§u ra tá»« giao dá»‹ch Ä‘Ã³.</p><p>LÃ½ do mÃ  cÃ¡c giao dá»‹ch lÃ  duy nháº¥t lÃ  má»™t chÃºt tinh táº¿. ChÃºng sáº½ khÃ´ng nháº¥t thiáº¿t lÃ  duy nháº¥t náº¿u nÃ³ khÃ´ng pháº£i lÃ  phÃ­. Náº¿u khÃ´ng cÃ³ phÃ­, báº¡n cÃ³ thá»ƒ cÃ³ má»™t giao dá»‹ch khÃ´ng cÃ³ Ä‘áº§u vÃ o vÃ  chá»‰ vá»›i Ä‘áº§u ra khÃ´ng cÃ³ giÃ¡ trá»‹. Má»™t giao dá»‹ch nhÆ° váº­y sáº½ cÃ³ má»™t sá»‘ bÄƒm chÃ­nh xÃ¡c má»—i khi nÃ³ Ä‘Æ°á»£c cháº¡y vÃ  do Ä‘Ã³ cÃ³ cÃ¹ng má»™t id giao dá»‹ch chÃ­nh xÃ¡c. NhÆ°ng vá»›i phÃ­, má»™t giao dá»‹ch nhÆ° váº­y khÃ´ng thá»ƒ tá»“n táº¡i, vÃ¬ báº¡n luÃ´n cáº§n Ä‘áº§u vÃ o cung cáº¥p phÃ­ vÃ  phÃ­ khÃ´ng bao giá» cÃ³ thá»ƒ Ä‘áº¿n tá»« cÃ¹ng má»™t UTxO nhÆ° Ä‘áº§u vÃ o.</p><p>VÃ¬ váº­y, Ä‘á»ƒ táº¡o NFT, chÃºng tÃ´i sáº½ cung cáº¥p má»™t UTxO cá»¥ thá»ƒ lÃ m tham sá»‘ cho chÃ­nh sÃ¡ch Ä‘Ãºc tiá»n vÃ  trong chÃ­nh sÃ¡ch nÃ y, chÃºng tÃ´i sáº½ kiá»ƒm tra xem giao dá»‹ch cÃ³ sá»­ dá»¥ng UTxO nÃ y hay khÃ´ng. VÃ , nhÆ° chÃºng tÃ´i vá»«a lÆ°u Ã½, má»™t khi UTxO Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c tiÃªu thá»¥, nÃ³ khÃ´ng bao giá» cÃ³ thá»ƒ Ä‘Æ°á»£c tiÃªu thá»¥ láº¡i.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="vÃ­-dá»¥-3---nft"></a>VÃ­ dá»¥ 3 - NFT<a class="hash-link" href="#vÃ­-dá»¥-3---nft" title="Direct link to heading">#</a></h3><p>ChÃºng tÃ´i báº¯t Ä‘áº§u vá»›i má»™t báº£n sao cá»§a vÃ­ dá»¥ trÆ°á»›c <code>Signed</code> avÃ  chÃºng tÃ´i sáº½ gá»i <code>NFT</code>.</p><p>VÃ¬ váº­y, hÃ£y biáº¿n chÃ­nh sÃ¡ch Ä‘Ã£ kÃ½ thÃ nh má»™t chÃ­nh sÃ¡ch NFT thá»±c sá»±.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="on-chain-2"></a>On-chain<a class="hash-link" href="#on-chain-2" title="Direct link to heading">#</a></h4><p>Äáº§u tiÃªn, chÃºng tÃ´i sáº½ khÃ´ng sá»­ dá»¥ng mÃ£ bÄƒm khÃ³a cÃ´ng khai lÃ m Ä‘áº§u vÃ o ná»¯a, nhÆ° thá»ƒ chÃºng tÃ´i lÃ  ngÃ¢n hÃ ng trung Æ°Æ¡ng, mÃ  thay vÃ o Ä‘Ã³ sáº½ sá»­ dá»¥ng UTxO. Váº­y, loáº¡i nÃ o tÆ°Æ¡ng á»©ng vá»›i UTxO?</p><p>HÃ£y xem REPL vÃ  nháº¯c nhá»Ÿ báº£n thÃ¢n vá» Ä‘iá»u Ä‘Ã³ <code>TxInfo</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Signed Week05.Free&gt; import Ledger</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Signed Ledger Week05.Free&gt; :i TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type TxInfo :: `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    = TxInfo {txInfoInputs :: [TxInInfo],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoInputsFees :: [TxInInfo],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoOutputs :: [TxOut],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoFee :: Value,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoForge :: Value,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoDCert :: [Plutus.V1.Ledger.DCert.DCert],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoWdrl :: [(Plutus.V1.Ledger.Credential.StakingCredential,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                Integer)],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoValidRange :: SlotRange,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoSignatories :: [PubKeyHash],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoData :: [(DatumHash, Datum)],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                txInfoId :: TxId}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i, chÃºng tÃ´i quan tÃ¢m Ä‘áº¿n trÆ°á»ng nÃ y:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">txInfoInputs :: [TxInInfo]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y xem xÃ©t kiá»ƒu <code>TxInInfo</code></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Signed Ledger Week05.Free&gt; :i TxInInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type TxInInfo :: `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data TxInInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    = TxInInfo {txInInfoOutRef :: TxOutRef, txInInfoResolved :: TxOut}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta tháº¥y ráº±ng nÃ³ lÃ  má»™t báº£n ghi cÃ³ hai trÆ°á»ng. Äáº§u tiÃªn lÃ  vá» loáº¡i <code>TxOutRef</code> vÃ  Ä‘iá»u nÃ y tham chiáº¿u Ä‘áº¿n UTxO, chÃ­nh xÃ¡c lÃ  nhá»¯ng gÃ¬ chÃºng ta cáº§n. VÃ¬ váº­y, chÃºng ta hÃ£y sá»­ dá»¥ng nÃ³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: TxOutRef -&gt; ScriptContext -&gt; Bool</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng tÃ´i Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ viáº¿t logic. ChÃºng ta pháº£i kiá»ƒm tra xem táº­p lá»‡nh cÃ³ chá»©a UTxO Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh lÃ m Ä‘áº§u vÃ o hay khÃ´ng. ChÃºng tÃ´i sáº½ á»§y thÃ¡c Ä‘iá»u nÃ y cho má»™t chá»©c nÄƒng trá»£ giÃºp. Chá»©c nÄƒng nÃ y, mÃ  chÃºng tÃ´i sáº½ gá»i hÃ m <code>hasUTxO</code> sá»­ dá»¥ng hÃ m <code>any</code>, lÃ  má»™t hÃ m tiÃªu chuáº©n Prelude, nhÆ°ng cÅ©ng cÃ³ phiÃªn báº£n Plutus, vÃ¬ nhá»¯ng lÃ½ do mÃ  chÃºng tÃ´i Ä‘Ã£ giáº£i quyáº¿t trÆ°á»›c Ä‘Ã³.</p><p>CÃ¡c hÃ m <code>any</code> cÃ³ má»™t Ä‘Æ¡n vá»‹ (má»™t hÃ m tráº£ vá» má»™t boolean) vÃ  Ã¡p dá»¥ng nÃ³ vÃ o má»™t bá»™ sÆ°u táº­p Ä‘áº§u vÃ o cá»§a cÃ¡c kiá»ƒu <code>Foldable</code>( vÃ­ dá»¥ má»™t danh sÃ¡ch), vÃ  sáº½ trá»Ÿ thÃ nh sá»± tháº­t náº¿u vá»‹ lÃ  Ä‘Ãºng Ä‘á»‘i vá»›i báº¥t ká»³ Ä‘áº§u vÃ o.</p><p>á» Ä‘Ã¢y, chÃºng tÃ´i sá»­ dá»¥ng anyhÃ m Ä‘á»ƒ xem liá»‡u cÃ³ báº¥t ká»³ <code>txInInfoOutRefs</code> nÃ o trong <code>txInfoInputs</code> tá»« <code>TxInfo</code> trÆ°á»ng cá»§a ngá»¯ cáº£nh khá»›p vá»›i UTxO mÃ  chÃºng tÃ´i Ä‘ang xÃ¡c thá»±c hay khÃ´ng.</p><p>Äá»ƒ rÃµ rÃ ng, chÃºng tÃ´i cÅ©ng sáº½ cung cáº¥p má»™t chá»©c nÄƒng trá»£ giÃºp Ä‘á»ƒ láº¥y danh sÃ¡ch <code>txInfoInputs</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">info :: TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">info = scriptContextTxInfo ctx</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">hasUTxO :: Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">hasUTxO = any (\i -&gt; txInInfoOutRef i == oref) $ txInfoInputs info</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ¬ váº­y, chÃºng ta cÃ³ Ä‘á»§ Ä‘á»ƒ hoÃ n thÃ nh viá»‡c viáº¿t chÃ­nh sÃ¡ch cá»§a chÃºng tÃ´i? HÃ£y xem nhá»¯ng gÃ¬ chÃºng tÃ´i cÃ³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: TxOutRef -&gt; ScriptContext -&gt; Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy oref ctx = traceIfFalse &quot;UTxO not consumed&quot; hasUTxO</span></div><div class="token-line" style="color:#393A34"><span class="token plain">where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info :: TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info = scriptContextTxInfo ctx</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hasUTxO :: Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hasUTxO = any (\i -&gt; txInInfoOutRef i == oref) $ txInfoInputs info</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Hiá»‡n táº¡i, chÃºng tÃ´i cÃ³ chÃ­nh sÃ¡ch chá»‰ cÃ³ thá»ƒ Ä‘Ãºc hoáº·c Ä‘á»‘t má»™t láº§n. Tuy nhiÃªn, táº¥t nhiÃªn, trong má»™t giao dá»‹ch duy nháº¥t Ä‘Ã³, chÃºng ta váº«n cÃ³ thá»ƒ Ä‘Ãºc bao nhiÃªu mÃ£ thÃ´ng bÃ¡o tÃ¹y thÃ­ch.</p><p>BÃ¢y giá», chÃºng tÃ´i nghÄ© vá» nhá»¯ng gÃ¬ chÃºng tÃ´i thá»±c sá»± muá»‘n. CÃ³ thá»ƒ chÃºng tÃ´i muá»‘n má»™t chÃ­nh sÃ¡ch cho phÃ©p chÃºng tÃ´i Ä‘Ãºc chá»‰ má»™t mÃ£ thÃ´ng bÃ¡o cho biá»ƒu tÆ°á»£ng tiá»n tá»‡. Hoáº·c cÃ³ láº½, chÃºng tÃ´i muá»‘n cÃ³ thá»ƒ Ä‘Ãºc nhiá»u NFT cÃ¹ng má»™t lÃºc, má»—i NFT cÃ³ má»™t tÃªn mÃ£ thÃ´ng bÃ¡o khÃ¡c nhau.</p><p>Äiá»u Ä‘Ã³ tÃ¹y thuá»™c vÃ o chÃºng tÃ´i. NhÆ°ng, giáº£ sá»­ chÃºng ta Ä‘i vá»›i tÃ¹y chá»n Ä‘áº§u tiÃªn. ChÃºng tÃ´i chá»‰ muá»‘n Ä‘Ãºc má»™t mÃ£ thÃ´ng bÃ¡o.</p><p>VÃ¬ váº­y, sáº½ há»£p lÃ½ khi chuyá»ƒn tÃªn mÃ£ thÃ´ng bÃ¡o lÃ m tham sá»‘.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: TxOutRef -&gt; TokenName -&gt; ScriptContext -&gt; Bool</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  chÃºng tÃ´i cáº§n má»™t Ä‘iá»u kiá»‡n thá»© hai Ä‘á»ƒ kiá»ƒm tra xem chÃºng tÃ´i cÃ³ Ä‘Ãºc chá»‰ má»™t Ä‘á»“ng xu cá»¥ thá»ƒ nÃ y hay khÃ´ng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy oref tn ctx = traceIfFalse &quot;UTxO not consumed&quot;   hasUTxO           &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                       traceIfFalse &quot;wrong amount minted&quot; checkMintedAmount</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ , táº¥t nhiÃªn, chÃºng tÃ´i cáº§n pháº£i thá»±c hiá»‡n <code>checkMintedAmount</code>.</p><p>TrÆ°á»›c háº¿t, chÃºng ta cáº§n truy cáº­p vÃ o giÃ¡ trá»‹ giáº£ máº¡o. ChÃºng tÃ´i cÃ³ Ä‘Æ°á»£c Ä‘iá»u nÃ y tá»« cÃ¡c lÄ©nh vá»±c <code>txInfoForge</code> cá»§a <code>TxInfo</code>.</p><p>LÃ m cÃ¡ch nÃ o Ä‘á»ƒ chÃºng tÃ´i kiá»ƒm tra xem giÃ¡ trá»‹ giáº£ máº¡o nÃ y cÃ³ Ä‘Ãºng lÃ  1 mÃ£ thÃ´ng bÃ¡o cá»§a tÃªn mÃ  chÃºng tÃ´i yÃªu cáº§u hay khÃ´ng? CÃ³ má»™t sá»‘ cÃ¡ch tiáº¿p cáº­n, nhÆ°ng má»™t lÃ  sá»­ dá»¥ng hÃ m<code>flattenValue</code> mÃ  chÃºng tÃ´i sáº½ nhá»› láº¡i, tráº£ vá» danh sÃ¡ch bá»™ ba kÃ½ hiá»‡u tiá»n tá»‡, tÃªn mÃ£ thÃ´ng bÃ¡o vÃ  giÃ¡ trá»‹. Sau Ä‘Ã³, chÃºng tÃ´i cÃ³ thá»ƒ kiá»ƒm tra xem Ä‘áº§u ra cá»§a <code>flattenValue</code> cÃ³ chÃ­nh xÃ¡c má»™t bá»™ ba khá»›p vá»›i biá»ƒu tÆ°á»£ng, mÃ£ thÃ´ng bÃ¡o vÃ  giÃ¡ trá»‹ mÃ  chÃºng tÃ´i mong Ä‘á»£i hay khÃ´ng.</p><p>NÃ³ sáº½ trÃ´ng giá»‘ng nhÆ° tháº¿ nÃ y:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">flattenValue (txInfoForge info) == [(cs, tn, 1)]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>NhÆ°ng chÃºng tÃ´i váº«n cÃ²n má»™t váº¥n Ä‘á» cáº§n giáº£i quyáº¿t - chÃºng tÃ´i cáº§n biáº¿t kÃ½ hiá»‡u tiá»n tá»‡ lÃ  gÃ¬. Cho ráº±ng biá»ƒu tÆ°á»£ng tiá»n tá»‡ lÃ  má»™t hÃ m bÄƒm cá»§a chÃ­nh sÃ¡ch, cÃ³ váº» nhÆ° chÃºng ta Ä‘ang gáº·p váº¥n Ä‘á» vá» con gÃ  vÃ  quáº£ trá»©ng.</p><p>May máº¯n thay, cÃ³ má»™t chá»©c nÄƒng Ä‘Æ°á»£c gá»i lÃ  <code>ownCurrencySymbol</code> tá»“n táº¡i Ä‘á»ƒ giáº£i quyáº¿t chÃ­nh xÃ¡c váº¥n Ä‘á» nÃ y.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">flattenValue (txInfoForge info) == [(ownCurrencySymbol ctx, tn, 1)]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Khi nÃ³ xáº£y ra, Ä‘iá»u nÃ y sáº½ khÃ´ng biÃªn dá»‹ch, vÃ¬ Eq khÃ´ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh cho bá»™ ba trong Plutus Prelude. VÃ¬ váº­y, chÃºng ta cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y vá»›i má»™t cÃ¢u lá»‡nh trÆ°á»ng há»£p vÃ  má»™t sá»‘ Ä‘á»‘i sÃ¡nh máº«u.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">case flattenValue (txInfoForge info) of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        [(cs, tn&#x27;, amt)] -&gt; cs  == ownCurrencySymbol ctx &amp;&amp; tn&#x27; == tn &amp;&amp; amt == 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        _                -&gt; False</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng tÃ´i cÃ³ thá»ƒ hoÃ n thÃ nh chÃ­nh sÃ¡ch cá»§a mÃ¬nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy :: TxOutRef -&gt; TokenName -&gt; ScriptContext -&gt; Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mkPolicy oref tn ctx = traceIfFalse &quot;UTxO not consumed&quot;   hasUTxO           &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    traceIfFalse &quot;wrong amount minted&quot; checkMintedAmount</span></div><div class="token-line" style="color:#393A34"><span class="token plain">where</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info :: TxInfo</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info = scriptContextTxInfo ctx</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hasUTxO :: Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hasUTxO = any (\i -&gt; txInInfoOutRef i == oref) $ txInfoInputs info</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    checkMintedAmount :: Bool</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    checkMintedAmount = case flattenValue (txInfoForge info) of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        [(cs, tn&#x27;, amt)] -&gt; cs  == ownCurrencySymbol ctx &amp;&amp; tn&#x27; == tn &amp;&amp; amt == 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        _                -&gt; False</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  chÃºng tÃ´i sáº½ cáº­p nháº­t báº£ng náº¥u Äƒn cá»§a chÃºng tÃ´i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">policy :: TxOutRef -&gt; TokenName -&gt; Scripts.MonetaryPolicy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">policy oref tn = mkMonetaryPolicyScript $</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    $$(PlutusTx.compile [|| \oref&#x27; tn&#x27; -&gt; Scripts.wrapMonetaryPolicy $ mkPolicy oref&#x27; tn&#x27; ||])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    `PlutusTx.applyCode`</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    PlutusTx.liftCode oref</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    `PlutusTx.applyCode`</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    PlutusTx.liftCode tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol :: TxOutRef -&gt; TokenName -&gt; CurrencySymbol</span></div><div class="token-line" style="color:#393A34"><span class="token plain">curSymbol oref tn = scriptCurrencySymbol $ policy oref tn    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u Ä‘Ã³ hoÃ n thÃ nh pháº§n on-chain.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="off-chain-2"></a>Off-chain<a class="hash-link" href="#off-chain-2" title="Direct link to heading">#</a></h4><p>ChÃºng ta cáº§n suy nghÄ© vá» cÃ¡c yáº¿u tá»‘ Ä‘áº§u vÃ o mÃ  chÃºng ta cáº§n cho giao dá»‹ch nÃ y.</p><p>Äáº§u tiÃªn, chÃºng tÃ´i cáº§n má»™t UTxO vÃ  chÃºng tÃ´i cáº§n cung cáº¥p má»™t UTxO cá»§a riÃªng mÃ¬nh. Tuy nhiÃªn, chÃºng ta khÃ´ng cáº§n chuyá»ƒn nÃ³ vÃ o vÃ¬ chÃºng ta cÃ³ thá»ƒ tra cá»©u trá»±c tiáº¿p.</p><p>ChÃºng tÃ´i chá»‰ cáº§n cung cáº¥p tÃªn mÃ£ thÃ´ng bÃ¡o, vÃ¬ váº­y chÃºng tÃ´i khÃ´ng cáº§n loáº¡i dá»¯ liá»‡u Ä‘áº·c biá»‡t ná»¯a, vÃ¬ váº­y chÃºng tÃ´i cÃ³ thá»ƒ xÃ³a <code>MintParams</code> vÃ  chá»‰ sá»­ dá»¥ng <code>TokenName</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">type NFTSchema =</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    BlockchainActions</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        .\/ Endpoint &quot;mint&quot; TokenName</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá» chÃºng ta sáº½ viáº¿t hÃ m off-chain <code>mint</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mint :: TokenName -&gt; Contract w NFTSchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mint tn = do</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äiá»u Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  láº¥y danh sÃ¡ch cÃ¡c UTxO thuá»™c vá» chÃºng tÃ´i.</p><p>CÃ¡c mÃ´-Ä‘un <code>Plutus.Contract</code>  cho chÃºng ta hÃ m <code>utxoAt</code>, trong Ä‘Ã³ cÃ³ chá»¯ kÃ½ dÆ°á»›i Ä‘Ã¢y, vÃ  nhÃ¬n lÃªn táº¥t cáº£ cÃ¡c UTxOs táº¡i má»™t Ä‘á»‹a chá»‰ nháº¥t Ä‘á»‹nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">utxoAt :: Address -&gt; Contract w s e Ledger.AddressMap.UtxoMap</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>má»™t <code>AddressMap</code> lÃ  map trong Ä‘Ã³  keys lÃ  <code>TxOutRef</code>s giÃ¡ trá»‹ lÃ  <code>TxOutTx</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.NFT&gt; :i Ledger.AddressMap.UtxoMap</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Ledger.AddressMap.UtxoMap :: `</span></div><div class="token-line" style="color:#393A34"><span class="token plain">type Ledger.AddressMap.UtxoMap = Data.Map.Internal.Map TxOutRef TxOutTx</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Náº¿u chÃºng tÃ´i chuyá»ƒn chá»©c nÄƒng nÃ y Ä‘áº¿n Ä‘á»‹a chá»‰ cá»§a chÃ­nh chÃºng tÃ´i thÃ¬ cÃ¡c khÃ³a cá»§a báº£n Ä‘á»“ nÃ y sáº½ lÃ  cÃ¡c UTxO thuá»™c vá» chÃºng tÃ´i. ChÃºng tÃ´i chá»n cÃ¡i nÃ o trong sá»‘ nÃ y khÃ´ng quan trá»ng. VÃ¬ váº­y, miá»…n lÃ  chÃºng ta sá»Ÿ há»¯u Ã­t nháº¥t má»™t UTxO, chÃºng ta Ä‘Ã£ tá»‘t.</p><p>BÆ°á»›c Ä‘áº§u tiÃªn lÃ  tÃ¬m Ä‘á»‹a chá»‰ cá»§a chÃ­nh chÃºng tÃ´i. ChÃºng tÃ´i biáº¿t cÃ¡ch tÃ¬m khÃ³a cÃ´ng khai cá»§a riÃªng mÃ¬nh vÃ , vá»›i Ä‘iá»u nÃ y, chÃºng tÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng nÃ y <code>pubKeyAddress</code> Ä‘á»ƒ láº¥y Ä‘á»‹a chá»‰ cá»§a mÃ¬nh.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pubKeyAddress :: PubKey -&gt; address</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y láº¥y chÃºng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import qualified Data.Map as Map</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mint :: TokenName -&gt; Contract w NFTSchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mint tn = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    pk    &lt;- Contract.ownPubKey</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    utxos &lt;- utxoAt (pubKeyAddress pk)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng tÃ´i chá»‰ cáº§n má»™t cÃ¡i - chÃºng tÃ´i khÃ´ng quan tÃ¢m cÃ¡i nÃ o. ChÃºng tÃ´i sáº½ viáº¿t má»™t cÃ¢u lá»‡nh trÆ°á»ng há»£p sáº½ ghi láº¡i lá»—i náº¿u chÃºng tÃ´i khÃ´ng cÃ³ UTxO cÃ³ sáºµn hoáº·c sáº½ sá»­ dá»¥ng UTxO Ä‘áº§u tiÃªn trong danh sÃ¡ch tiáº¿p tá»¥c vá»›i mÃ£ giáº£ máº¡o.</p><p>Thay Ä‘á»•i Ä‘áº§u tiÃªn lÃ  chá»‰ Ä‘á»‹nh 1thay vÃ¬ chá»‰ Ä‘á»‹nh <code>mpAmount</code>, vÃ¬ chÃºng tÃ´i muá»‘n cÃ³ chÃ­nh xÃ¡c 1 Ä‘á»“ng xu Ä‘Æ°á»£c Ä‘Ãºc.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">case Map.keys utxos of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    []       -&gt; Contract.logError @String &quot;no utxo found&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    oref : _ -&gt; do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        let val     = Value.singleton (curSymbol oref tn) tn 1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Thá»© hai, chÃºng tÃ´i thÃªm Ä‘á»‘i sá»‘ tÃªn mÃ£ thÃ´ng bÃ¡o vÃ o cÃ¡c tra cá»©u.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">lookups = Constraints.monetaryPolicy $ policy oref tn</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Thá»© ba, bÃ¢y giá» chÃºng tÃ´i cáº§n má»™t rÃ ng buá»™c bá»• sung Ä‘á»ƒ kháº³ng Ä‘á»‹nh ráº±ng UTxO cá»¥ thá»ƒ cá»§a chÃºng tÃ´i Ä‘Ã£ Ä‘Æ°á»£c tiÃªu thá»¥.</p><p>CÃ³ má»™t chá»©c nÄƒng cho Ä‘iá»u Ä‘Ã³.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.NFT&gt; import Ledger.Constraints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.NFT&gt; :t mustSpendPubKeyOutput</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mustSpendPubKeyOutput :: TxOutRef -&gt; TxConstraints i o</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>LÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta káº¿t há»£p cÃ¡c rÃ ng buá»™c cá»§a <code>mustForgeValue</code> vÃ  <code>mustSpendPubKeyOutput</code>? <code>Contraints</code>khÃ´ng táº¡o thÃ nh a <code>Monoid</code>, nhÆ°ng chÃºng cÃ³ táº¡o thÃ nh a Semigroup, vÃ  sá»± khÃ¡c biá»‡t chá»‰ lÃ  á»Ÿ chá»— <code>Semigroup</code> chÃºng ta khÃ´ng cÃ³ <code>mempty</code>, pháº§n tá»­ trung tÃ­nh. ChÃºng tÃ´i váº«n cÃ³ thá»ƒ káº¿t há»£p chÃºng vá»›i toÃ¡n tá»­ <code>&lt;&gt;</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">tx = Constraints.mustForgeValue val &lt;&gt; Constraints.mustSpendPubKeyOutput oref</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>BÃ¢y giá», chÃºng tÃ´i cáº§n cung cáº¥p má»™t báº£n tra cá»©u cho phÃ©p truy cáº­p vÃ o nÆ¡i <code>oref</code> cÃ³ thá»ƒ tÃ¬m tháº¥y UTxO . VÃ¬ váº­y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Ledger.Constraints.unspentOutputs :: Data.Map.Internal.Map TxOutRef TxOutTx -&gt; ScriptLookups a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ¬ váº­y, hÃ£y cáº­p nháº­t tra cá»©u cá»§a chÃºng tÃ´i.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">lookups = Constraints.monetaryPolicy (policy oref tn) &lt;&gt; Constraints.unspentOutputs utxos</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Má»™t cÃ¡i gÃ¬ Ä‘Ã³ chÃºng ta cáº§n pháº£i lÃ m trÆ°á»›c khi ká»‹ch báº£n nÃ y sáº½ cháº¡y lÃ  pháº£i nháº­p kháº©u cÃ¡c nhÃ  Ä‘iá»u hÃ nh <code>&lt;&gt;</code> cho Semigrouptá»« Haskell Prelude tiÃªu chuáº©n, nhÆ° chÃºng ta Ä‘Ã£ loáº¡i trá»« má»™t cÃ¡ch rÃµ rÃ ng tá»« cÃ¡c mudule <code>PlutusTx.Prelude</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import Prelude (Semigroup (..))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ChÃºng ta hÃ£y nhÃ¬n vÃ o toÃ n bá»™ chá»©c nÄƒng.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">mint :: TokenName -&gt; Contract w NFTSchema Text ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">mint tn = do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    pk    &lt;- Contract.ownPubKey</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    utxos &lt;- utxoAt (pubKeyAddress pk)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    case Map.keys utxos of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        []       -&gt; Contract.logError @String &quot;no utxo found&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        oref : _ -&gt; do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            let val     = Value.singleton (curSymbol oref tn) tn 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                lookups = Constraints.monetaryPolicy (policy oref tn) &lt;&gt; Constraints.unspentOutputs utxos</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                tx      = Constraints.mustForgeValue val &lt;&gt; Constraints.mustSpendPubKeyOutput oref</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            ledgerTx &lt;- submitTxConstraintsWith @Void lookups tx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            void $ awaitTxConfirmed $ txId ledgerTx</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Contract.logInfo @String $ printf &quot;forged %s&quot; (show val)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Äá»‘i vá»›i ká»‹ch báº£n thá»­ nghiá»‡m.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">test :: IO ()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test = runEmulatorTraceIO $ do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    let tn = &quot;ABC&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    h1 &lt;- activateContractWallet (Wallet 1) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    h2 &lt;- activateContractWallet (Wallet 2) endpoints</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    callEndpoint @&quot;mint&quot; h1 tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    callEndpoint @&quot;mint&quot; h2 tn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void $ Emulator.waitNSlots 1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>HÃ£y thá»­ nghiá»‡m.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI {.haskell}"><div tabindex="0" class="prism-code language-{.haskell} codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Prelude Week05.Signed Ledger Plutus.Contract Ledger.Constraints Week05.Free&gt; Week05.NFT.test</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00000: SlotAdd Slot 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Contract instance started</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W1: TxSubmit: 691a5c0725ac09f79c8c45c899d732d26460d18c4c18167be71d55319bcd5669</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Receive endpoint call: Object (fromList [(&quot;tag&quot;,String &quot;mint&quot;),(&quot;value&quot;,Object (fromList [(&quot;unEndpointValue&quot;,Object (fromList [(&quot;unTokenName&quot;,String &quot;ABC&quot;)]))]))])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: W2: TxSubmit: e53519b17bf7d11a148ce17ac0305330f138a684530ba08b1c57f714672b8c68</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate e53519b17bf7d11a148ce17ac0305330f138a684530ba08b1c57f714672b8c68</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: TxnValidate 691a5c0725ac09f79c8c45c899d732d26460d18c4c18167be71d55319bcd5669</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00001: SlotAdd Slot 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(9d969e597d45fcd1732ce255e12a97599e883f924b4565fc3a2407bc08d34524,Map [(\&quot;ABC\&quot;,1)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: ``` CONTRACT LOG: &quot;forged Value (Map [(913f220c3b1ba49531bae2fedd9edb138a8b360e7e605bfcf4ff3f2045433069,Map [(\&quot;ABC\&quot;,1)])])&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Slot 00002: SlotAdd Slot 3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Final balances</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 1: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {9d969e597d45fcd1732ce255e12a97599e883f924b4565fc3a2407bc08d34524, &quot;ABC&quot;}: 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 2: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {913f220c3b1ba49531bae2fedd9edb138a8b360e7e605bfcf4ff3f2045433069, &quot;ABC&quot;}: 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 99999990</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Wallet 10: </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {, &quot;&quot;}: 100000000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>VÃ  bÃ¢y giá» chÃºng tÃ´i Ä‘Ã£ Ä‘Ãºc má»™t sá»‘ NFT.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/cardano2vn/cardanovn-portal/edit/main/docs/dr-lars-lession/week5.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/dr-lars-lession/week4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Week 04 - Monads</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/dr-lars-lession/week6"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Week 06 - Oracles Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tá»•ng-quat" class="table-of-contents__link">Tá»•ng quat</a></li><li><a href="#value" class="table-of-contents__link">Value</a><ul><li><a href="#kiá»ƒu-value" class="table-of-contents__link">Kiá»ƒu Value</a></li></ul></li><li><a href="#chÃ­nh-sÃ¡ch-Ä‘Ãºc-tiá»n" class="table-of-contents__link">ChÃ­nh sÃ¡ch Ä‘Ãºc tiá»n</a></li><li><a href="#vÃ­-dá»¥-1---free" class="table-of-contents__link">VÃ­ dá»¥ 1 - Free</a><ul><li><a href="#on-chain" class="table-of-contents__link">On chain</a></li><li><a href="#off-chain" class="table-of-contents__link">Off chain</a></li><li><a href="#trong-playground" class="table-of-contents__link">Trong Playground</a></li><li><a href="#thá»­-nghiá»‡m-vá»›i-emulatortrace" class="table-of-contents__link">Thá»­ nghiá»‡m vá»›i EmulatorTrace</a></li></ul></li><li><a href="#vÃ­-dá»¥-2---signed" class="table-of-contents__link">VÃ­ dá»¥ 2 - Signed</a><ul><li><a href="#on-chain-1" class="table-of-contents__link">On-chain</a></li><li><a href="#off-chain-1" class="table-of-contents__link">Off-chain</a></li></ul></li><li><a href="#nft---non-fungible-tokens" class="table-of-contents__link">NFT - Non-Fungible Tokens</a><ul><li><a href="#vÃ­-dá»¥-3---nft" class="table-of-contents__link">VÃ­ dá»¥ 3 - NFT</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">TÃ i liá»‡u</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/overview">Báº¯t Ä‘áº§u</a></li></ul></div><div class="col footer__col"><div class="footer__title">Cá»™ng Ä‘á»“ng</div><ul class="footer__items"><li class="footer__item"><a href="https://t.me/cardano2vn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCJTdAQPGJntJet5v-nk9ebA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/cardano2vn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/about-us">About Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">The content of this site is referenced and copied from the <a href="https://developers.cardano.org/" target="_blank" rel="noopener noreferrer">Cardano Developer</a>, 2022</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1a53d0b2.js"></script>
<script src="/assets/js/main.bea7ec5b.js"></script>
</body>
</html>