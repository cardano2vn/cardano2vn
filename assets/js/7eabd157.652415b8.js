"use strict";(self.webpackChunkbringscdocs=self.webpackChunkbringscdocs||[]).push([[3560],{3905:function(n,t,e){e.d(t,{Zo:function(){return p},kt:function(){return s}});var a=e(7294);function i(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function l(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,a)}return e}function c(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?l(Object(e),!0).forEach((function(t){i(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function h(n,t){if(null==n)return{};var e,a,i=function(n,t){if(null==n)return{};var e,a,i={},l=Object.keys(n);for(a=0;a<l.length;a++)e=l[a],t.indexOf(e)>=0||(i[e]=n[e]);return i}(n,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);for(a=0;a<l.length;a++)e=l[a],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(i[e]=n[e])}return i}var r=a.createContext({}),u=function(n){var t=a.useContext(r),e=t;return n&&(e="function"==typeof n?n(t):c(c({},t),n)),e},p=function(n){var t=u(n.components);return a.createElement(r.Provider,{value:t},n.children)},g={inlineCode:"code",wrapper:function(n){var t=n.children;return a.createElement(a.Fragment,{},t)}},o=a.forwardRef((function(n,t){var e=n.components,i=n.mdxType,l=n.originalType,r=n.parentName,p=h(n,["components","mdxType","originalType","parentName"]),o=u(e),s=i,d=o["".concat(r,".").concat(s)]||o[s]||g[s]||l;return e?a.createElement(d,c(c({ref:t},p),{},{components:e})):a.createElement(d,c({ref:t},p))}));function s(n,t){var e=arguments,i=t&&t.mdxType;if("string"==typeof n||i){var l=e.length,c=new Array(l);c[0]=o;var h={};for(var r in t)hasOwnProperty.call(t,r)&&(h[r]=t[r]);h.originalType=n,h.mdxType="string"==typeof n?n:i,c[1]=h;for(var u=2;u<l;u++)c[u]=e[u];return a.createElement.apply(null,c)}return a.createElement.apply(null,e)}o.displayName="MDXCreateElement"},1170:function(n,t,e){e.r(t),e.d(t,{frontMatter:function(){return h},metadata:function(){return r},toc:function(){return u},default:function(){return g}});var a=e(7462),i=e(3366),l=(e(7294),e(3905)),c=["components"],h={},r={unversionedId:"dr-lars-lession/week2",id:"dr-lars-lession/week2",isDocsHomePage:!1,title:"Week 02 - Validation",description:"\u0110\xe2y l\xe0 t\xe0i li\u1ec7u B\xe0i gi\u1ea3ng \\#2, Dr. Lars.",source:"@site/docs/dr-lars-lession/week2.md",sourceDirName:"dr-lars-lession",slug:"/dr-lars-lession/week2",permalink:"/docs/dr-lars-lession/week2",editUrl:"https://github.com/cardano2vn/cardanovn-portal/edit/main/docs/dr-lars-lession/week2.md",version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Week 01 - English Auction",permalink:"/docs/dr-lars-lession/week1"},next:{title:"Week 03 - Script Context",permalink:"/docs/dr-lars-lession/week3"}},u=[{value:"Tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u",id:"tr\u01b0\u1edbc-khi-b\u1eaft-\u0111\u1ea7u",children:[]},{value:"Gi\u1edbi thi\u1ec7u",id:"gi\u1edbi-thi\u1ec7u",children:[]},{value:"PlutusTx.Data",id:"plutustxdata",children:[]},{value:"Plutus Validator",id:"plutus-validator",children:[{value:"V\xed d\u1ee5 1 - H\u1ee3p \u0111\u1ed3ng Gift",id:"v\xed-d\u1ee5-1---h\u1ee3p-\u0111\u1ed3ng-gift",children:[]},{value:"V\xed d\u1ee5 2 - Burn",id:"v\xed-d\u1ee5-2---burn",children:[]},{value:"V\xed d\u1ee5 4 - Typed",id:"v\xed-d\u1ee5-4---typed",children:[]}]}],p={toc:u};function g(n){var t=n.components,h=(0,i.Z)(n,c);return(0,l.kt)("wrapper",(0,a.Z)({},p,h,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"\u0110\xe2y l\xe0 t\xe0i li\u1ec7u ",(0,l.kt)("a",{parentName:"p",href:"https://youtu.be/7nDGZkUIeUQ"},"B\xe0i gi\u1ea3ng ","#","2, Dr. Lars"),"."),(0,l.kt)("p",null,"N\xf3 bao g\u1ed3m m\u1ee9c th\u1ea5p v\xe0 m\u1ee9c cao t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c on-chain."),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"M\xe3 trong b\xe0i gi\u1ea3ng n\xe0y s\u1eed d\u1ee5ng cam k\u1ebft Plutus\n81ba78edb1d634a13371397d8c8b19829345ce0d\n:::")),(0,l.kt)("h2",{id:"tr\u01b0\u1edbc-khi-b\u1eaft-\u0111\u1ea7u"},"Tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u"),(0,l.kt)("p",null,"H\xe3y n\xf3i v\u1ec1 m\u1ed9t \u0111i\u1ec3m quan tr\u1ecdng \u0111\u01b0\u1ee3c \u0111\u01b0a ra b\u1edfi m\u1ed9t trong nh\u1eefng ng\u01b0\u1eddi\nti\xean phong sau b\xe0i gi\u1ea3ng s\u1ed1 1."),(0,l.kt)("p",null,"B\u1ea1n s\u1ebd g\u1ecdi l\u1ea1i trong v\xed d\u1ee5 \u0111\u1ea5u gi\xe1, ch\xfang t\xf4i t\u1ea1o ra ba endpoints -\n",(0,l.kt)("inlineCode",{parentName:"p"},"start"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"bid")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"close"),". ",(0,l.kt)("inlineCode",{parentName:"p"},"close")," c\xf3 hai k\u1ecbch b\u1ea3n. N\u1ebfu c\xf3 gi\xe1 th\u1ea7u \u0111\u1ee7\ncao, m\xe3 th\xf4ng b\xe1o s\u1ebd \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ebfn ng\u01b0\u1eddi \u0111\u1eb7t gi\xe1 th\u1ea7u cao nh\u1ea5t. N\u1ebfu\nkh\xf4ng c\xf3 gi\xe1 th\u1ea7u \u0111\u1ee7 cao, m\xe3 th\xf4ng b\xe1o s\u1ebd quay tr\u1edf l\u1ea1i ng\u01b0\u1eddi b\xe1n."),(0,l.kt)("p",null,"\u0110i\u1ec1u g\xec s\u1ebd x\u1ea3y ra n\u1ebfu ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoint close")," kh\xf4ng c\xf3 \u1edf \u0111\xf3? Ti\u1ec1n c\xf3 th\u1ec3 b\u1ecb\nkh\xf3a m\xe3i m\xe3i trong h\u1ee3p \u0111\u1ed3ng kh\xf4ng?"),(0,l.kt)("p",null,"\u0110\xe2y l\xe0 m\u1ed9t \u0111i\u1ec3m th\u1ef1c s\u1ef1 quan tr\u1ecdng, b\u1edfi v\xec nh\u1eefng g\xec b\u1ea1n ph\u1ea3i nh\u1eadn ra l\xe0\nUTxO tr\xean blockchain ch\u1ec9 l\xe0 d\u1eef li\u1ec7u, ch\xfang ho\xe0n to\xe0n th\u1ee5 \u0111\u1ed9ng. \u0110\u1ec3 b\u1ea5t c\u1ee9\n\u0111i\u1ec1u g\xec x\u1ea3y ra ph\u1ea3i c\xf3 m\u1ed9t giao d\u1ecbch. \u0110\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c ti\u1ebfn b\u1ed9 v\xe0 thay \u0111\u1ed5i\ntr\u1ea1ng th\xe1i c\u1ee7a blockchain, ph\u1ea3i c\xf3 m\u1ed9t giao d\u1ecbch m\u1edbi \u0111\u01b0\u1ee3c g\u1eedi s\u1eed d\u1ee5ng\nc\xe1c UTxO kh\xe1c nhau v\xe0 t\u1ea1o ra c\xe1c UTxO m\u1edbi."),(0,l.kt)("p",null,"Ch\u1ec9 c\xf3 c\xe1c giao d\u1ecbch m\u1edbi thay \u0111\u1ed5i tr\u1ea1ng th\xe1i. UTxO s\u1ebd kh\xf4ng bao gi\u1edd t\u1ef1\nho\u1ea1t \u0111\u1ed9ng v\xe0 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u g\xec \u0111\xf3. B\u1ea1n kh\xf4ng th\u1ec3 c\xf3 m\u1ed9t h\u1ee3p \u0111\u1ed3ng th\xf4ng\nminh n\u1eb1m tr\xean blockchain v\xe0 v\xe0o m\u1ed9t th\u1eddi \u0111i\u1ec3m n\xe0o \u0111\xf3, \u0111\u1ed9t nhi\xean th\u1ef1c\nhi\u1ec7n m\u1ed9t h\xe0nh \u0111\u1ed9ng."),(0,l.kt)("p",null,"V\xec v\u1eady, ch\xfang t\xf4i th\u1ef1c s\u1ef1 c\u1ea7n ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoint close")," n\u1ebfu ch\xfang t\xf4i mu\u1ed1n cu\u1ed9c\n\u0111\u1ea5u gi\xe1 \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\xfang t\xf4i, \u0111i\u1ec3m cu\u1ed1i \u0111\u01b0\u1ee3c\nk\xedch ho\u1ea1t theo c\xe1ch th\u1ee7 c\xf4ng. B\u1ea1n c\xf3 th\u1ec3 vi\u1ebft m\u1ed9t h\u1ee3p \u0111\u1ed3ng ch\u1ea1y trong v\xed\ns\u1ebd t\u1ef1 \u0111\u1ed9ng t\u1ea1o closegiao d\u1ecbch - c\xf3 th\u1ec3 vi\u1ebft m\xe3 ngo\xe0i chu\u1ed7i kh\xe1 ph\u1ee9c t\u1ea1p."),(0,l.kt)("p",null,"Tuy nhi\xean, theo quan \u0111i\u1ec3m c\u1ee7a blockchain, n\xf3 lu\xf4n l\xe0 m\u1ed9t y\u1ebfu t\u1ed1 k\xedch\nho\u1ea1t b\xean ngo\xe0i th\u1ef1c hi\u1ec7n \u0111i\u1ec1u g\xec \u0111\xf3. Kh\xf4ng c\xf3 g\xec x\u1ea3y ra n\u1ebfu n\xf3 kh\xf4ng\n\u0111\u01b0\u1ee3c k\xedch ho\u1ea1t t\u1eeb b\xean ngo\xe0i."),(0,l.kt)("p",null,"V\xec v\u1eady, n\u1ebfu kh\xf4ng c\xf3 ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoint close")," , ho\u1eb7c ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoint close")," kh\xf4ng bao\ngi\u1edd \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t, th\xec ti\u1ec1n s\u1ebd v\u1eabn n\u1eb1m \u1edf \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh m\xe3i m\xe3i."),(0,l.kt)("h2",{id:"gi\u1edbi-thi\u1ec7u"},"Gi\u1edbi thi\u1ec7u"),(0,l.kt)("p",null,"Trong b\xe0i gi\u1ea3ng \u0111\u1ea7u ti\xean, ch\xfang ta \u0111\xe3 th\u1ea5y r\u1eb1ng h\u1ee3p \u0111\u1ed3ng th\xf4ng minh c\xf3\nhai m\u1eb7t - m\u1ed9t ph\u1ea7n trong chu\u1ed7i v\xe0 m\u1ed9t ph\u1ea7n ngo\xe0i chu\u1ed7i."),(0,l.kt)("p",null,"Ph\u1ea7n on-chain l\xe0 v\u1ec1 x\xe1c nh\u1eadn. N\xf3 cho ph\xe9p c\xe1c n\xfat x\xe1c th\u1ef1c m\u1ed9t giao d\u1ecbch\nnh\u1ea5t \u0111\u1ecbnh v\xe0 li\u1ec7u n\xf3 c\xf3 \u0111\u01b0\u1ee3c ph\xe9p s\u1eed d\u1ee5ng m\u1ed9t UTxO nh\u1ea5t \u0111\u1ecbnh hay kh\xf4ng."),(0,l.kt)("p",null,"Ph\u1ea7n off-chain n\u1eb1m trong v\xed c\u1ee7a ng\u01b0\u1eddi d\xf9ng. N\xf3 x\xe2y d\u1ef1ng v\xe0 g\u1eedi c\xe1c giao\nd\u1ecbch ph\xf9 h\u1ee3p."),(0,l.kt)("p",null,"C\u1ea3 hai \u0111\u1ec1u l\xe0 ch\u1ee7 \u0111\u1ec1 quan tr\u1ecdng. Ch\xfang t\xf4i ph\u1ea3i th\xe0nh th\u1ea1o c\u1ea3 hai \u0111\u1ec3\nvi\u1ebft h\u1ee3p \u0111\u1ed3ng th\xf4ng minh, nh\u01b0ng hi\u1ec7n t\u1ea1i ch\xfang t\xf4i s\u1ebd t\u1eadp trung v\xe0o ph\u1ea7n\non-chain."),(0,l.kt)("p",null,"H\xe3y nh\u1edb l\u1ea1i m\xf4 h\xecnh UTxO m\u1edf r\u1ed9ng m\xe0 \xfd t\u01b0\u1edfng l\xe0 ch\xfang t\xf4i gi\u1edbi thi\u1ec7u m\u1ed9t\nlo\u1ea1i \u0111\u1ecba ch\u1ec9 m\u1edbi."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3592).Z})),(0,l.kt)("p",null,"Trong m\xf4 h\xecnh UTxO \u0111\u01a1n gi\u1ea3n, c\xe1i g\u1ecdi l\xe0 \u0111\u1ecba ch\u1ec9 kh\xf3a c\xf4ng khai, trong \u0111\xf3\n\u0111\u1ecba ch\u1ec9 \u0111\u01b0\u1ee3c cung c\u1ea5p b\u1edfi h\xe0m b\u0103m c\u1ee7a kh\xf3a c\xf4ng khai. N\u1ebfu m\u1ed9t UTxO n\u1eb1m \u1edf\n\u0111\u1ecba ch\u1ec9 kh\xf3a c\xf4ng khai nh\u01b0 v\u1eady, th\xec m\u1ed9t giao d\u1ecbch c\xf3 th\u1ec3 s\u1eed d\u1ee5ng UTxO \u0111\xf3\nl\xe0m \u0111\u1ea7u v\xe0o n\u1ebfu ch\u1eef k\xfd thu\u1ed9c kh\xf3a c\xf4ng khai \u0111\xf3 \u0111\u01b0\u1ee3c bao g\u1ed3m trong giao\nd\u1ecbch."),(0,l.kt)("p",null,"Nh\u1eefng g\xec m\xf4 h\xecnh (E) UTxO l\xe0m l\xe0 m\u1edf r\u1ed9ng \u0111i\u1ec1u n\xe0y b\u1eb1ng c\xe1ch th\xeam c\xe1c \u0111\u1ecba\nch\u1ec9 t\u1eadp l\u1ec7nh c\xf3 th\u1ec3 ch\u1ea1y logic t\xf9y \xfd."),(0,l.kt)("p",null,"Khi m\u1ed9t giao d\u1ecbch mu\u1ed1n s\u1eed d\u1ee5ng UTxO \u1edf m\u1ed9t \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh \u0111\u01b0\u1ee3c x\xe1c th\u1ef1c\nb\u1edfi m\u1ed9t n\xfat, th\xec n\xfat \u0111\xf3 s\u1ebd ch\u1ea1y t\u1eadp l\u1ec7nh v\xe0 sau \u0111\xf3, t\xf9y thu\u1ed9c v\xe0o k\u1ebft\nqu\u1ea3 c\u1ee7a t\u1eadp l\u1ec7nh, quy\u1ebft \u0111\u1ecbnh xem giao d\u1ecbch c\xf3 h\u1ee3p l\u1ec7 hay kh\xf4ng."),(0,l.kt)("p",null,"V\xe0 nh\u1edb l\u1ea1i r\u1eb1ng hai l\xe0 ba b\u1ed5 sung n\u1eefa:"),(0,l.kt)("p",null,"Thay v\xec ch\u1ec9 c\xf3 ch\u1eef k\xfd tr\xean c\xe1c giao d\u1ecbch, ch\xfang t\xf4i c\xf3 c\xe1i g\u1ecdi l\xe0 Ng\u01b0\u1eddi\nnh\u1eadn th\u1eeba - c\xe1c ph\u1ea7n d\u1eef li\u1ec7u t\xf9y \xfd. \u1ede ph\xeda \u0111\u1ea7u ra UTxO, ch\xfang t\xf4i c\xf3 m\u1ed9t\nph\u1ea7n d\u1eef li\u1ec7u t\xf9y \xfd b\u1ed5 sung \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 Datum, b\u1ea1n c\xf3 th\u1ec3 coi \u0111\xe2y l\xe0 m\u1ed9t\nph\u1ea7n nh\u1ecf c\u1ee7a tr\u1ea1ng th\xe1i n\u1eb1m tr\xean UTxO. Cu\u1ed1i c\xf9ng, ch\xfang ta c\xf3 b\u1ed1i c\u1ea3nh.\nC\xf3 nhi\u1ec1u l\u1ef1a ch\u1ecdn kh\xe1c nhau v\u1ec1 b\u1ed1i c\u1ea3nh n\xe0y c\xf3 th\u1ec3 l\xe0 g\xec. N\xf3 c\xf3 th\u1ec3 r\u1ea5t\nh\u1ea1n ch\u1ebf, ch\u1ec9 bao g\u1ed3m Ch\xfaa c\u1ee9u th\u1ebf (nh\u01b0 trong Bitcoin) ho\u1eb7c r\u1ea5t to\xe0n c\u1ea7u,\nbao g\u1ed3m to\xe0n b\u1ed9 tr\u1ea1ng th\xe1i c\u1ee7a blockchain (nh\u01b0 trong Etheum). Trong\nCardano, \u0111\xf3 l\xe0 giao d\u1ecbch \u0111ang \u0111\u01b0\u1ee3c x\xe1c th\u1ef1c, bao g\u1ed3m t\u1ea5t c\u1ea3 c\xe1c \u0111\u1ea7u v\xe0o\nv\xe0 \u0111\u1ea7u ra c\u1ee7a n\xf3."),(0,l.kt)("p",null,"V\xec v\u1eady, c\xf3 ba ph\u1ea7n d\u1eef li\u1ec7u m\xe0 m\u1ed9t t\u1eadp l\u1ec7nh Plutus nh\u1eadn \u0111\u01b0\u1ee3c. Datum, \u0111\u1eb7t\nt\u1ea1i UTxO, ng\u01b0\u1eddi mua l\u1ea1i, \u0111\u1ebfn t\u1eeb \u0111\u1ea7u v\xe0o v\xe0 x\xe1c th\u1ef1c, v\xe0 ng\u1eef c\u1ea3nh, bao\ng\u1ed3m giao d\u1ecbch \u0111ang \u0111\u01b0\u1ee3c x\xe1c th\u1ef1c v\xe0 c\xe1c \u0111\u1ea7u v\xe0o v\xe0 \u0111\u1ea7u ra c\u1ee7a n\xf3."),(0,l.kt)("p",null,"Trong m\u1ed9t tri\u1ec3n khai c\u1ee5 th\u1ec3 nh\u01b0 Plutus, nh\u1eefng ph\u1ea7n th\xf4ng tin n\xe0y c\u1ea7n\n\u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u c\u1ee5 th\u1ec3 - ki\u1ec3u d\u1eef li\u1ec7u Haskell. Khi\nn\xf3 x\u1ea3y ra, l\u1ef1a ch\u1ecdn \u0111\xe3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u1ec3 s\u1eed d\u1ee5ng c\xf9ng m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u\ncho c\u1ea3 ba ng\u01b0\u1eddi trong s\u1ed1 h\u1ecd. \xcdt nh\u1ea5t l\xe0 \u1edf m\u1ee9c \u0111\u1ed9 th\u1ef1c hi\u1ec7n th\u1ea5p."),(0,l.kt)("p",null,"Ch\xfang ta s\u1ebd xem x\xe9t \u0111i\u1ec1u \u0111\xf3 \u0111\u1ea7u ti\xean, nh\u01b0ng trong cu\u1ed9c s\u1ed1ng th\u1ef1c kh\xf4ng\nai th\u1ef1c s\u1ef1 s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\xe1p ti\u1ebfp c\u1eadn c\u1ea5p th\u1ea5p n\xe0y. C\xf3 nhi\u1ec1u c\xe1ch\nthu\u1eadn ti\u1ec7n h\u01a1n \u0111\u1ec3 s\u1eed d\u1ee5ng c\xe1c ki\u1ec3u d\u1eef li\u1ec7u ph\xf9 h\u1ee3p h\u01a1n cho nh\u1eefng vi\u1ec7c\nn\xe0y, v\xe0 ch\xfang ta s\u1ebd \u0111\u1ec1 c\u1eadp \u0111\u1ebfn v\u1ea5n \u0111\u1ec1 \u0111\xf3 \u1edf ph\u1ea7n sau c\u1ee7a b\xe0i gi\u1ea3ng n\xe0y."),(0,l.kt)("h2",{id:"plutustxdata"},"PlutusTx.Data"),(0,l.kt)("p",null,"Nh\u01b0 \u0111\u1ec1 c\u1eadp, the datum, redeemer and context chia s\u1ebb m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u."),(0,l.kt)("p",null,"Ki\u1ec3u d\u1eef li\u1ec7u \u0111\xf3 \u0111\u01b0\u1ee3c \u0111\u1ed1ng g\xf3i trong ",(0,l.kt)("inlineCode",{parentName:"p"},"plutus-core"),", trong m\xf4-\u0111ul\n",(0,l.kt)("inlineCode",{parentName:"p"},"PlutusCore.Data"),"."),(0,l.kt)("p",null,"N\xf3 \u0111\u1ef1c g\u1ecdi \u0111\u01a1n gi\u1ea3n l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data Data =\n     Constr Integer [Data]\n   | Map [(Data, Data)]\n   | List [Data]\n   | I Integer\n   | B BS.ByteString\n   deriving stock (Show, Eq, Ord, Generic)\n   deriving anyclass (NFData)\n")),(0,l.kt)("p",null,"N\xf3 c\xf3 5 h\xe0m t\u1ea1o."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Constr")," l\u1ea5y m\u1ed9t S\u1ed1 nguy\xean v\xe0, m\u1ed9t c\xe1ch \u0111\u1ec7 quy, m\u1ed9t danh s\xe1ch ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Map")," l\u1ea5y m\u1ed9t danh s\xe1ch c\xe1c c\u1eb7p ",(0,l.kt)("em",{parentName:"li"},"Data"),". B\u1ea1n c\xf3 th\u1ec3 coi \u0111\xe2y l\xe0 m\u1ed9t\nb\u1ea3ng tra c\u1ee9u c\xe1c c\u1eb7p kh\xf3a-gi\xe1 tr\u1ecb trong \u0111\xf3 c\u1ea3 kh\xf3a v\xe0 gi\xe1 tr\u1ecb \u0111\u1ec1u\nthu\u1ed9c lo\u1ea1i ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"List")," l\u1ea5y m\u1ed9t danh s\xe1ch ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"I")," l\u1ea5y m\u1ed9t s\u1ed1 nguy\xean duy nh\u1ea5t"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"B")," l\u1ea5y m\u1ed9t chu\u1ed7i Byte")),(0,l.kt)("p",null,"\u0110\u1ed1i v\u1edbi nh\u1eefng ng\u01b0\u1eddi quen thu\u1ed9c v\u1edbi \u0111\u1ecbnh d\u1ea1ng JSON, \u0111i\u1ec1u n\xe0y r\u1ea5t gi\u1ed1ng.\nC\xe1c h\xe0m t\u1ea1o kh\xf4ng ho\xe0n to\xe0n gi\u1ed1ng nhau, nh\u01b0ng gi\u1ed1ng nh\u01b0 JSON, b\u1ea1n c\xf3 th\u1ec3\nbi\u1ec3u di\u1ec5n s\u1ed1, chu\u1ed7i, danh s\xe1ch d\u1eef li\u1ec7u v\xe0 c\xe1c c\u1eb7p kh\xf3a-gi\xe1 tr\u1ecb. N\xf3 c\xf3\nth\u1ec3 \u0111\u1ea1i di\u1ec7n cho d\u1eef li\u1ec7u t\xf9y \xfd, \u0111i\u1ec1u n\xe0y l\xe0m cho n\xf3 r\u1ea5t ph\xf9 h\u1ee3p v\u1edbi m\u1ee5c\n\u0111\xedch c\u1ee7a ch\xfang t\xf4i."),(0,l.kt)("p",null,"Ch\xfang ta c\u0169ng c\xf3 th\u1ec3 kh\xe1m ph\xe1 lo\u1ea1i n\xe0y trong REPL."),(0,l.kt)("p",null,"Ch\u1ea1y ph\u1ea7n sau t\u1eeb kho l\u01b0u tr\u1eef ch\u01b0\u01a1ng tr\xecnh ti\xean phong c\u1ee7a plutus. B\u1ea1n c\xf3\nth\u1ec3 c\u1ea7n kh\u1edfi \u0111\u1ed9ng nix-shell t\u1eeb kho l\u01b0u tr\u1eef Plutus tr\u01b0\u1edbc khi thay \u0111\u1ed5i v\xe0o\nth\u01b0 m\u1ee5c ",(0,l.kt)("inlineCode",{parentName:"p"},"week02"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"cd code/week02\ncabal repl\n")),(0,l.kt)("p",null,"T\u1eeb REPL, ch\xfang ta c\u1ea7n import ",(0,l.kt)("inlineCode",{parentName:"p"},"PlutusTx")," \u0111\u1ec3 ch\xfang c\xf3 quy\u1ec1n truy c\u1eadp\nv\xe0o",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," . ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong ",(0,l.kt)("inlineCode",{parentName:"p"},"PlutusTx"),", nh\u01b0ng n\xf3 \u0111\u01b0\u1ee3c\nt\xe1i xu\u1ea5t t\u1eeb \u0111\xf3."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"import PlutusTx\n")),(0,l.kt)("p",null,"ch\xfang ta c\xf3 th\u1ec3 th\u1ea5y th\xf4ng tin v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},":i Data\n")),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y chung ta c\xf3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 th\xf4ng tin v\u1ec1 ",(0,l.kt)("em",{parentName:"p"},"Data"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Burn> import PlutusTx\nPrelude PlutusTx Week02.Burn> :i Data\ntype Data :: *\ndata Data\n  = Constr Integer [Data]\n  | Map [(Data, Data)]\n  | List [Data]\n  | I Integer\n  | B bytestring-0.10.12.0:Data.ByteString.Internal.ByteString\n        -- Defined in \u2018plutus-core-0.1.0.0:PlutusCore.Data\u2019\ninstance Eq Data\n  -- Defined in \u2018plutus-core-0.1.0.0:PlutusCore.Data\u2019\ninstance Ord Data\n  -- Defined in \u2018plutus-core-0.1.0.0:PlutusCore.Data\u2019\ninstance Show Data\n  -- Defined in \u2018plutus-core-0.1.0.0:PlutusCore.Data\u2019\ninstance IsData Data -- Defined in \u2018PlutusTx.IsData.Class\u2019\n")),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta c\xf3 th\u1ec3 ch\u01a1i v\u1edbi n\xf3. Ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"I")," t\u1ea1o\n\u0111\u1ec3 t\u1ea1o m\u1ed9t gi\xe1 tr\u1ecb c\u1ee7a ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx.Data Week02.Burn> I 42\nI 42\n")),(0,l.kt)("p",null,"Ch\xfang ta c\xf3 th\u1ec3 h\u1ecfi lo\u1ea1i c\u1ee7a n\xf3 v\xe0 x\xe1c nh\u1eadn r\u1eb1ng n\xf3 th\u1ef1c s\u1ef1 thu\u1ed9c lo\u1ea1i\n",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx.Data Week02.Burn> :t I 42\nI 42 :: Data\n")),(0,l.kt)("p",null,"TC\xe1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 t\u1ea1o m\u1ed9t gi\xe1 tr\u1ecb ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"B"),"\nt\u1ea1o l\xe0 s\u1eed d\u1ee5ng Ph\u1ea7n m\u1edf r\u1ed9ng GHC ",(0,l.kt)("inlineCode",{parentName:"p"},"OverloadedStrings"),". \u0110i\u1ec1u n\xe0y cho ph\xe9p\nc\xe1c chu\u1ed7i k\xfd t\u1ef1 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng thay cho c\xe1c ki\u1ec3u d\u1eef li\u1ec7u gi\u1ed1ng chu\u1ed7i v\xe0\ntr\xecnh bi\xean d\u1ecbch s\u1ebd di\u1ec5n gi\u1ea3i ch\xfang nh\u01b0 ki\u1ec3u d\u1ef1 \u0111\u1ecbnh c\u1ee7a ch\xfang."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Prelude PlutusTx.Data Week02.Burn> :set -XOverloadedStrings\nPrelude PlutusTx.Data Week02.Burn> :t B "Haskell"\nB "Haskell" :: Data\n')),(0,l.kt)("p",null,"Ch\xfang ta c\u0169ng c\xf3 th\u1ec3 s\u1eed d\u1ee5ng c\xe1c h\xe0m t\u1ea1o ph\u1ee9c t\u1ea1p h\u01a1n, nh\u01b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Map")," and\n",(0,l.kt)("inlineCode",{parentName:"p"},"List"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Prelude PlutusTx.Data Week02.Burn> :t Map [(I 42, B "Haskell"), (List [I 0], I 1000)]\nMap [(I 42, B "Haskell"), (List [I 0], I 1000)] :: Data\n')),(0,l.kt)("h2",{id:"plutus-validator"},"Plutus Validator"),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang t\xf4i \u0111\xe3 s\u1eb5n s\xe0ng tri\u1ec3n khai tr\xecnh x\xe1c th\u1ef1c \u0111\u1ea7u ti\xean c\u1ee7a\nm\xecnh.."),(0,l.kt)("h3",{id:"v\xed-d\u1ee5-1---h\u1ee3p-\u0111\u1ed3ng-gift"},"V\xed d\u1ee5 1 - H\u1ee3p \u0111\u1ed3ng Gift"),(0,l.kt)("h4",{id:"the-code"},"The Code"),(0,l.kt)("p",null,"Ch\xfang t\xf4i b\u1eaft \u0111\u1ea7u t\u1eadp l\u1ec7nh b\u1eb1ng c\xe1ch sao ch\xe9p, d\xe1n danh s\xe1ch c\xe1c ph\u1ea7n m\u1edf\nr\u1ed9ng ng\xf4n ng\u1eef GHC, c\u1ed9ng v\u1edbi m\u1ed9t s\u1ed1 ph\u1ea7n nh\u1eadp ph\u1ee5 thu\u1ed9c t\u1eeb v\xed d\u1ee5 m\xe0 ch\xfang\nt\xf4i \u0111\xe3 s\u1eed d\u1ee5ng trong b\xe0i gi\u1ea3ng tr\u01b0\u1edbc."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# LANGUAGE DataKinds           #-}\n{-# LANGUAGE FlexibleContexts    #-}\n...\n\nmodule Week02.Gift where\n\nimport           Control.Monad       hiding (fmap)\nimport           Data.Map            as Map\n...\nimport           Text.Printf         (printf)\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i vi\u1ebft tr\xecnh x\xe1c nh\u1eadn. Cu\u1ed1i c\xf9ng, tr\xecnh x\xe1c th\u1ef1c s\u1ebd l\xe0\nm\u1ed9t t\u1eadp l\u1ec7nh, s\u1ed1ng tr\xean blockchain trong Plutus Core, l\xe0 m\u1ed9t ng\xf4n ng\u1eef\nc\u1ea5p th\u1ea5p h\u01a1n d\u1ef1a tr\xean ph\xe9p t\xednh lambda. Nh\u01b0ng, ch\xfang ta kh\xf4ng c\u1ea7n ph\u1ea3i\nvi\u1ebft Plutus Core. Ch\xfang ta c\xf3 th\u1ec3 vi\u1ebft Haskell v\xe0 sau n\xe0y ch\xfang ta s\u1ebd\nxem c\xe1ch ch\xfang ta chuy\u1ec3n \u0111\u1ed5i Haskell \u0111\xf3 th\xe0nh t\u1eadp l\u1ec7nh Plutus Core."),(0,l.kt)("p",null,"V\xec v\u1eady, ch\xfang t\xf4i vi\u1ebft m\u1ed9t h\xe0m Haskell \u0111\u1ea1i di\u1ec7n cho tr\xecnh x\xe1c th\u1ef1c c\u1ee7a\nch\xfang t\xf4i. Nh\u01b0 ch\xfang ta \u0111\xe3 bi\u1ebft, tr\xecnh x\xe1c th\u1ef1c l\xe0 m\u1ed9t t\u1eadp l\u1ec7nh c\xf3 ba\nph\u1ea7n \u0111\u1ea7u v\xe0o - d\u1eef li\u1ec7u, tr\xecnh \u0111\u1ed5i v\xe0 ng\u1eef c\u1ea3nh, t\u01b0\u01a1ng \u1ee9ng, \u1edf c\u1ea5p th\u1ea5p\nnh\u1ea5t \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb b\u1eb1ng ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," ki\u1ec3u d\u1eef li\u1ec7u."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> ()\n")),(0,l.kt)("p",null,"H\u01a1i ng\u1ea1c nhi\xean, k\u1ebft qu\u1ea3 c\u1ee7a h\xe0m l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"()"),". Trong Haskell ",(0,l.kt)("inlineCode",{parentName:"p"},"Unit")," ki\u1ec3u,\nt\u01b0\u01a1ng t\u1ef1 nh\u01b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"void")," trong m\u1ed9t s\u1ed1 ng\xf4n ng\u1eef kh\xe1c, nh\u01b0 C ho\u1eb7c C ","#"," ho\u1eb7c\nJava - \u0111\xf3 l\xe0 ki\u1ec3u kh\xf4ng mang th\xf4ng tin."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Unit")," l\xe0 m\u1ed9t ki\u1ec3u t\xedch h\u1ee3p s\u1eb5n trong Haskell v\xe0 n\xf3 ch\u1ec9 c\xf3 m\u1ed9t gi\xe1 tr\u1ecb,\n\u0111\u01b0\u1ee3c vi\u1ebft theo c\xf9ng m\u1ed9t c\xe1ch v\u1edbi ch\xednh ki\u1ec3u \u0111\xf3, nh\u01b0 ch\xfang ta c\xf3 th\u1ec3 th\u1ea5y\nt\u1eeb REPL."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Gift> ()\n()\nPrelude Week02.Gift> :t ()\n() :: ()\n")),(0,l.kt)("p",null,"M\u1ed9t h\xe0m c\xf3 ki\u1ec3u tr\u1ea3 v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"()")," l\xe0 kh\xe1 b\u1ea5t th\u01b0\u1eddng trong Haskell. Trong c\xe1c\nng\xf4n ng\u1eef ch\xednh th\u1ed1ng h\u01a1n, vi\u1ec7c c\xe1c h\xe0m ho\u1eb7c th\u1ee7 t\u1ee5c kh\xf4ng tr\u1ea3 v\u1ec1 gi\xe1 tr\u1ecb\nl\xe0 \u0111i\u1ec1u kh\xe1 ph\u1ed5 bi\u1ebfn. Trong nh\u1eefng t\xecnh hu\u1ed1ng n\xe0y, c\xe1c h\xe0m ch\u1ec9 quan tr\u1ecdng\n\u0111\u1ed1i v\u1edbi c\xe1c t\xe1c d\u1ee5ng ph\u1ee5 c\u1ee7a ch\xfang, ch\u1eb3ng h\u1ea1n nh\u01b0 h\xe0m Java in n\u1ed9i dung\nn\xe0o \u0111\xf3 ra b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n."),(0,l.kt)("p",null,"Nh\u01b0ng Haskell l\xe0 m\u1ed9t ng\xf4n ng\u1eef thu\u1ea7n t\xfay. N\u1ebfu b\u1ea1n mu\u1ed1n c\xf3 t\xe1c d\u1ee5ng ph\u1ee5,\n\u0111i\u1ec1u n\xe0y s\u1ebd \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb b\u1edfi h\u1ec7 th\u1ed1ng lo\u1ea1i. V\xed d\u1ee5: n\u1ebfu mkValidator th\u1ef1c\nhi\u1ec7n b\u1ea5t k\u1ef3 IO n\xe0o, n\xf3 s\u1ebd c\xf3 ch\u1eef k\xfd ki\u1ec3u:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> IO ()\n")),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y s\u1ebd ch\u1ec9 ra m\u1ed9t h\xe0m th\u1ef1c hi\u1ec7n c\xe1c t\xe1c d\u1ee5ng ph\u1ee5 IO nh\u01b0ng kh\xf4ng c\xf3\ngi\xe1 tr\u1ecb tr\u1ea3 v\u1ec1 th\xfa v\u1ecb."),(0,l.kt)("p",null,"Nh\u01b0ng, nh\u01b0 ch\xfang ta bi\u1ebft r\u1eb1ng ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator")," h\xe0m th\u1ef1c kh\xf4ng th\u1ef1c hi\u1ec7n t\xe1c\nd\u1ee5ng ph\u1ee5 v\xe0 kh\xf4ng tr\u1ea3 v\u1ec1 gi\xe1 tr\u1ecb n\xe0o, th\u1ef1c s\u1ef1 kh\xf4ng c\xf3 g\xec h\u1eefu \xedch m\xe0 n\xf3\nc\xf3 th\u1ec3 l\xe0m \u0111\u01b0\u1ee3c."),(0,l.kt)("p",null,"Tuy nhi\xean, c\xf3 \u0111i\u1ec1u g\xec \u0111\xf3 m\xe0 h\xe0m c\xf3 th\u1ec3 l\xe0m c\u0169ng nh\u01b0 tr\u1ea3 v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"()"),", c\u1ee5 th\u1ec3\nl\xe0 n\xf3 c\xf3 th\u1ec3 n\xe9m ra m\u1ed9t ngo\u1ea1i l\u1ec7 ho\u1eb7c c\xf3 l\u1ed7i. V\xe0 \u0111\xf3 l\xe0 nh\u1eefng g\xec Plutus\ns\u1eed d\u1ee5ng."),(0,l.kt)("p",null,"\xdd t\u01b0\u1edfng l\xe0 n\u1ebfu ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidatorh\xe0m")," kh\xf4ng g\u1eb7p l\u1ed7i ho\u1eb7c \u0111\u01b0a ra m\u1ed9t ngo\u1ea1i l\u1ec7,\nth\xec qu\xe1 tr\xecnh x\xe1c nh\u1eadn s\u1ebd th\xe0nh c\xf4ng. N\u1ebfu n\xf3 xu\u1ea5t hi\u1ec7n m\u1ed9t l\u1ed7i th\xec vi\u1ec7c\nx\xe1c th\u1ef1c kh\xf4ng th\xe0nh c\xf4ng v\xe0 giao d\u1ecbch b\u1ecb t\u1eeb ch\u1ed1i."),(0,l.kt)("p",null,"H\xe3y vi\u1ebft tr\xecnh x\xe1c nh\u1eadn \u0111\u01a1n gi\u1ea3n nh\u1ea5t m\xe0 ch\xfang ta c\xf3 th\u1ec3."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> ()\nmkValidator _ _ _ = ()\n")),(0,l.kt)("p",null,"\u0110\u1ed1i s\u1ed1 \u0111\u1ea7u ti\xean l\xe0 d\u1eef li\u1ec7u, \u0111\u1ed1i s\u1ed1 th\u1ee9 hai l\xe0 tr\xecnh chu\u1ed9c v\xe0 \u0111\u1ed1i s\u1ed1 th\u1ee9\nba l\xe0 ng\u1eef c\u1ea3nh. \u0110i\u1ec1u \u0111\u01a1n gi\u1ea3n nh\u1ea5t m\xe0 ch\xfang ta c\xf3 th\u1ec3 l\xe0m l\xe0 ho\xe0n to\xe0n\nb\u1ecf qua c\u1ea3 ba \u0111\u1ed1i s\u1ed1 v\xe0 quay tr\u1edf l\u1ea1i ngay l\u1eadp t\u1ee9c ",(0,l.kt)("inlineCode",{parentName:"p"},"()"),"."),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi tr\xecnh x\xe1c th\u1ef1c n\xe0y\nkh\xf4ng quan t\xe2m \u0111\u1ebfn d\u1eef li\u1ec7u, n\xf3 kh\xf4ng quan t\xe2m \u0111\u1ebfn tr\xecnh \u0111\u1ed5i v\xe0 kh\xf4ng\nquan t\xe2m \u0111\u1ebfn ng\u1eef c\u1ea3nh. N\xf3 s\u1ebd lu\xf4n th\xe0nh c\xf4ng v\xe0 \u0111i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 b\u1ea5t\nk\u1ef3 giao d\u1ecbch n\xe0o c\u0169ng c\xf3 th\u1ec3 s\u1eed d\u1ee5ng t\u1eadp l\u1ec7nh t\u1ea1i \u0111\u1ecba ch\u1ec9 n\xe0y l\xe0m \u0111\u1ea7u\nv\xe0o. Kh\xf4ng quan tr\u1ecdng d\u1eef li\u1ec7u n\xe0o t\u1ed3n t\u1ea1i cho UTxO t\u1ea1i \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh\nn\xe0y, kh\xf4ng quan tr\u1ecdng c\xf4ng c\u1ee5 \u0111\u1ed5i qu\xe0 n\xe0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho giao d\u1ecbch v\xe0\ngiao d\u1ecbch c\xf3 c\u1ea5u tr\xfac n\xe0o kh\xf4ng quan tr\u1ecdng."),(0,l.kt)("p",null,"N\u1ebfu b\u1ea1n g\u1eedi b\u1ea5t k\u1ef3 kho\u1ea3n ti\u1ec1n n\xe0o \u0111\u1ebfn \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh n\xe0y, b\u1ea5t k\u1ef3 ai\nc\u0169ng c\xf3 th\u1ec3 nh\u1eadn ngay."),(0,l.kt)("p",null,"H\xe0m n\xe0y ch\u01b0a ph\u1ea3i l\xe0 m\xe3 Plutus, n\xf3 ch\u1ec9 l\xe0 m\u1ed9t h\xe0m Haskell. \u0110\u1ec3 bi\u1ebfn n\xf3\nth\xe0nh m\u1ed9t t\u1eadp l\u1ec7nh Plutus, ch\xfang ta c\u1ea7n ph\u1ea3i bi\xean d\u1ecbch n\xf3."),(0,l.kt)("p",null,"K\u1ebft qu\u1ea3 c\u1ee7a qu\xe1 tr\xecnh bi\xean d\u1ecbch c\u1ee7a ch\xfang t\xf4i sang Plutus s\u1ebd thu\u1ed9c lo\u1ea1i\n",(0,l.kt)("inlineCode",{parentName:"p"},"Validator"),". B\xean d\u01b0\u1edbi h\xe0m trong ",(0,l.kt)("inlineCode",{parentName:"p"},"Gift.hs"),", ch\xfang t\xf4i th\xeam \u0111o\u1ea1n m\xe3 sau."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"validator :: Validator\nvalidator = mkValidatorScript $$(PlutusTx.compile [|| mkValidator ||])\n")),(0,l.kt)("p",null,"C\xe1c ch\u1ee9c n\u0103ng ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidatorScript")," mang ki\u1ec3u\n",(0,l.kt)("inlineCode",{parentName:"p"},"CompiledCode (Data -> Data -> Data -> ()) -> Validator"),". Nh\u1eb1m m\u1ee5c \u0111\xedch\nt\u1ea1o ki\u1ec3u n\xe0y v\xe0 bi\xean d\u1ecbch t\u1eadp l\u1ec7nh ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator")," b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng m\u1ed9t\nth\u1ee9 g\u1ecdi l\xe0 Template Haskell."),(0,l.kt)("p",null,"Template Haskell l\xe0 m\u1ed9t t\xednh n\u0103ng n\xe2ng cao c\u1ee7a Haskell gi\u1ea3i quy\u1ebft m\u1ed9t\nv\u1ea5n \u0111\u1ec1 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\xe1c h\u1ec7 th\u1ed1ng macro trong c\xe1c ng\xf4n ng\u1eef kh\xe1c. Macro l\xe0\nth\u1ee9 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng t\u1ea1i th\u1eddi \u0111i\u1ec3m bi\xean d\u1ecbch."),(0,l.kt)("p",null,"V\xec v\u1eady, v\u1edbi m\xe3 n\xe0y"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"$$(PlutusTx.compile [|| mkValidator ||])\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i \u0111ang y\xeau c\u1ea7u tr\xecnh bi\xean d\u1ecbch vi\u1ebft m\xe3 cho h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"validator")," t\u1ea1i\nth\u1eddi \u0111i\u1ec3m bi\xean d\u1ecbch d\u1ef1a tr\xean ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidatorh\xe0m")," c\u1ee7a ch\xfang ta , v\xe0 sau \u0111\xf3\nti\u1ebfn h\xe0nh bi\xean d\u1ecbch b\xecnh th\u01b0\u1eddng."),(0,l.kt)("p",null,"B\u1ea1n kh\xf4ng c\u1ea7n ph\u1ea3i hi\u1ec3u nhi\u1ec1u v\u1ec1 Template Haskell \u0111\u1ec3 vi\u1ebft Plutus v\xec n\xf3\nlu\xf4n lu\xf4n gi\u1ed1ng nhau. Khi b\u1ea1n \u0111\xe3 xem m\u1ed9t v\xe0i v\xed d\u1ee5, b\u1ea1n c\xf3 th\u1ec3 \xedt nhi\u1ec1u\nch\u1ec9 c\u1ea7n sao ch\xe9p v\xe0 d\xe1n."),(0,l.kt)("p",null,"M\u1eabu Haskell hy v\u1ecdng t\u1ea5t c\u1ea3 m\xe3 s\u1ebd c\xf3 s\u1eb5n trong Oxford Brackets - ",(0,l.kt)("inlineCode",{parentName:"p"},"[| |]"),"."),(0,l.kt)("p",null,"V\u1edbi c\xe1c tr\xecnh x\xe1c th\u1ef1c ph\u1ee9c t\u1ea1p h\u01a1n, b\u1ea1n c\xf3 th\u1ec3 s\u1ebd d\u1ef1a v\xe0o nhi\u1ec1u h\xe0m tr\u1ee3\ngi\xfap v\xe0 b\u1ea1n kh\xf4ng mu\u1ed1n ph\u1ea3i th\xeam ch\xfang v\xe0o trong D\u1ea5u ngo\u1eb7c \u0111\u01a1n Oxford.\n\u0110\u1ec3 tr\xe1nh \u0111i\u1ec1u n\xe0y, c\xf3 m\u1ed9t \u0111i\u1ec1u ch\xfang ta c\u1ea7n l\xe0m \u0111\u1ed1i v\u1edbi ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator"),"\nh\xe0m v\xe0 \u0111\xf3 l\xe0 l\xe0m cho n\xf3 c\xf3 th\u1ec3 nh\u1eadp \u0111\u01b0\u1ee3c b\u1eb1ng c\xe1ch th\xeam th\xf4ng s\u1ed1\n",(0,l.kt)("inlineCode",{parentName:"p"},"INLINABLE"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# INLINABLE mkValidator #-}\nmkValidator :: Data -> Data -> Data -> ()\nmkValidator _ _ _ = ()\n")),(0,l.kt)("p",null,"B\u1ea1n s\u1ebd th\u1ea5y \u0111i\u1ec1u n\xe0y th\u01b0\u1eddng xuy\xean trong c\xe1c t\u1eadp l\u1ec7nh Plutus v\xe0 n\xf3 th\u01b0\u1eddng\nl\xe0 m\u1ed9t d\u1ea5u hi\u1ec7u cho th\u1ea5y m\u1ed9t h\xe0m \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong m\u1ed9t t\u1eadp l\u1ec7nh x\xe1c\nth\u1ef1c. T\u1ea5t c\u1ea3 c\xe1c ch\u1ee9c n\u0103ng m\xe0 tr\xecnh x\xe1c nh\u1eadn ph\u1ee5 thu\u1ed9c ph\u1ea3i c\xf3 th\u1ec3 nh\u1eadp\n\u0111\u01b0\u1ee3c."),(0,l.kt)("p",null,"H\xe3y quay l\u1ea1i REPL v\xe0 xem x\xe9t tr\xecnh x\xe1c nh\u1eadn."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},":l src/Week02/Gift.hs\nOk, one module loaded.\nPrelude PlutusTx Week02.Gift> import Ledger.Scripts\nPrelude PlutusTx Ledger.Scripts Week02.Gift> validator\nValidator { <script> }\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i c\xf3 th\u1ec3 y\xeau c\u1ea7u th\xf4ng tin v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Validator"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx Ledger.Scripts Week02.Gift> :i Validator\ntype Validator :: *\nnewtype Validator = Validator {getValidator :: Script}\n        -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Eq Validator\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Ord Validator\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Show Validator\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\n")),(0,l.kt)("p",null,"Ch\xfang ta th\u1ea5y r\u1eb1ng n\xf3 l\xe0 m\u1ed9t l\u1edbp bao b\u1ecdc xung quanh ",(0,l.kt)("inlineCode",{parentName:"p"},"getValidator")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx Ledger.Scripts Week02.Gift> getValidator validator\n<Script>\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang ta c\xf3 th\u1ec3 l\u1ea5y m\u1ed9t s\u1ed1 th\xf4ng tin v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Script")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx Ledger.Scripts Week02.Gift> :i Script\ntype Script :: *\nnewtype Script\n  = Script {unScript :: plutus-core-0.1.0.0:UntypedPlutusCore.Core.Type.Program\n                          plutus-core-0.1.0.0:PlutusCore.DeBruijn.Internal.DeBruijn\n                          plutus-core-0.1.0.0:PlutusCore.Default.Universe.DefaultUni\n                          plutus-core-0.1.0.0:PlutusCore.Default.Builtins.DefaultFun\n                          ()}\n        -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Eq Script\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Ord Script\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\ninstance Show Script\n  -- Defined in \u2018plutus-ledger-api-0.1.0.0:Plutus.V1.Ledger.Scripts\u2019\n")),(0,l.kt)("p",null,"V\xe0 \u1edf \u0111\xe2y ch\xfang ta th\u1ea5y r\u1eb1ng ch\xfang ta c\xf3 m\u1ed9t unScripth\xe0m, ch\xfang ta c\xf3 th\u1ec3\nch\u1ea1y"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx Ledger.Scripts Week02.Gift> unScript $ getValidator validator\nProgram () (Version () 1 0 0) (Apply () (Apply () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (Apply () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (Apply () (Apply () (Apply () (Apply () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1}))) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 5})))))))) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1}))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1})))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Var () (DeBruijn {dbnIndex = 5})) (Var () (DeBruijn {dbnIndex = 6}))))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (Var () (DeBruijn {dbnIndex = 4})) (Var () (DeBruijn {dbnIndex = 7}))) (Var () (DeBruijn {dbnIndex = 6})))))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Var () (DeBruijn {dbnIndex = 3})) (Var () (DeBruijn {dbnIndex = 6}))))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Var () (DeBruijn {dbnIndex = 2})) (Var () (DeBruijn {dbnIndex = 6}))))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Var () (DeBruijn {dbnIndex = 1})) (Var () (DeBruijn {dbnIndex = 6}))))))))))) (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1}))))))) (Delay () (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 2}))))))) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (Var () (DeBruijn {dbnIndex = 1})) (Var () (DeBruijn {dbnIndex = 4}))) (Var () (DeBruijn {dbnIndex = 3})))))))))) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1}))))))) (Delay () (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (LamAbs () (DeBruijn {dbnIndex = 0}) (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (Apply () (Apply () (Var () (DeBruijn {dbnIndex = 1})) (Var () (DeBruijn {dbnIndex = 3}))) (Var () (DeBruijn {dbnIndex = 2})))))))))) (Delay () (Delay () (LamAbs () (DeBruijn {dbnIndex = 0}) (Var () (DeBruijn {dbnIndex = 1}))))))\n")),(0,l.kt)("p",null,"V\xe0 \u1edf \u0111\xe2y b\u1ea1n c\xf3 th\u1ec3 th\u1ea5y b\u1ea3n tr\xecnh b\xe0y trung th\u1ef1c \u0111\u1ebfn t\u1ed1t \u0111\u1eb9p c\u1ee7a t\u1eadp\nl\u1ec7nh Plutus Core cho tr\xecnh x\xe1c th\u1ef1c."),(0,l.kt)("p",null,"Quay l\u1ea1i m\xe3."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang t\xf4i c\xf3 tr\xecnh x\xe1c th\u1ef1c \u0111\u1ea7u ti\xean c\u1ee7a m\xecnh, c\xf3 hai lo\u1ea1i n\u1eefa\nm\xe0 ch\xfang t\xf4i c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh."),(0,l.kt)("p",null,"M\u1ed9t l\xe0 \\'\\'ValidatorHash\\'\\', nh\u01b0 t\xean cho th\u1ea5y, l\xe0 b\u0103m c\u1ee7a tr\xecnh x\xe1c\nnh\u1eadn."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"valHash :: Ledger.ValidatorHash\nvalHash = Scripts.validatorHash validator\n")),(0,l.kt)("p",null,"V\xe0, ch\xfang t\xf4i c\u0169ng c\xf3 th\u1ec3 bi\u1ebfn tr\xecnh x\xe1c th\u1ef1c th\xe0nh \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh, l\xe0\n\u0111\u1ecba ch\u1ec9 c\u1ee7a t\u1eadp l\u1ec7nh tr\xean blockchain."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"scrAddress :: Ledger.Address\nscrAddress = ScriptAddress valHash\n")),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta c\xf3 m\u1ed9t \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng\n",(0,l.kt)("inlineCode",{parentName:"p"},"scrAddress"),"."),(0,l.kt)("p",null,"Ch\xfang ta c\xf3 th\u1ec3 xem x\xe9t hai k\u1ebft qu\u1ea3 n\xe0y trong REPL"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-haskell"},"\nPrelude PlutusTx Ledger.Scripts Week02.Gift\n\nvalHash\nc3168d465a84b7f50c2eeb51ccacd53a305bd7883787adb54236d8d17535ca14\nPrelude PlutusTx Ledger.Scripts Week02.Gift\n\nscrAddress Address\n{addressCredential = ScriptCredential\nc3168d465a84b7f50c2eeb51ccacd53a305bd7883787adb54236d8d17535ca14,\naddressStakingCredential = Nothing}\n")),(0,l.kt)("p",null,"Ngo\u1ea1i tr\u1eeb h\xe0m logic ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator")," (trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\xfang ta l\xe0 m\u1ed9t\nd\xf2ng), ph\u1ea7n c\xf2n l\u1ea1i c\u1ee7a m\xe3 ch\xfang ta \u0111\xe3 vi\u1ebft cho \u0111\u1ebfn nay l\xe0 b\u1ea3n so\u1ea1n s\u1eb5n\nv\xe0 s\u1ebd r\u1ea5t gi\u1ed1ng nhau \u0111\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\xe1c t\u1eadp l\u1ec7nh Plutus."),(0,l.kt)("p",null,"\u0110\u1ec3 th\u1ef1c s\u1ef1 th\u1eed t\u1eadp l\u1ec7nh n\xe0y, ch\xfang t\xf4i c\u1ea7n m\xe3 v\xed. Tr\u1ecdng t\xe2m c\u1ee7a b\xe0i\ngi\u1ea3ng n\xe0y l\xe0 x\xe1c nh\u1eadn v\xe0 kh\xf4ng ph\u1ea3i m\xe3 v\xed, nh\u01b0ng ng\u1eafn g\u1ecdn, \u0111\xe2y l\xe0 ph\u1ea7n\nc\xf2n l\u1ea1i c\u1ee7a m\xe3."),(0,l.kt)("p",null,"Hai \u0111i\u1ec3m cu\u1ed1i \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh. \u0110i\u1ec3m cu\u1ed1i l\xe0 c\xe1ch \u0111\u1ec3 ng\u01b0\u1eddi d\xf9ng k\xedch ho\u1ea1t\nm\u1ed9t th\u1ee9 g\xec \u0111\xf3 v\u1edbi c\xe1c tham s\u1ed1 \u0111\u1ea7u v\xe0o."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Endpoint give")," s\u1ebd l\u1ea5y m\u1ed9t \u0111\u1ed1i s\u1ed1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh s\u1ed1 l\u01b0\u1ee3ng\nlovelace s\u1ebd \u0111\u01b0\u1ee3c g\u1eedi v\xe0o h\u1ee3p \u0111\u1ed3ng."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Endpoint grab")," s\u1ebd kh\xf4ng c\xf3 \u0111\u1ed1i s\u1ed1 v\xe0 s\u1ebd \u0111\u01a1n gi\u1ea3n t\xecm ki\u1ebfm c\xe1c UTxO t\u1ea1i\n\u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh n\xe0y v\xe0 s\u1eed d\u1ee5ng ch\xfang."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'type GiftSchema =\n            Endpoint "give" Integer\n        .\\/ Endpoint "grab" ()\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"endpoint give")," \u1eed d\u1ee5ng h\xe0m tr\u1ee3 gi\xfap ",(0,l.kt)("inlineCode",{parentName:"p"},"mustPayToOtherScript")," h\xe0m n\xe0y l\u1ea5y\n",(0,l.kt)("inlineCode",{parentName:"p"},"valHash")," c\u1ee7a t\u1eadp l\u1ec7nh ng\u01b0\u1eddi nh\u1eadn v\xe0 m\u1ed9t h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"Datum")," C\xe1i m\xe0 trong v\xed d\u1ee5\nn\xe0y l\xe0 ho\xe0n to\xe0n b\u1ecb b\u1ecf qua. n\xf3 s\u1eed d\u1ee5ng h\xe0m t\u1ea1o ",(0,l.kt)("inlineCode",{parentName:"p"},"Datum")," \u0111\u1ec3 bi\u1ebfn ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"\nth\xe0nh ",(0,l.kt)("inlineCode",{parentName:"p"},"Datum"),". Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1eb1ng c\xe1ch s\u1eed\nd\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"Constr")," h\xe0m t\u1ea1o l\u1ea5y 0 v\xe0 m\u1ed9t danh s\xe1ch tr\u1ed1ng."),(0,l.kt)("p",null,"Cu\u1ed1i c\xf9ng s\u1ed1 ti\u1ec1n c\u1ea7n g\u1eedi \u0111\u1ebfn \u0111\u1ecba ch\u1ec9 \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng\nch\u1ee9c n\u0103ng tr\u1ee3 gi\xfap ",(0,l.kt)("inlineCode",{parentName:"p"},"ADA.lovelaceValueOf"),"."),(0,l.kt)("p",null,"Giao d\u1ecbch sau \u0111\xf3 \u0111\u01b0\u1ee3c g\u1eedi \u0111i, t\u1eadp l\u1ec7nh ch\u1edd n\xf3 \u0111\u01b0\u1ee3c x\xe1c nh\u1eadn v\xe0 sau \u0111\xf3 in\nth\xf4ng b\xe1o nh\u1eadt k\xfd."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'give :: AsContractError e => Integer -> Contract w s e ()\ngive amount = do\n   let tx = mustPayToOtherScript valHash (Datum $ Constr 0 []) $ ADA.lovelaceValueOf amount\n   ledgerTx <- submitTx tx\n   void $ awaitTxConfirmed $ txId ledgerTx\n   logInfo @String $ printf "made a gift of %d lovelace" amount\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"endpoint grab")," ph\u1ee9c t\u1ea1p h\u01a1n m\u1ed9t ch\xfat."),(0,l.kt)("p",null,"Ch\xfang t\xf4i s\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"utxoAt")," \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh m\u1edbi c\u1ee7a m\xecnh ",(0,l.kt)("inlineCode",{parentName:"p"},"scrAddress")," \u0111\u1ec3\ntra c\u1ee9u t\u1ea5t c\u1ea3 c\xe1c UTxO \u1edf \u0111\u1ecba ch\u1ec9 \u0111\xf3. Sau \u0111\xf3, ch\xfang t\xf4i c\u1ea7n tra c\u1ee9u, s\u1ebd\n\u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi v\xed \u0111\u1ec3 t\u1ea1o giao d\u1ecbch. T\u1ea1i \u0111\xe2y, ch\xfang t\xf4i cho v\xed bi\u1ebft n\u01a1i\nt\xecm t\u1ea5t c\u1ea3 c\xe1c UTxO v\xe0 ch\xfang t\xf4i th\xf4ng b\xe1o cho v\xed v\u1ec1 tr\xecnh x\xe1c th\u1ef1c. H\xe3y\nnh\u1edb r\u1eb1ng, n\u1ebfu b\u1ea1n mu\u1ed1n s\u1eed d\u1ee5ng UTxO \u1edf m\u1ed9t \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh, th\xec giao\nd\u1ecbch chi ti\xeau c\u1ea7n cung c\u1ea5p m\xe3 x\xe1c th\u1ef1c, trong khi giao d\u1ecbch t\u1ea1o ra UTxO\nch\u1ec9 c\u1ea7n cung c\u1ea5p h\xe0m b\u0103m."),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i x\xe1c \u0111\u1ecbnh giao d\u1ecbch b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng\n",(0,l.kt)("inlineCode",{parentName:"p"},"mustSpendScriptOutput")," cho m\u1ed7i UTxO \u0111\u01b0\u1ee3c t\xecm th\u1ea5y. \u0110i\u1ec1u n\xe0y n\xf3i l\xean\nr\u1eb1ng m\u1ecdi UTxO \u1edf \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh n\xe0y ph\u1ea3i \u0111\u01b0\u1ee3c chi ti\xeau b\u1eb1ng giao d\u1ecbch\nm\xe0 ch\xfang t\xf4i \u0111ang x\xe2y d\u1ef1ng."),(0,l.kt)("p",null,"Ch\xfang t\xf4i c\u0169ng chuy\u1ec3n m\u1ed9t c\xf4ng c\u1ee5 \u0111\u1ed5i qu\xe0 ho\xe0n to\xe0n b\u1ecb b\u1ecf qua trong v\xed\nd\u1ee5 c\u1ee7a ch\xfang t\xf4i, v\xec v\u1eady ch\xfang t\xf4i c\xf3 th\u1ec3 \u0111\u1eb7t b\u1ea5t k\u1ef3 th\u1ee9 g\xec \u1edf \u0111\xf3 - trong\ntr\u01b0\u1eddng h\u1ee3p n\xe0y, m\u1ed9t c\xf4ng c\u1ee5 \u0111\u1ed5i qu\xe0 \u0111\u01b0\u1ee3c t\u1ea1o b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng h\xe0m t\u1ea1o\n",(0,l.kt)("inlineCode",{parentName:"p"},"I")," c\u1ee7a lo\u1ea1i ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," c\xf3 gi\xe1 tr\u1ecb l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"17"),"."),(0,l.kt)("p",null,"M\u1ed9t l\u1ea7n n\u1eefa, ch\xfang t\xf4i g\u1eedi, ch\u1edd x\xe1c nh\u1eadn v\xe0 sau \u0111\xf3 vi\u1ebft th\xf4ng b\xe1o nh\u1eadt\nk\xfd."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'grab :: forall w s e. AsContractError e => Contract w s e ()\ngrab = do\n   utxos <- utxoAt scrAddress\n   let orefs   = fst <$> Map.toList utxos\n      lookups  = Constraints.unspentOutputs utxos      <>\n                 Constraints.otherScript validator\n      tx :: TxConstraints Void Void\n      tx       = mconcat [mustSpendScriptOutput oref $ Redeemer $ I 17 | oref <- orefs]\n   ledgerTx <- submitTxConstraintsWith @Void lookups tx\n   void $ awaitTxConfirmed $ txId ledgerTx\n   logInfo @String $ "collected gifts"\n')),(0,l.kt)("p",null,"Cu\u1ed1i c\xf9ng, ch\xfang t\xf4i \u0111\u1eb7t t\u1ea5t c\u1ea3 l\u1ea1i v\u1edbi nhau trong h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoints"),". \u0110\xe2y\nl\xe0 m\xe3 so\u1ea1n s\u1eb5n th\xf4ng b\xe1o cho v\xed cung c\u1ea5p t\xf9y ch\u1ecdn c\u1ee7a m\u1ed9t s\u1ed1 \u0111i\u1ec3m cu\u1ed1i\nnh\u1ea5t \u0111\u1ecbnh cho ng\u01b0\u1eddi d\xf9ng v\xe0 sau \u0111\xf3, khi m\u1ed9t \u0111i\u1ec3m cu\u1ed1i \u0111\xe3 \u0111\u01b0\u1ee3c ch\u1ecdn, s\u1ebd\nl\u1eb7p l\u1ea1i v\xe0 ti\u1ebfp t\u1ee5c cung c\u1ea5p c\xe1c t\xf9y ch\u1ecdn t\u01b0\u01a1ng t\u1ef1 l\u1eb7p \u0111i l\u1eb7p l\u1ea1i. Trong\ntr\u01b0\u1eddng h\u1ee3p c\u1ee7a ",(0,l.kt)("inlineCode",{parentName:"p"},"give")," ng\u01b0\u1eddi d\xf9ng s\u1ebd \u0111\u01b0\u1ee3c y\xeau c\u1ea7u cung c\u1ea5p \u0111\u1ed1i s\u1ed1\n",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," ."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"endpoints :: Contract () GiftSchema Text ()\nendpoints = (give' `select` grab') >> endpoints\n  where\n    give' = endpoint @\"give\" >>= give\n    grab' = endpoint @\"grab\" >>  grab\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i c\xf3 m\u1ed9t l\u1ec7nh nh\u1ecf."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkSchemaDefinitions ''GiftSchema\n")),(0,l.kt)("p",null,"V\xe0 sau \u0111\xf3 m\u1ed9t s\u1ed1 m\xe3 ch\u1ec9 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi Plutus Playground cho ph\xe9p\nch\xfang t\xf4i ch\u1ec9 \u0111\u1ecbnh c\xe1c m\xe3 th\xf4ng b\xe1o b\u1ed5 sung c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1eed\nnghi\u1ec7m."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkKnownCurrencies []\n")),(0,l.kt)("p",null,"Th\u1eed Nghi\u1ec7m +++++++"),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang t\xf4i s\u1ebd th\u1eed nghi\u1ec7m script ",(0,l.kt)("inlineCode",{parentName:"p"},"Gift")," trong playground."),(0,l.kt)("p",null,"B\u1ea1n Copy ",(0,l.kt)("inlineCode",{parentName:"p"},"Gift")," v\xe0o playground, sau \u0111\xf3 bi\xean d\u1ecbch t\u1eadp l\u1ec7nh trong\nplayground and nh\u1ea5n n\xfat ",(0,l.kt)("inlineCode",{parentName:"p"},"Simulate"),"."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3294).Z})),(0,l.kt)("p",null,"Gi\u1edd h\xe3y th\xeam m\u1ed9t chi\u1ebfc v\xed th\u1ee9 ba v\xe0 cung c\u1ea5p cho t\u1ea5t c\u1ea3 c\xe1c v\xed 10 ADA\n(10 tri\u1ec7u lovelace)."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(868).Z})),(0,l.kt)("p",null,"Ch\xfang t\xf4i s\u1ebd t\u1ea1o m\u1ed9t k\u1ecbch b\u1ea3n trong \u0111\xf3 v\xed 1 v\xe0 2 cho c\u1ea3m gi\xe1c y\xeau th\xedch\nv\xe0 v\xed 3 l\u1ea5y t\u1ea5t c\u1ea3."),(0,l.kt)("p",null,"B\u1ea1n s\u1ebd th\u1ea5y r\u1eb1ng s\xe2n ch\u01a1i \u0111\xe3 hi\u1ec3n th\u1ecb c\xe1c n\xfat giao di\u1ec7n ng\u01b0\u1eddi d\xf9ng cho\nhai endpoints ",(0,l.kt)("inlineCode",{parentName:"p"},"give")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"grab"),". S\u1eed dung ",(0,l.kt)("inlineCode",{parentName:"p"},"endpoint give")," \u0111\u1ec3 t\u1ea1o v\xed 1 t\u1eb7ng\n4 ADA v\xe0 \u0111\u1ec3 t\u1ea1o v\xed 2 t\u1eb7ng 6 ADA. Sau \u0111\xf3, th\xeam h\xe0nh \u0111\u1ed9ng ch\u1edd \u0111\u1ec3 \u0111\u1ee3i 1\nkh\u1ed1i, v\xe0 sau \u0111\xf3 s\u1eed d\u1ee5ng v\xe0o endpoints ",(0,l.kt)("inlineCode",{parentName:"p"},"grab")," \u0111\u1ec3 t\u1ea1o v\xed 3 l\u1ea5y ti\u1ec1n. Sau\n\u0111\xf3, th\xeam m\u1ed9t h\xe0nh \u0111\u1ed9ng ch\u1edd kh\xe1c \u0111\u1ec3 \u0111\u1ee3i 1 kh\u1ed1i."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(8358).Z})),(0,l.kt)("p",null,"V\xe0 b\xe2y gi\u1edd h\xe3y nh\u1ea5p v\xe0o ",(0,l.kt)("inlineCode",{parentName:"p"},"Evaluate"),". Ch\xfang t\xf4i th\u1ea5y r\u1eb1ng \u0111\xe3 c\xf3 b\u1ed1n giao\nd\u1ecbch."),(0,l.kt)("p",null,"Giao d\u1ecbch \u0111\u1ea7u ti\xean, nh\u01b0 m\u1ecdi khi, l\xe0 giao d\u1ecbch kh\u1edfi \u0111\u1ea7u ph\xe2n ph\u1ed1i c\xe1c\nkho\u1ea3n ti\u1ec1n ban \u0111\u1ea7u v\xe0o v\xed."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(9297).Z})),(0,l.kt)("p",null,"V\xe0 c\xf3 hai giao d\u1ecbch x\u1ea3y ra t\u1ea1i khe 1. Ch\xfang l\xe0 hai giao d\u1ecbch ",(0,l.kt)("inlineCode",{parentName:"p"},"give")),(0,l.kt)("p",null,"L\u1ec7nh \u0111\u1ea7u ti\xean, Tx 0, l\xe0 t\u1eeb v\xed 2. Th\u1ee9 t\u1ef1 \u1edf \u0111\xe2y kh\xf4ng \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh b\u1edfi\nth\u1ee9 t\u1ef1 m\xe0 ch\xfang t\xf4i \u0111\xe3 t\u1ea1o c\xe1c giao d\u1ecbch trong tr\xecnh m\xf4 ph\u1ecfng. \u0110i\u1ec1u quan\ntr\u1ecdng c\u1ea7n l\u01b0u \xfd l\xe0 c\u1ea3 hai giao d\u1ecbch ",(0,l.kt)("inlineCode",{parentName:"p"},"give")," \u0111\u1ec1u x\u1ea3y ra t\u1ea1i c\xf9ng m\u1ed9t th\u1eddi\n\u0111i\u1ec3m."),(0,l.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y ba k\u1ebft qu\u1ea3 \u0111\u1ea7u ra. \u0110\u1ea7u ra \u0111\u1ea7u ti\xean l\xe0 ph\xed 10 lovelace\n\u0111\u01b0\u1ee3c tr\u1ea3 b\u1eb1ng v\xed 2. \u0110\u1ea7u ra th\u1ee9 hai l\xe0 6 ADA \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn \u0111\u1ecba ch\u1ec9 t\u1eadp\nl\u1ec7nh v\xe0 \u0111\u1ea7u ra th\u1ee9 ba l\xe0 tr\u1ea3 v\u1ec1 thay \u0111\u1ed5i cho v\xed 2, l\xe0 4 ADA tr\u1eeb \u0111i ph\xed."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3027).Z})),(0,l.kt)("p",null,"V\xe0 th\u1ee9 hai, Tx 1, l\xe0 t\u1eeb v\xed 1. M\u1ed9t l\u1ea7n n\u1eefa, v\u1edbi c\xe1c UTxO \u0111\u1ea7u ra t\u01b0\u01a1ng t\u1ef1."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta c\xf3 hai UTxO \u1edf \u0111\u1ecba ch\u1ec9 t\u1eadp\nl\u1ec7nh."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(6061).Z})),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i c\xf3 ",(0,l.kt)("inlineCode",{parentName:"p"},"grab")," t\u1ea1i v\u1ecb tr\xed 2 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t b\u1edfi v\xed 3. Ch\xfang\nt\xf4i th\u1ea5y hai UTxO t\u1eeb t\u1eadp l\u1ec7nh l\xe0 \u0111\u1ea7u v\xe0o v\xe0 sau \u0111\xf3 l\xe0 hai \u0111\u1ea7u ra. M\u1ed9t\n\u0111\u1ea7u ra l\xe0 ph\xed v\xe0 \u0111\u1ea7u ra c\xf2n l\u1ea1i, \u0111\u01b0\u1ee3c tr\u1ea3 cho v\xed 3, l\xe0 10 ADA tr\u1eeb \u0111i c\xe1c\nkho\u1ea3n ph\xed \u0111\xf3. B\u1ea1n s\u1ebd nh\u1eadn th\u1ea5y r\u1eb1ng ph\xed hi\u1ec7n cao h\u01a1n ch\xfang ta \u0111\xe3 th\u1ea5y\ntr\u01b0\u1edbc \u0111\xe2y v\xe0 \u0111i\u1ec1u n\xe0y l\xe0 do m\u1ed9t t\u1eadp l\u1ec7nh hi\u1ec7n \u0111\xe3 \u0111\u01b0\u1ee3c th\u1ef1c thi, \u0111i\u1ec1u n\xe0y\nl\xe0m cho n\xf3 \u0111\u1eaft h\u01a1n. Tuy nhi\xean, c\xe1c kho\u1ea3n ph\xed \u1edf \u0111\xe2y v\u1eabn ch\u01b0a \u0111\u01b0\u1ee3c hi\u1ec7u\nch\u1ec9nh ho\xe0n to\xe0n v\u1edbi nh\u1eefng kho\u1ea3n ph\xed s\u1ebd \u0111\u01b0\u1ee3c t\xednh tr\xean blockchain th\u1ef1c."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(2454).Z})),(0,l.kt)("p",null,"V\xe0, b\u1eb1ng c\xe1ch cu\u1ed9n xu\u1ed1ng, ch\xfang t\xf4i th\u1ea5y s\u1ed1 d\u01b0 cu\u1ed1i c\xf9ng c\u1ee7a v\xed."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(8100).Z})),(0,l.kt)("p",null,"N\u1ebfu b\u1ea1n cu\u1ed9n xu\u1ed1ng s\xe2u h\u01a1n, b\u1ea1n s\u1ebd th\u1ea5y m\u1ed9t s\u1ed1 d\u1ea5u v\u1ebft v\xe0 k\u1ebft qu\u1ea3 \u0111\u1ea7u ra\nnh\u1eadt k\xfd s\u1ebd cung c\u1ea5p th\xeam chi ti\u1ebft v\u1ec1 vi\u1ec7c th\u1ef1c thi."),(0,l.kt)("p",null,"Nh\u01b0 \u0111\xe3 \u0111\u1ec1 c\u1eadp, t\u1eadp l\u1ec7nh n\xe0y s\u1eed d\u1ee5ng tr\xecnh x\xe1c th\u1ef1c \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\xf3 th\u1ec3,\nm\u1ed9t tr\xecnh x\xe1c th\u1ef1c lu\xf4n th\xe0nh c\xf4ng. Nh\u01b0ng tr\xecnh x\xe1c th\u1ef1c nh\u1ecf ng\u1edb ng\u1ea9n\nn\xe0y c\xf3 th\u1ec3 h\u1eefu \xedch trong t\xecnh hu\u1ed1ng ai \u0111\xf3 mu\u1ed1n \u0111\xf3ng g\xf3p m\u1ed9t s\u1ed1 bi\u1ec3u\nt\u01b0\u1ee3ng t\xecnh y\xeau cho c\u1ed9ng \u0111\u1ed3ng v\xe0 \u0111\u1ec3 l\u1ea1i cho b\u1ea1n!"),(0,l.kt)("h3",{id:"v\xed-d\u1ee5-2---burn"},"V\xed d\u1ee5 2 - Burn"),(0,l.kt)("p",null,"H\xe3y xem v\xed d\u1ee5 th\u1ee9 hai v\u1ec1 tr\xecnh x\xe1c nh\u1eadn."),(0,l.kt)("p",null,"Ch\xfang ta s\u1ebd b\u1eaft \u0111\u1ea7u b\u1eb1ng c\xe1ch sao ch\xe9p ",(0,l.kt)("inlineCode",{parentName:"p"},"Gift.hs"),"v\xe0 \u0111\u1ed5i t\xean n\xf3 ",(0,l.kt)("inlineCode",{parentName:"p"},"Burn.hs"),"."),(0,l.kt)("p",null,"Trong v\xed d\u1ee5 ",(0,l.kt)("inlineCode",{parentName:"p"},"Gift"),", ch\xfang t\xf4i c\xf3 m\u1ed9t tr\xecnh x\xe1c nh\u1eadn lu\xf4n th\xe0nh c\xf4ng.\nTrong v\xed d\u1ee5 n\xe0y, ch\xfang t\xf4i mu\u1ed1n l\xe0m ng\u01b0\u1ee3c l\u1ea1i - m\u1ed9t tr\xecnh x\xe1c nh\u1eadn lu\xf4n\nkh\xf4ng th\xe0nh c\xf4ng."),(0,l.kt)("p",null,"Nh\u1edb l\u1ea1i r\u1eb1ng tr\xecnh x\xe1c th\u1ef1c ch\u1ec9 ra s\u1ef1 th\u1ea5t b\u1ea1i b\u1eb1ng c\xe1ch n\xe9m ra m\u1ed9t l\u1ed7i.\nV\xec v\u1eady, ch\xfang t\xf4i c\xf3 th\u1ec3 s\u1eeda \u0111\u1ed5i tr\xecnh x\xe1c th\u1ef1c c\u1ee7a m\xecnh cho ph\xf9 h\u1ee3p."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> ()\nmkValidator _ _ _ = error ()\n")),(0,l.kt)("p",null,"N\u1ebfu ch\xfang t\xf4i t\u1ea3i m\xf4-\u0111un trong REPL v\xe0 nh\xecn th\u1ea5y ",(0,l.kt)("em",{parentName:"p"},"error")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Burn> :t error\nerror :: [Char] -> a\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y \u0111\u1ecbnh ngh\u0129a cho ch\u1ee9c n\u0103ng ",(0,l.kt)("inlineCode",{parentName:"p"},"error")," \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh trong\nHaskell ti\xeau chu\u1ea9n ",(0,l.kt)("inlineCode",{parentName:"p"},"Prelude"),". Tuy nhi\xean, m\u1ed9t trong ph\u1ea1m vi trong m\xe3 c\u1ee7a\nch\xfang t\xf4i tr\xean th\u1ef1c t\u1ebf l\xe0 ch\u1ee9c n\u0103ng ",(0,l.kt)("inlineCode",{parentName:"p"},"error"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Burn> :t PlutusTx.Prelude.error\nPlutusTx.Prelude.error :: () -> a\n")),(0,l.kt)("p",null,"Th\xf4ng th\u01b0\u1eddng trong Haskell, b\u1ea1n c\xf3 h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"error")," nh\u1eadn m\u1ed9t chu\u1ed7i th\xf4ng b\xe1o\nl\u1ed7i v\xe0 g\xe2y ra l\u1ed7i. Trong Plutus, h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"error"),"kh\xf4ng nh\u1eadn m\u1ed9t chu\u1ed7i - n\xf3\nch\u1ec9 nh\u1eadn khi\u1ec3u tr\u1ed1ng ",(0,l.kt)("inlineCode",{parentName:"p"},"()")," v\xe0 tr\u1ea3 v\u1ec1 m\u1ed9t ki\u1ec3u t\xf9y \xfd."),(0,l.kt)("p",null,"V\xe0 \u0111i\u1ec1u \u0111\xf3 \u0111\u01b0a ch\xfang ta \u0111\u1ebfn m\u1ed9t \u0111i\u1ec3m quan tr\u1ecdng."),(0,l.kt)("p",null,"Ch\xfang t\xf4i \u0111\xe3 \u0111\u1ec1 c\u1eadp tr\u01b0\u1edbc \u0111\xf3 r\u1eb1ng ch\xfang t\xf4i s\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"INLINABLE")," tr\xean h\xe0m\n",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator")," \u0111\u1ec3 cho ph\xe9p n\xf3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi m\xe3 Haskell Prelude. Trong\nHaskell c\xf3 nhi\u1ec1u ch\u1ee9c n\u0103ng c\xf3 s\u1eb5n th\xf4ng qua m\xf4-\u0111un ",(0,l.kt)("inlineCode",{parentName:"p"},"Prelude"),", nh\u01b0ng\nnh\u1eefng ch\u1ee9c n\u0103ng n\xe0y s\u1ebd kh\xf4ng th\u1ec3 s\u1eed d\u1ee5ng \u0111\u01b0\u1ee3c trong Plutus v\xec ch\xfang\nkh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\xe0 c\xf3 th\u1ec3 nh\u1eadp \u0111\u01b0\u1ee3c. V\xec v\u1eady, nh\xf3m Plutus \u0111\xe3 cung\nc\u1ea5p m\u1ed9t \u0110o\u1ea1n d\u1ea1o \u0111\u1ea7u thay th\u1ebf c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 x\xe1c nh\u1eadn."),(0,l.kt)("p",null,"C\xe1ch m\xe0 Plutus Prelude c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0u ti\xean h\u01a1n Haskell Prelude, th\u01b0\u1eddng\nc\xf3 trong ph\u1ea1m vi theo m\u1eb7c \u0111\u1ecbnh, l\xe0 s\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"LANGUAGE")," trong m\xe3."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# LANGUAGE NoImplicitPrelude   #-}\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, b\u1eb1ng c\xe1ch nh\u1eadp PlutusTx.Prelude, c\xe1c ch\u1ee9c n\u0103ng c\u1ee7a n\xf3 \u0111\u01b0\u1ee3c s\u1eed\nd\u1ee5ng thay cho c\xe1c ch\u1ee9c n\u0103ng Prelude ti\xeau chu\u1ea9n."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"import PlutusTx.Prelude hiding (Semigroup(..), unless)\n")),(0,l.kt)("p",null,"B\u1ea1n c\u0169ng c\xf3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng Prelude ti\xeau chu\u1ea9n c\u0169ng \u0111\u01b0\u1ee3c nh\u1eadp kh\u1ea9u.\nTuy nhi\xean, n\xf3 ch\u1ec9 nh\u1eb1m mang l\u1ea1i m\u1ed9t s\u1ed1 ch\u1ee9c n\u0103ng kh\xf4ng li\xean quan g\xec \u0111\u1ebfn\nx\xe1c th\u1ef1c m\xe0 ch\u1ec9 d\xe0nh cho m\xe3 off-chain v\xe0 playground."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"import Prelude (IO, Semigroup (..), String)\n")),(0,l.kt)("p",null,"N\xf3 c\xf3 th\u1ec3 g\xe2y nh\u1ea7m l\u1eabn. R\u1ea5t nhi\u1ec1u ch\u1ee9c n\u0103ng trong Plutus Prelude c\xf3 c\xf9ng\nch\u1eef k\xfd v\xe0 h\xe0nh vi gi\u1ed1ng nh\u01b0 t\xean g\u1ecdi c\u1ee7a ch\xfang trong Prelude ti\xeau chu\u1ea9n,\nnh\u01b0ng \u0111i\u1ec1u \u0111\xf3 kh\xf4ng ph\u1ea3i l\xfac n\xe0o c\u0169ng \u0111\xfang v\xe0 \u0111\xe2y errorl\xe0 m\u1ed9t v\xed d\u1ee5."),(0,l.kt)("p",null,"Ch\u1ec9 c\u1ea7n nh\u1edb r\u1eb1ng khi b\u1ea1n \u0111ang s\u1eed d\u1ee5ng m\u1ed9t c\xe1i g\xec \u0111\xf3 trong t\u1eadp l\u1ec7nh\nPlutus tr\xf4ng gi\u1ed1ng nh\u01b0 m\u1ed9t h\xe0m t\u1eeb \u0110o\u1ea1n d\u1ea1o \u0111\u1ea7u ti\xeau chu\u1ea9n, th\xec nh\u1eefng g\xec\nb\u1ea1n th\u1ef1c s\u1ef1 \u0111ang s\u1eed d\u1ee5ng l\xe0 m\u1ed9t h\xe0m t\u1eeb \u0110o\u1ea1n d\u1ea1o \u0111\u1ea7u Plutus. Th\u01b0\u1eddng th\xec\nch\xfang s\u1ebd c\xf3 c\xf9ng m\u1ed9t ch\u1eef k\xfd, nh\u01b0ng ch\xfang kh\xf4ng ph\u1ea3i l\xfac n\xe0o c\u0169ng gi\u1ed1ng\nh\u1ec7t nhau - v\xed d\u1ee5: ti\u1ec1n l\u1ec7 c\u1ee7a to\xe1n t\u1eed c\xf3 th\u1ec3 kh\xf4ng gi\u1ed1ng nhau"),(0,l.kt)("p",null,"Nh\xecn l\u1ea1i tr\xecnh x\xe1c th\u1ef1c m\u1edbi c\u1ee7a ch\xfang t\xf4i, b\xe2y gi\u1edd ch\xfang ta c\xf3 m\u1ed9t tr\xecnh\nx\xe1c th\u1ef1c s\u1ebd lu\xf4n kh\xf4ng th\xe0nh c\xf4ng."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> ()\nmkValidator _ _ _ = error ()\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i s\u1ebd \u0111\u1ec3 m\u1ecdi th\u1ee9 kh\xe1c nh\u01b0 c\u0169 v\xe0 ki\u1ec3m tra t\xe1c d\u1ee5ng c\u1ee7a s\u1ef1 thay \u0111\u1ed5i\nn\xe0y, b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng s\xe2n ch\u01a1i. Sau khi nh\u1ea5p ",(0,l.kt)("inlineCode",{parentName:"p"},"Compile"),", k\u1ecbch b\u1ea3n tr\u01b0\u1edbc\n\u0111\xf3 v\u1eabn s\u1ebd xu\u1ea5t hi\u1ec7n trong tr\xecnh m\xf4 ph\u1ecfng. V\xe0 sau khi nh\u1ea5p ",(0,l.kt)("inlineCode",{parentName:"p"},"Evaluate")," v\xe0\ncu\u1ed9n xu\u1ed1ng m\u1ed9t ch\xfat, ch\xfang ta c\xf3 th\u1ec3 th\u1ea5y v\xed 1 v\xe0 2 \u0111\xe3 t\u1ea1o qu\xe0 t\u1eb7ng\nnh\u01b0ng v\xed 3 kh\xf4ng th\u1ec3 l\u1ea5y \u0111\u01b0\u1ee3c."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(4193).Z})),(0,l.kt)("p",null,"N\u1ebfu ch\xfang t\xf4i cu\u1ed9n xu\u1ed1ng th\xeam, ch\xfang t\xf4i s\u1ebd t\xecm th\u1ea5y m\u1ed9t th\xf4ng b\xe1o nh\u1eadt\nk\xfd cho th\u1ea5y r\u1eb1ng vi\u1ec7c x\xe1c th\u1ef1c kh\xf4ng th\xe0nh c\xf4ng."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.}"},', Slot 2: 00000000-0000-4000-8000-000000000002 {Contract instance for wallet 3}:\n      Contract instance stopped with error: "WalletError (ValidationError (ScriptFailure (EvaluationError [])))" ]\n')),(0,l.kt)("p",null,"V\xec v\u1eady, trong v\xed d\u1ee5 \u0111\u1ea7u ti\xean c\u1ee7a ch\xfang t\xf4i, ch\xfang t\xf4i c\xf3 m\u1ed9t tr\xecnh x\xe1c\nth\u1ef1c lu\xf4n th\xe0nh c\xf4ng v\xe0 cho ph\xe9p b\u1ea5t k\u1ef3 ai l\u1ea5y UTxO t\u1eeb n\xf3. Trong v\xed d\u1ee5\nth\u1ee9 hai, ch\xfang t\xf4i c\xf3 tr\xecnh x\xe1c th\u1ef1c lu\xf4n kh\xf4ng th\xe0nh c\xf4ng v\xe0 b\u1ea5t k\u1ef3\nUTxO n\xe0o \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh n\xe0y kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c\ntruy xu\u1ea5t. V\u1ec1 c\u01a1 b\u1ea3n \u0111\xe2y l\xe0 m\u1ed9t c\xe1ch \u0111\u1ec3 \u0111\u1ed1t ti\u1ec1n, c\xf3 th\u1ec3 h\u1eefu \xedch trong\nm\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p."),(0,l.kt)("p",null,"Khi nh\xecn v\xe0o nh\u1eadt k\xfd, ch\xfang t\xf4i th\u1ea5y r\u1eb1ng qu\xe1 tr\xecnh x\xe1c nh\u1eadn kh\xf4ng th\xe0nh\nc\xf4ng, nh\u01b0ng ch\xfang t\xf4i kh\xf4ng bi\u1ebft t\u1ea1i sao n\xf3 kh\xf4ng th\xe0nh c\xf4ng. \u0111\xe2y l\xe0 m\u1ed9t\nc\xe1ch \u0111\u1ec3 thay \u0111\u1ed5i \u0111i\u1ec1u \u0111\xf3 b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a l\u1ed7i -\n",(0,l.kt)("inlineCode",{parentName:"p"},"traceError"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Burn> :t PlutusTx.Prelude.traceError\nPlutusTx.Prelude.traceError :: PlutusTx.Builtins.String -> a      \n")),(0,l.kt)("p",null,"H\xe0m nh\u1eadn m\u1ed9t chu\u1ed7i, nh\u01b0ng kh\xf4ng ph\u1ea3i l\xe0 m\u1ed9t chu\u1ed7i Haskell. N\xf3 l\xe0 m\u1ed9t\nchu\u1ed7i Plutus. \u0110\u1ec3 bi\xean d\u1ecbch c\xe1i n\xe0y, ch\xfang ta c\u1ea7n s\u1eed d\u1ee5ng\nOverloadedStringsph\u1ea7n m\u1edf r\u1ed9ng GHC."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# LANGUAGE OverloadedStrings   #-}\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i c\xf3 th\u1ec3 c\u1eadp nh\u1eadt tr\xecnh x\xe1c th\u1ef1c c\u1ee7a m\xecnh."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mkValidator _ _ _ = traceError "BURNT!"\n')),(0,l.kt)("p",null,"N\u1ebfu b\xe2y gi\u1edd ch\xfang t\xf4i ch\u1ea1y c\xf9ng m\u1ed9t k\u1ecbch b\u1ea3n trong s\xe2n ch\u01a1i v\u1edbi m\xe3 m\u1edbi,\nch\xfang t\xf4i s\u1ebd th\u1ea5y th\xf4ng b\xe1o l\u1ed7i t\xf9y ch\u1ec9nh m\xe0 ch\xfang t\xf4i \u0111\xe3 th\xeam."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.}"},', Slot 2: 00000000-0000-4000-8000-000000000002 {Contract instance for wallet 3}:\n      Contract instance stopped with error: "WalletError (ValidationError (ScriptFailure (EvaluationError [\\"BURNT!\\"])))" ]\n')),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(8937).Z})),(0,l.kt)("p",null,"V\xed d\u1ee5 3 - Forty Two (42) ","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~"),(0,l.kt)("p",null,"\u0110\u1ed1i v\u1edbi v\xed d\u1ee5 ti\u1ebfp theo, ch\xfang t\xf4i s\u1ebd vi\u1ebft m\u1ed9t tr\xecnh x\xe1c nh\u1eadn kh\xf4ng ho\xe0n\nto\xe0n b\u1ecf qua t\u1ea5t c\u1ea3 c\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a n\xf3. Ch\xfang t\xf4i s\u1ebd vi\u1ebft m\u1ed9t b\xe0i b\xe1o mong\n\u0111\u1ee3i m\u1ed9t ng\u01b0\u1eddi mua l\u1ea1i \u0111\u01a1n gi\u1ea3n."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta quan t\xe2m \u0111\u1ebfn ng\u01b0\u1eddi \u0111\u1ed5i qu\xe0, ch\xfang ta c\u1ea7n c\xf3 th\u1ec3 tham\nkh\u1ea3o n\xf3. H\xe3y g\u1ecdi n\xf3 ",(0,l.kt)("inlineCode",{parentName:"p"},"r"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# INLINABLE mkValidator #-}\nmkValidator :: Data -> Data -> Data -> ()\nmkValidator _ r _\n")),(0,l.kt)("p",null,"Gi\u1ea3 s\u1eed r\u1eb1ng ch\xfang t\xf4i mu\u1ed1n x\xe1c th\u1ef1c \u0111\u01b0\u1ee3c th\xf4ng qua n\u1ebfu ng\u01b0\u1eddi \u0111\u1ed5i ",(0,l.kt)("inlineCode",{parentName:"p"},"I 42"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'{-# INLINABLE mkValidator #-}\nmkValidator :: Data -> Data -> Data -> ()\nmkValidator _ r _\n   | r == I 42 = ()\n   | otherwise = traceError "wrong redeemer"\n')),(0,l.kt)("p",null,"N\u1ebfu ch\xfang ta ch\u1ea1y \u0111i\u1ec1u n\xe0y ngay b\xe2y gi\u1edd trong s\xe2n ch\u01a1i, vi\u1ec7c x\xe1c nh\u1eadn s\u1ebd\nlu\xf4n kh\xf4ng th\xe0nh c\xf4ng. Ch\xfang t\xf4i c\u1ea7n s\u1eeda \u0111\u1ed5i m\xe3 off-chain \u0111\u1ec3 th\xeam \u0111\u1ea7u\nv\xe0o cho Endpoint ",(0,l.kt)("inlineCode",{parentName:"p"},"grab")," \u0111\u1ec3 v\xed 3 c\xf3 th\u1ec3 chuy\u1ec3n v\xe0o m\u1ed9t \u0111i\u1ec3m ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," m\xe0\nsau \u0111\xf3 ch\xfang t\xf4i c\xf3 th\u1ec3 chuy\u1ec3n cho tr\xecnh x\xe1c th\u1ef1c v\u1edbi t\u01b0 c\xe1ch l\xe0\nredeemer."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'type GiftSchema =\n          Endpoint "give" Integer\n      .\\/ Endpoint "grab" Integer\n')),(0,l.kt)("p",null,"Chung t\xf4i th\xeam \u0111\u1ed1i s\u1ed1 redeemer v\xe0o khai b\xe1o ",(0,l.kt)("inlineCode",{parentName:"p"},"grab"),". L\u01b0u \xfd r\u1eb1ng vi\u1ec7c th\xeam\ns\u1ed1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," trong ch\u1ee9c n\u0103ng k\xfd, c\u0169ng nh\u01b0 tham s\u1ed1 ",(0,l.kt)("inlineCode",{parentName:"p"},"n")," c\xe1i m\xe0 l\xe0m tham\nchi\u1ebfu."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"grab :: forall w s e. AsContractError e => Integer -> Contract w s e ()\ngrab n = do\n")),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang ta c\xf3 th\u1ec3 chuy\u1ec3n n\xf3 v\xe0o h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"mustSpendScriptOutput")," thay\nv\xec gi\xe1 tr\u1ecb v\u1ee9t b\u1ecf m\xe0 ch\xfang ta \u0111\xe3 s\u1eed d\u1ee5ng tr\u01b0\u1edbc \u0111\xf3."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"tx = mconcat [mustSpendScriptOutput oref $ Redeemer $ I n | oref <- orefs]\n")),(0,l.kt)("p",null,"M\u1ed9t thay \u0111\u1ed5i n\u1eefa, ch\xfang ta c\u1ea7n thay \u0111\u1ed5i ",(0,l.kt)("inlineCode",{parentName:"p"},">>")," th\xe0nh ",(0,l.kt)("inlineCode",{parentName:"p"},">>=")," trong \u0111o\u1ea1n m\xe3\nsau, v\xe0 b\xe2y gi\u1edd ",(0,l.kt)("inlineCode",{parentName:"p"},"grab")," c\xf3 m\u1ed9t \u0111\u1ed1i s\u1ed1. B\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng REPL \u0111\u1ec3 th\u1ea5y\n",(0,l.kt)("inlineCode",{parentName:"p"},">>")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},">>=")," v\xe0 b\xe2y gi\u1edd t\u1ea1i sao d\u1eebng c\xe1i th\u1ee9 hai. V\u1ec1 c\u01a1 b\u1ea3n, c\u1ea3 hai \u0111\u1ec1u\ntr\xecnh t\u1ef1 c\xe1c h\xe0nh \u0111\u1ed9ng, nh\u01b0ng ",(0,l.kt)("inlineCode",{parentName:"p"},">>")," kh\xf4ng l\u1ea5y gi\xe1 tr\u1ecb \u0111\u1ea7u m\xfap,con ",(0,l.kt)("inlineCode",{parentName:"p"},">>="),"\ntruy c\u1eadp gi\xe1 tr\u1ecb \u0111\u01b0\u1ee3c bao b\u1ecdc v\xe0 chuy\u1ec3n n\xf3 cho h\xe0nh \u0111\u1ed9ng ti\u1ebfp theo."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'grab\' = endpoint @"grab" >>= grab\n')),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta c\xf3 th\u1ec3 th\u1eed n\xf3 trong s\xe2n ch\u01a1i. Sau khi th\xeam m\xe3 m\u1edbi v\xe0\nnh\u1ea5p v\xe0o ",(0,l.kt)("inlineCode",{parentName:"p"},"Simulate")," b\u1ea1n s\u1ebd nh\u1eadn th\u1ea5y r\u1eb1ng k\u1ecbch b\u1ea3n c\u0169 \u0111\xe3 bi\u1ebfn m\u1ea5t. \u0110\xf3 l\xe0\nb\u1edfi v\xec c\xe1c \u0111i\u1ec3m cu\u1ed1i (Endpoint) \u0111\xe3 thay \u0111\u1ed5i v\xe0 k\u1ecbch b\u1ea3n c\u0169 kh\xf4ng c\xf2n h\u1ee3p\nl\u1ec7."),(0,l.kt)("p",null,"H\xe3y thi\u1ebft l\u1eadp m\u1ed9t k\u1ecbch b\u1ea3n ch\u1ec9 s\u1eed d\u1ee5ng hai v\xed. V\xed m\u1ed9t s\u1ebd cung c\u1ea5p cho 3\nADA oo h\u1ee3p \u0111\u1ed3ng v\xe0 v\xed 2 s\u1ebd c\u1ed1 g\u1eafng l\u1ea5y ch\xfang, nh\u01b0ng l\u1ea7n n\xe0y, v\xed 2 s\u1ebd c\u1ea7n\nchuy\u1ec3n v\xe0o m\u1ed9t gi\xe1 tr\u1ecb s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1ea1o ng\u01b0\u1eddi \u0111\u1ed5i."),(0,l.kt)("p",null,"\u0110\u1ed1i v\u1edbi l\u1ea7n th\u1eed \u0111\u1ea7u ti\xean, ch\xfang t\xf4i s\u1ebd th\xeam gi\xe1 tr\u1ecb ng\u01b0\u1eddi \u0111\u1ed5i sai, trong\ntr\u01b0\u1eddng h\u1ee3p n\xe0y l\xe0 100."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(5744).Z})),(0,l.kt)("p",null,"N\u1ebfu ch\xfang t\xf4i nh\u1ea5p v\xe0o ",(0,l.kt)("inlineCode",{parentName:"p"},"Evaluate"),", ch\xfang ta th\u1ea5y r\u1eb1ng ch\xfang ta ch\u1ec9 c\xf3\nhai giao d\u1ecbch v\xe0 ch\xfang ta th\u1ea5y r\u1eb1ng ADA v\u1eabn c\xf2n trong t\u1eadp l\u1ec7nh, \u0111i\u1ec1u n\xe0y\ncho th\u1ea5y r\u1eb1ng v\xed 2 kh\xf4ng l\u1ea5y \u0111\u01b0\u1ee3c n\xf3."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(8834).Z})),(0,l.kt)("p",null,"C\xe1c s\u1ed1 d\u01b0 cu\u1ed1i c\xf9ng c\u0169ng cho th\u1ea5y \u0111i\u1ec1u n\xe0y."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3793).Z})),(0,l.kt)("p",null,"V\xe0, n\u1ebfu ch\xfang ta nh\xecn v\xe0o d\u1ea5u v\u1ebft, ch\xfang ta s\u1ebd t\xecm ra l\u1ed7i."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.}"},', Slot 2: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\n      Contract instance stopped with error: "WalletError (ValidationError (ScriptFailure (EvaluationError [\\"wrong redeemer\\"])))" ]\n')),(0,l.kt)("p",null,"N\u1ebfu ch\xfang ta quay l\u1ea1i k\u1ecbch b\u1ea3n, thay \u0111\u1ed5i gi\xe1 tr\u1ecb th\xe0nh ",(0,l.kt)("inlineCode",{parentName:"p"},"42")," v\xe0 nh\u1ea5p\n",(0,l.kt)("inlineCode",{parentName:"p"},"Evaluate")," l\u1ea1i, ch\xfang ta s\u1ebd th\u1ea5y r\u1eb1ng x\xe1c th\u1ef1c th\xe0nh c\xf4ng."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(8331).Z})),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta th\u1ea5y giao d\u1ecbch th\u1ee9 ba trong \u0111\xf3 v\xed 2 qu\u1ea3n l\xfd \u0111\u1ec3 thu\nti\u1ec1n, tr\u1eeb \u0111i ph\xed."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3338).Z})),(0,l.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y r\u1eb1ng s\u1ed1 d\u01b0 cu\u1ed1i c\xf9ng l\xe0 nh\u01b0 ch\xfang t\xf4i mong \u0111\u1ee3i v\xe0 c\xe1c b\u1ea3n\nghi c\u0169ng cho th\u1ea5y r\u1eb1ng vi\u1ec7c x\xe1c th\u1ef1c kh\xf4ng g\xe2y ra l\u1ed7i, \u0111i\u1ec1u \u0111\xf3 c\xf3 ngh\u0129a\nl\xe0 qu\xe1 tr\xecnh x\xe1c th\u1ef1c \u0111\xe3 th\xe0nh c\xf4ng."),(0,l.kt)("p",null,"V\xec v\u1eady, \u0111\xf3 l\xe0 v\xed d\u1ee5 \u0111\u1ea7u ti\xean v\u1ec1 tr\xecnh x\xe1c th\u1ef1c xem x\xe9t \xedt nh\u1ea5t m\u1ed9t trong\nc\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a n\xf3."),(0,l.kt)("h3",{id:"v\xed-d\u1ee5-4---typed"},"V\xed d\u1ee5 4 - Typed"),(0,l.kt)("p",null,"N\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf ph\u1ea7n \u0111\u1ea7u c\u1ee7a b\xe0i gi\u1ea3ng, \u0111\xe2y l\xe0 Plutus c\u1ea5p th\u1ea5p v\xe0\ntr\xean th\u1ef1c t\u1ebf, kh\xf4ng ai s\u1ebd vi\u1ebft c\xe1c h\xe0m x\xe1c nh\u1eadn nh\u01b0 th\u1ebf n\xe0y."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta s\u1ebd xem n\xf3 th\u1ef1c s\u1ef1 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 th\u1ebf n\xe0o b\u1eb1ng c\xe1ch\ns\u1eed d\u1ee5ng m\u1ed9t phi\xean b\u1ea3n \u0111\xe3 \u0111\xe1nh m\xe1y."),(0,l.kt)("p",null,"M\u1eb7c d\xf9 ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"n\xe0y m\u1ea1nh m\u1ebd v\xe0 b\u1ea1n c\xf3 th\u1ec3 m\xe3 h\xf3a t\u1ea5t c\u1ea3 c\xe1c lo\u1ea1i d\u1eef\nli\u1ec7u v\xe0o n\xf3, nh\u01b0ng n\xf3 kh\xf4ng th\u1ef1c s\u1ef1 gi\u1ed1ng Haskell. N\xf3 g\u1ea7n gi\u1ed1ng nh\u01b0 b\u1ea1n\n\u0111ang vi\u1ebft b\u1eb1ng m\u1ed9t ng\xf4n ng\u1eef kh\xf4ng \u0111\u1ecbnh ki\u1ec3u nh\u01b0 Javascript ho\u1eb7c Python.\nN\xf3 gi\u1ed1ng nh\u01b0 m\u1ed9t kh\u1ed1i d\u1eef li\u1ec7u, n\xf3 c\xf3 th\u1ec3 ch\u1ee9a b\u1ea5t c\u1ee9 th\u1ee9 g\xec n\xean b\u1ea1n\nkh\xf4ng th\u1ef1c s\u1ef1 c\xf3 b\u1ea5t k\u1ef3 lo\u1ea1i an to\xe0n n\xe0o. B\u1ea1n s\u1ebd lu\xf4n c\u1ea7n ki\u1ec3m tra, v\xed\nd\u1ee5, n\u1ebfu b\u1ea1n \u0111ang mong \u0111\u1ee3i m\u1ed9t s\u1ed1 nguy\xean m\xe0 b\u1ea1n th\u1ef1c s\u1ef1 \u0111\u01b0\u1ee3c cung c\u1ea5p m\u1ed9t\ns\u1ed1 nguy\xean."),(0,l.kt)("p",null,"N\xf3 \u0111\u1eb7c bi\u1ec7t t\u1ec7 v\u1edbi \u0111\u1ed1i s\u1ed1 th\u1ee9 ba, b\u1ed1i c\u1ea3nh. M\u1eb7c d\xf9 th\u1eadt d\u1ec5 d\xe0ng \u0111\u1ec3 t\u01b0\u1edfng\nt\u01b0\u1ee3ng r\u1eb1ng b\u1eb1ng c\xe1ch n\xe0o \u0111\xf3 b\u1ea1n c\xf3 th\u1ec3 m\xe3 h\xf3a m\u1ed9t giao d\u1ecbch v\u1edbi c\xe1c \u0111\u1ea7u\nv\xe0o v\xe0 \u0111\u1ea7u ra c\u1ee7a n\xf3 th\xe0nh ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),", nh\u01b0ng ho\xe0n to\xe0n kh\xf4ng r\xf5 r\xe0ng\n\u0111i\u1ec1u \u0111\xf3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n nh\u01b0 th\u1ebf n\xe0o."),(0,l.kt)("p",null,"Ch\xfang t\xf4i mu\u1ed1n s\u1eed d\u1ee5ng c\xe1c ki\u1ec3u d\u1eef li\u1ec7u c\u1ee5 th\u1ec3 h\u01a1n \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh cho\nph\xf9 h\u1ee3p v\u1edbi logic nghi\u1ec7p v\u1ee5."),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y th\u1ef1c s\u1ef1 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c v\u1edbi c\xe1i g\u1ecdi l\xe0 Typed Validators.\n\u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 ch\xfang ta c\xf3 th\u1ec3 thay th\u1ebf c\xe1c l\u1ea7n xu\u1ea5t hi\u1ec7n ",(0,l.kt)("inlineCode",{parentName:"p"},"Data"),"\ntrong ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator")," ch\u1eef k\xfd b\u1eb1ng c\xe1c ki\u1ec3u ph\xf9 h\u1ee3p h\u01a1n."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Data -> Data -> Data -> ()\n")),(0,l.kt)("p",null,"Trong v\xed d\u1ee5 nh\u1ecf ng\u1edb ng\u1ea9n c\u1ee7a ch\xfang t\xf4i, ch\xfang t\xf4i ho\xe0n to\xe0n b\u1ecf qua\nDatum, v\xec v\u1eady m\u1ed9t lo\u1ea1i ph\xf9 h\u1ee3p h\u01a1n s\u1ebd ch\u1ec9 l\xe0 lo\u1ea1i Unit - ()."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: () -> Data -> Data -> ()\n")),(0,l.kt)("p",null,"\u0110\u1ed1i v\u1edbi redeemer, trong v\xed d\u1ee5 n\xe0y, ch\xfang t\xf4i ch\u1ec9 x\u1eed l\xfd c\xe1c s\u1ed1 nguy\xean, v\xec\nv\u1eady c\xf3 l\u1ebd s\u1ebd h\u1ee3p l\xfd h\u01a1n khi s\u1eed d\u1ee5ng S\u1ed1 nguy\xean thay th\u1ebf.."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: () -> Integer -> Data -> ()\n")),(0,l.kt)("p",null,"\u0110\u1ed1i v\u1edbi context, c\xf3 m\u1ed9t ki\u1ec3u hay h\u01a1n nhi\u1ec1u \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"ScriptContext"),"\n\u0111\u01b0\u1ee3c t\u1ea1o ra ch\xednh x\xe1c cho m\u1ee5c \u0111\xedch n\xe0y."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: () -> Integer -> ScriptContext -> ()\n")),(0,l.kt)("p",null,"Cu\u1ed1i c\xf9ng, ch\xfang t\xf4i \u0111\xe3 \u0111\u1ec1 c\u1eadp r\u1eb1ng h\u01a1i b\u1ea5t th\u01b0\u1eddng khi s\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"()")," l\xe0m\nki\u1ec3u tr\u1ea3 v\u1ec1. T\u1ef1 nhi\xean h\u01a1n nhi\u1ec1u s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"Bool")," \u0111\u1ec3 ch\u1ec9 ra x\xe1c\nth\u1ef1c th\xe0nh c\xf4ng hay th\u1ea5t b\u1ea1i."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: () -> Integer -> ScriptContext -> Bool\n")),(0,l.kt)("p",null,"V\xec v\u1eady, \u0111\xe2y l\xe0 m\u1ed9t c\xe1ch t\u1ed1t h\u01a1n \u0111\u1ec3 vi\u1ebft m\xe3 x\xe1c nh\u1eadn. Hai lo\u1ea1i cu\u1ed1i c\xf9ng\n",(0,l.kt)("inlineCode",{parentName:"p"},"SciprtContext")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Bool"),", nh\u01b0ng hai lo\u1ea1i \u0111\u1ea7u ti\xean c\xf3 th\u1ec3 kh\xe1c nhau t\xf9y\nthu\u1ed9c v\xe0o t\xecnh hu\u1ed1ng."),(0,l.kt)("p",null,"Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, b\xe2y gi\u1edd ch\xfang ta h\xe3y vi\u1ebft l\u1ea1i h\xe0m cho ph\xf9 h\u1ee3p b\u1eb1ng\nc\xe1ch s\u1eed d\u1ee5ng c\xe1c ki\u1ec3u m\u1edbi n\xe0y. Tham s\u1ed1 r b\xe2y gi\u1edd kh\xf4ng c\xf2n l\xe0 ki\u1ec3u\n",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," n\u1eefa- n\xf3 l\xe0 m\u1ed9t ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer"),", v\xec v\u1eady ch\xfang ta c\xf3 th\u1ec3 ch\u1ec9 c\u1ea7n\nki\u1ec3m tra xem n\xf3 b\u1eb1ng 42 thay v\xec ki\u1ec3m tra n\xf3 v\u1edbi m\u1ed9t ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")," \u0111\xe3 x\xe2y\nd\u1ef1ng ."),(0,l.kt)("p",null,"V\xe0, khi ch\xfang ta tr\u1ea3 v\u1ec1 a Bool, ch\xfang ta c\xf3 th\u1ec3 bi\u1ebfn h\xe0m th\xe0nh m\u1ed9t bi\u1ec3u\nth\u1ee9c boolean."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# INLINABLE mkValidator #-}\nmkValidator :: () -> Integer -> ScriptContext -> Bool\nmkValidator _ r _ = r == 42\n")),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y s\u1ebd c\xf3 c\xf9ng m\u1ed9t v\u1ea5n \u0111\u1ec1 m\xe0 ch\xfang t\xf4i \u0111\xe3 g\u1eb7p tr\u01b0\u1edbc \u0111\xf3, trong\ntr\u01b0\u1eddng h\u1ee3p c\xf3 l\u1ed7i, ch\xfang t\xf4i s\u1ebd kh\xf4ng nh\u1eadn \u0111\u01b0\u1ee3c th\xf4ng b\xe1o l\u1ed7i \u0111\u1eb9p. C\xf3\nm\u1ed9t h\xe0m Plutus hay \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"traceIfFalse")," n\xf3 nh\u1eabn ",(0,l.kt)("inlineCode",{parentName:"p"},"String")," v\xe0\n",(0,l.kt)("inlineCode",{parentName:"p"},"Bool")," sau \u0111\xf3 tr\u1ea3 v\u1ec1 ",(0,l.kt)("inlineCode",{parentName:"p"},"Bool"),". N\u1ebfu \u0111\u1ea7u ti\xean ",(0,l.kt)("inlineCode",{parentName:"p"},"Bool")," l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"True"),", th\xec k\u1ebft qu\u1ea3\ns\u1ebd l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"True")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"String")," s\u1ebd b\u1ecf qua. Tuy nhi\xean n\u1ebfu \u0111\u1ea7u ti\xean ",(0,l.kt)("inlineCode",{parentName:"p"},"Bool")," l\xe0\n",(0,l.kt)("inlineCode",{parentName:"p"},"False"),", th\xec k\u1ebft qu\u1ea3 l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"False")," v\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"String")," \u0111\u01b0\u1ee3c ghi l\u1ea1i."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"PlutusTx.Prelude.traceIfFalse\n      :: PlutusTx.Builtins.String -> Bool -> Bool\n")),(0,l.kt)("p",null,"\u0110\xe2y ch\xednh x\xe1c l\xe0 nh\u1eefng g\xec ch\xfang ta c\u1ea7n."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'{-# INLINABLE mkValidator #-}\nmkValidator :: () -> Integer -> ScriptContext -> Bool\nmkValidator _ r _ = traceIfFalse "wrong redeemer" $ r == 42\n')),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y s\u1ebd ch\u01b0a \u0111\u01b0\u1ee3c bi\xean d\u1ecbch v\xec c\xe1c ph\u1ea7n kh\xe1c c\u1ee7a m\xe3 ch\u01b0a \u0111\u01b0\u1ee3c nh\u1eadp\nch\xednh x\xe1c. Ch\xfang t\xf4i c\u1ea7n ph\u1ea3i \u0111i\u1ec1u ch\u1ec9nh b\u1ea3ng n\u1ea5u c\u1ee7a ch\xfang t\xf4i."),(0,l.kt)("p",null,"\u0110\u1ea7u ti\xean, ch\xfang t\xf4i gi\u1edbi thi\u1ec7u m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u gi\u1ea3 m\u1edbi, \u1edf \u0111\xe2y ch\xfang t\xf4i\ng\u1ecdi l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Typed"),", \u0111\u01a1n gi\u1ea3n d\u1ef1a tr\xean t\xean c\u1ee7a t\u1eadp l\u1ec7nh. \u0110\u1ed1i v\u1edbi lo\u1ea1i n\xe0y,\nch\xfang t\xf4i ph\u1ea3i cung c\u1ea5p m\u1ed9t phi\xean b\u1ea3n c\u1ee7a ",(0,l.kt)("inlineCode",{parentName:"p"},"Scripts.ValidatorTypes"),"."),(0,l.kt)("p",null,"M\u1ee5c \u0111\xedch c\u1ee7a tr\u01b0\u1eddng h\u1ee3p n\xe0y l\xe0 khai b\xe1o c\xe1c lo\u1ea1i cho datum v\xe0 redeemer."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data Typed\ninstance Scripts.ValidatorTypes Typed where\n    type instance DatumType Typed = ()\n    type instance RedeemerType Typed = Integer\n")),(0,l.kt)("p",null,"\u0110\xe2y l\xe0 Haskell kh\xe1 n\xe2ng cao, \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 l\u1eadp tr\xecnh m\u1ee9c ki\u1ec3u, nh\u01b0ng c\u0169ng\ngi\u1ed1ng nh\u01b0 Template Haskell m\xe0 ch\xfang ta \u0111\xe3 g\u1eb7p, b\u1ea1n kh\xf4ng th\u1ef1c s\u1ef1 c\u1ea7n\nhi\u1ec3u s\xe2u v\u1ec1 n\xf3 v\xec t\u1ea5t c\u1ea3 c\xe1c script s\u1ebd tu\xe2n theo c\xf9ng m\u1ed9t khu\xf4n m\u1eabu."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta c\u1ea7n bi\xean d\u1ecbch tr\xecnh x\xe1c nh\u1eadn. N\u01a1i tr\u01b0\u1edbc \u0111\xe2y ch\xfang ta \u0111\xe3\ns\u1eed d\u1ee5ng ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidatorScript"),",, b\xe2y gi\u1edd ch\xfang ta s\u1eed d\u1ee5ng m\u1ed9t c\xe1i g\xec \u0111\xf3\n\u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"mkTypedValidator"),", l\u1ea5y ki\u1ec3u d\u1eef li\u1ec7u m\u1edbi c\u1ee7a ch\xfang ta l\xe0m\ntham s\u1ed1 v\xe0 t\u1ea1o ra m\u1ed9t c\xe1i g\xec \u0111\xf3 c\xf3 ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"p"},"TypedValidator"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"typedValidator :: Scripts.TypedValidator Typed\ntypedValidator = Scripts.mkTypedValidator @Typed\n    $$(PlutusTx.compile [|| mkValidator ||])\n    $$(PlutusTx.compile [|| wrap ||])\n  where\n    wrap = Scripts.wrapValidator @() @Integer\n")),(0,l.kt)("p",null,"\u0110i\u1ec1u n\xe0y t\u01b0\u01a1ng t\u1ef1 v\u1edbi m\xe3 ",(0,l.kt)("inlineCode",{parentName:"p"},"mkValidator"),", nh\u01b0ng lo\u1ea1i n\xe0y ch\xfang t\xf4i c\u0169ng\nbi\xean d\u1ecbch m\u1ed9t h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"wrapValidator")," nh\u1eadn ki\u1ec3u d\u1eef li\u1ec7u v\xe0 redeemer."),(0,l.kt)("p",null,"\u0110\u1ec3 \u0111i\u1ec1u n\xe0y ho\u1ea1t \u0111\u1ed9ng, tr\u01b0\u1edbc ti\xean, ch\xfang ta c\u1ea7n th\xeam m\u1ed9t import."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"import qualified Ledger.Typed.Scripts as Scripts\n")),(0,l.kt)("p",null,"Trong v\xed d\u1ee5 n\xe0y, n\xf3 \u0111ang \u0111\u01b0\u1ee3c nh\u1eadp \u0111\u1ee7 \u0111i\u1ec1u ki\u1ec7n v\xe0 s\u1eed d\u1ee5ng ti\u1ec1n t\u1ed1\n",(0,l.kt)("inlineCode",{parentName:"p"},"Scripts")," , nh\u01b0ng \u0111i\u1ec1u n\xe0y l\xe0 t\xf9y \xfd v\xe0 b\u1ea1n c\xf3 th\u1ec3 ch\u1ecdn m\u1ed9t s\u1ed1 c\xe1ch kh\xe1c\n\u0111\u1ec3 tham chi\u1ebfu \u0111\u1ebfn m\xf4-\u0111un."),(0,l.kt)("p",null,"Ch\xfang t\xf4i th\u1ef1c hi\u1ec7n nh\u1eefng thay \u0111\u1ed5i n\xe0y, m\xe3 Haskell s\u1ebd \u0111\u01b0\u1ee3c bi\xean d\u1ecbch v\xe0\nb\xe2y gi\u1edd ch\xfang t\xf4i c\u1ea7n thay \u0111\u1ed5i b\u1ea3n so\u1ea1n th\u1ea3o Haskell M\u1eabu t\u1ea1o ra h\xe0m\n",(0,l.kt)("inlineCode",{parentName:"p"},"validator"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"validator :: Validator\nvalidator = Scripts.validatorScript typedValidator\n")),(0,l.kt)("p",null,"\u1ede \u0111\xe2y ch\xfang t\xf4i \u0111\xe3 s\u1eed d\u1ee5ng h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"validatorScript")," \u0111\u1ec3 t\u1ea1o tr\xecnh x\xe1c th\u1ef1c\nkh\xf4ng \u0111\u1ecbnh ki\u1ec3u t\u1eeb phi\xean b\u1ea3n \u0111\xe3 nh\u1eadp c\u1ee7a ch\xfang t\xf4i."),(0,l.kt)("p",null,"T\u1ea5t nhi\xean, \u0111\u1ec3 c\xf3 \u0111\u01b0\u1ee3c h\xe0m b\u0103m, ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng tr\xecnh x\xe1c th\u1ef1c m\xe0\nch\xfang ta c\xf3 v\xe0 bi\u1ebfn n\xf3 th\xe0nh m\u1ed9t tr\xecnh x\xe1c th\u1ef1c nh\u01b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"ValidatorHash"),"\nch\xfang ta \u0111\xe3 l\xe0m tr\u01b0\u1edbc \u0111\xe2y, nh\u01b0ng c\xf3 m\u1ed9t c\xe1ch tr\u1ef1c ti\u1ebfp h\u01a1n, tr\xf4ng gi\u1ed1ng\nh\u1ec7t nhau, nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p ",(0,l.kt)("inlineCode",{parentName:"p"},"Scripts"),"n\xe0y l\xe0 \u0111\u1ebfn t\u1eeb m\xf4-\u0111un\n",(0,l.kt)("inlineCode",{parentName:"p"},"Ledger.Typed.Scripts")," h\u01a1n l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Ledger.Scripts"),". Phi\xean b\u1ea3n n\xe0y l\u1ea5y tr\u1ef1c\nti\u1ebfp tr\xecnh x\xe1c th\u1ef1c \u0111\xe3 nh\u1eadp."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"valHash :: Ledger.ValidatorHash\nvalHash = Scripts.validatorHash typedValidator\n")),(0,l.kt)("p",null,"\u0110\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh \u0111\u01b0\u1ee3c t\xednh nh\u01b0 tr\u01b0\u1edbc \u0111\xe2y."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"scrAddress :: Ledger.Address\nscrAddress = scriptAddress validator\n")),(0,l.kt)("p",null,"Trong v\xed d\u1ee5 c\u1ef1c k\u1ef3 \u0111\u01a1n gi\u1ea3n n\xe0y, n\xf3 c\xf3 v\u1ebb kh\xf4ng \u0111\xe1ng \u0111\u1ec3 n\u1ed7 l\u1ef1c, nh\u01b0ng\n\u0111\u1ed1i v\u1edbi c\xe1c h\u1ee3p \u0111\u1ed3ng th\u1ef1c t\u1ebf, l\xe0m nh\u01b0 th\u1ebf n\xe0y s\u1ebd t\u1ed1t h\u01a1n nhi\u1ec1u."),(0,l.kt)("p",null,"M\xe3 off-chain g\u1ea7n nh\u01b0 gi\u1ed1ng h\u1ec7t nhau."),(0,l.kt)("p",null,"C\xf3 m\u1ed9t thay \u0111\u1ed5i nh\u1ecf \u0111\u1ed1i v\u1edbi give\u0111i\u1ec3m cu\u1ed1i. M\u1eb7c d\xf9 ch\xfang t\xf4i v\u1eabn ch\u01b0a xem\nx\xe9t chi ti\u1ebft ph\u1ea7n n\xe0y c\u1ee7a m\xe3, nh\u01b0ng c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c thay \u0111\u1ed5i sau."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"let tx = mustPayToTheScript () $ ADA.lovelaceValueOf amount\nledgerTx <- submitTxConstraints inst tx\n")),(0,l.kt)("p",null,"H\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"mustPayToOtherScript")," \u0111\xe3 \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng ",(0,l.kt)("inlineCode",{parentName:"p"},"mustPayToTheScript"),".\n\u0110\xe2y l\xe0 m\u1ed9t script ti\u1ec7n l\u1ee3i cho ph\xe9p ch\xfang ta truy\u1ec1n ch\u1ec9 v\xe0o () v\xec ch\xfang\nta c\xf2n c\u1ea7n ph\u1ea3i x\xe2y d\u1ef1ng m\u1ed9t gi\xe1 tr\u1ecb c\u1ee7a ki\u1ec3u Data. Ch\xfang ta c\u0169ng kh\xf4ng\nc\u1ea7n chuy\u1ec3n m\xe3 b\u0103m t\u1eadp l\u1ec7nh n\u1eefa."),(0,l.kt)("p",null,"H\xe0nh vi c\u1ee7a m\xe3 n\xe0y s\u1ebd gi\u1ed1ng v\u1edbi h\xe0nh vi trong v\xed d\u1ee5 tr\u01b0\u1edbc, v\xec v\u1eady ch\xfang\nt\xf4i s\u1ebd kh\xf4ng xem qua n\xf3 trong s\xe2n ch\u01a1i."),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang t\xf4i s\u1ebd gi\u1ea3i th\xedch c\xe1ch ho\u1ea1t \u0111\u1ed9ng th\u1ef1c s\u1ef1 c\u1ee7a n\xf3. L\xe0m c\xe1ch\nn\xe0o \u0111\u1ec3 Plutus chuy\u1ec3n \u0111\u1ed5i c\xe1c ki\u1ec3u d\u1eef li\u1ec7u t\xf9y ch\u1ec9nh n\xe0y th\xe0nh ki\u1ec3u tri\u1ec3n\nkhai c\u1ea5p th\u1ea5p th\u1ef1c t\u1ebf - Dataki\u1ec3u."),(0,l.kt)("p",null,"Ch\xfang ta c\xf3 th\u1ec3 xem m\xe3 trong m\xf4-\u0111un PlutusTx.IsData.Class ."),(0,l.kt)("p",null,"\u1ede \u0111\xe2y ch\xfang ta th\u1ea5y r\u1eb1ng c\xf3 m\u1ed9t l\u1edbp ki\u1ec3u kh\xe1 \u0111\u01a1n gi\u1ea3n \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a\n\u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"IsData"),"."),(0,l.kt)("p",null,(0,l.kt)("img",{src:e(3338).Z})),(0,l.kt)("p",null,"L\u1edbp n\xe0y cung c\u1ea5p hai ch\u1ee9c n\u0103ng"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"toData")," nh\u1eadn m\u1ed9t gi\xe1 tr\u1ecb v\xe0 chuy\u1ec3n \u0111\u1ed5i n\xf3 th\xe0nh ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"fromData")," nh\u1eadn m\u1ed9t gi\xe1 tr\u1ecb c\u1ee7a ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")," c\u1ed1 g\u1eafng chuy\u1ec3n \u0111\u1ed5i n\xf3\nth\xe0nh m\u1ed9t th\u1ec3 hi\u1ec7n c\u1ee7a ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"li"},"IsData"),". \u0110i\u1ec1u n\xe0y c\xf3 th\u1ec3 kh\xf4ng th\xe0nh\nc\xf4ng v\xec kh\xf4ng ph\u1ea3i t\u1ea5t c\u1ea3 c\xe1c gi\xe1 tr\u1ecb c\u1ee7a ki\u1ec3u ",(0,l.kt)("inlineCode",{parentName:"li"},"Data")," s\u1ebd \u0111\u01b0\u1ee3c chuy\u1ec3n\n\u0111\u1ed5i th\xe0nh ki\u1ec3u \u0111\xedch..")),(0,l.kt)("p",null,"H\xe3y th\u1eed \u0111i\u1ec1u n\xe0y trong REPL."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week02.Typed> import PlutusTx\nPrelude PlutusTx Week02.Typed> import PlutusTx.IsData.Class\nPrelude PlutusTx PlutusTx.IsData.Class Week02.Typed> :i IsData\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i bi\u1ebft \u0111i\u1ec1u \u0111\xf3 ",(0,l.kt)("inlineCode",{parentName:"p"},"()")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," c\u1ea3 hai \u0111\u1ec1u l\xe0 tr\u01b0\u1eddng h\u1ee3p c\u1ee7a\n",(0,l.kt)("inlineCode",{parentName:"p"},"IsData")," v\xec ch\xfang \u0111\xe3 ho\u1ea1t \u0111\u1ed9ng trong v\xed d\u1ee5 c\u1ee7a ch\xfang t\xf4i."),(0,l.kt)("p",null,"H\xe3y chuy\u1ec3n \u0111\u1ed5i ",(0,l.kt)("inlineCode",{parentName:"p"},"Integer")," th\xe0nh ",(0,l.kt)("inlineCode",{parentName:"p"},"Data")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx PlutusTx.IsData.Class Week02.Typed> toData (42 :: Integer)\nI 42\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y r\u1eb1ng \u0111i\u1ec1u n\xe0y \u0111\xe3 \u0111\u01b0\u1ee3c chuy\u1ec3n \u0111\u1ed5i th\xe0nh m\u1ed9t phi\xean b\u1ea3n c\u1ee7a\nki\u1ec3u Data b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng h\xe0m t\u1ea1o I , m\xe0 ch\xfang t\xf4i \u0111\xe3 th\u1ef1c hi\u1ec7n theo\nc\xe1ch th\u1ee7 c\xf4ng tr\u01b0\u1edbc khi ch\xfang t\xf4i s\u1eed d\u1ee5ng x\xe1c th\u1ef1c."),(0,l.kt)("p",null,"B\xe2y gi\u1edd h\xe3y l\xe0m theo c\xe1ch kh\xe1c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx PlutusTx.IsData.Class Week02.Typed> fromData (I 42) :: Maybe Integer\nJust 42\n")),(0,l.kt)("p",null,"Ch\xfang t\xf4i nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t ",(0,l.kt)("inlineCode",{parentName:"p"},"Just 42")," back - ",(0,l.kt)("inlineCode",{parentName:"p"},"Just")," l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Maybe")," t\u1ea1o khi\n",(0,l.kt)("inlineCode",{parentName:"p"},"Maybe")," l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nothing"),"."),(0,l.kt)("p",null,"V\xe0 khi n\xf3 kh\xf4ng th\xe0nh c\xf4ng, khi n\xf3 kh\xf4ng th\u1ec3 chuy\u1ec3n \u0111\u1ed5i sang lo\u1ea1i \u0111\xedch,\nch\xfang ta s\u1ebd l\u1ea5y l\u1ea1i ",(0,l.kt)("inlineCode",{parentName:"p"},"Nothing"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx PlutusTx.IsData.Class Week02.Typed> fromData (List []) :: Maybe Integer\nNothing\n")),(0,l.kt)("p",null,"N\u1ebfu ch\xfang ta ki\u1ec3m tra",(0,l.kt)("inlineCode",{parentName:"p"},"IsData"),". Ch\xfang ta c\xf3 th\u1ec3 th\u1ea5y t\u1ea5t c\u1ea3 c\xe1c ki\u1ec3u m\xe0\nm\u1eabu n\xe0y s\u1ebd ho\u1ea1t \u0111\u1ed9ng cho t\u1ea5t c\u1ea3 c\xe1c ki\u1ec3u l\xe0 ",(0,l.kt)("inlineCode",{parentName:"p"},"IsData")," \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx PlutusTx.IsData.Class Week02.Typed> :i IsData\ntype IsData :: * -> Constraint\nclass IsData a where\n  toData :: a -> Data\n  fromData :: Data -> Maybe a\n  {-# MINIMAL toData, fromData #-}\n        -- Defined in \u2018PlutusTx.IsData.Class\u2019\ninstance IsData a => IsData (Maybe a)\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance (IsData a, IsData b) => IsData (Either a b)\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance IsData Bool\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance (IsData a, IsData b, IsData c, IsData d) =>\n         IsData (a, b, c, d)\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance (IsData a, IsData b, IsData c) => IsData (a, b, c)\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance (IsData a, IsData b) => IsData (a, b)\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance IsData ()\n  -- Defined in \u2018plutus-tx-0.1.0.0:PlutusTx.IsData.Instances\u2019\ninstance IsData a => IsData [a]\n  -- Defined in \u2018PlutusTx.IsData.Class\u2019\ninstance IsData Integer -- Defined in \u2018PlutusTx.IsData.Class\u2019\ninstance (TypeError ...) => IsData Int\n  -- Defined in \u2018PlutusTx.IsData.Class\u2019\ninstance IsData Data -- Defined in \u2018PlutusTx.IsData.Class\u2019\n")),(0,l.kt)("p",null,"\u0110\xe2y v\u1eabn l\xe0 m\u1ed9t danh s\xe1ch kh\xe1 ng\u1eafn v\u1ec1 c\xe1c lo\u1ea1i c\xf3 th\u1ec3. Ch\xfang t\xf4i mu\u1ed1n s\u1eed\nd\u1ee5ng nhi\u1ec1u lo\u1ea1i h\u01a1n th\u1ebf n\xe0y cho d\u1eef li\u1ec7u v\xe0 c\xf4ng c\u1ee5 \u0111\u1ed5i qu\xe0 c\u1ee7a ch\xfang\nt\xf4i."),(0,l.kt)("p",null,"\u0110\u1ec3 l\xe0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\xe0y, th\xf4ng th\u01b0\u1eddng ch\xfang ta c\u1ea7n x\xe1c \u0111\u1ecbnh m\u1ed9t IsDatath\u1ec3\nhi\u1ec7n cho b\u1ea5t k\u1ef3 ki\u1ec3u n\xe0o m\xe0 ch\xfang ta mu\u1ed1n s\u1eed d\u1ee5ng. \u0110i\u1ec1u n\xe0y s\u1ebd cho ph\xe9p\nch\xfang t\xf4i cho tr\xecnh bi\xean d\u1ecbch bi\u1ebft c\xe1ch th\u1ef1c hi\u1ec7n chuy\u1ec3n \u0111\u1ed5i qua l\u1ea1i.\nTuy nhi\xean, \u0111i\u1ec1u n\xe0y m\u1ed9t l\u1ea7n n\u1eefa s\u1ebd r\u1ea5t t\u1ebb nh\u1ea1t v\xec n\xf3 l\xe0 m\u1ed9t qu\xe1 tr\xecnh\nm\xe1y m\xf3c. V\xec v\u1eady, c\xf3 m\u1ed9t c\u01a1 ch\u1ebf trong Plutus th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\xe0y cho ch\xfang\nta."),(0,l.kt)("p",null,"V\xed d\u1ee5 5 - C\xe1c ki\u1ec3u IsData t\xf9y ch\u1ec9nh\n","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~","~"),(0,l.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta h\xe3y n\xf3i v\u1ec1 c\xe1c ki\u1ec3u d\u1eef li\u1ec7u t\xf9y ch\u1ec9nh. H\xe3y x\xe1c \u0111\u1ecbnh m\u1ed9t\nc\xe1i ng\u1edb ng\u1ea9n v\xe0 s\u1eed d\u1ee5ng n\xf3 trong h\xe0m x\xe1c nh\u1eadn c\u1ee7a ch\xfang t\xf4i."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"newtype MySillyRedeemer = MySillyRedeemer Integer\n\nPlutusTx.unstableMakeIsData ''MySillyRedeemer\n\n{-# INLINABLE mkValidator #-}\nmkValidator :: () -> MySillyRedeemer -> ScriptContext -> Bool\nmkValidator () (MySillyRedeemer r) _ = traceIfFalse \"wrong redeemer\" $ r == 42\n")),(0,l.kt)("p",null,"::: {.note}\n::: {.title}\nNote\n:::"),(0,l.kt)("p",null,"Ngo\xe0i ra c\xf2n c\xf3 m\u1ed9t phi\xean b\u1ea3n \u1ed5n \u0111\u1ecbnh c\u1ee7a h\xe0m\nPlutusTx.unstableMakeIsData v\xe0 phi\xean b\u1ea3n \u1ed5n \u0111\u1ecbnh ph\u1ea3i lu\xf4n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng\ntrong m\xe3 s\u1ea3n xu\u1ea5t. S\u1ef1 kh\xe1c bi\u1ec7t gi\u1eefa c\u1ea3 hai l\xe0, trong tr\u01b0\u1eddng h\u1ee3p y\xeau c\u1ea7u\nData nhi\u1ec1u h\u01a1n m\u1ed9t h\xe0m t\u1ea1o, phi\xean b\u1ea3n kh\xf4ng \u1ed5n \u0111\u1ecbnh s\u1ebd kh\xf4ng \u0111\u1ea3m b\u1ea3o,\ngi\u1eefa c\xe1c phi\xean b\u1ea3n Plutus, th\u1ee9 t\u1ef1 c\u1ee7a c\xe1c h\xe0m t\u1ea1o s\u1ebd \u0111\u01b0\u1ee3c gi\u1eef nguy\xean.\n:::"),(0,l.kt)("p",null,"V\xe0 ch\xfang ta c\u1ea7n thay \u0111\u1ed5i m\u1ed9t s\u1ed1 t\u1ea5m boilerplate."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data Typed\ninstance Scripts.ValidatorTypes Typed where\n...\n   type instance RedeemerType Typed = MySillyRedeemer\n\ntypedValidator :: Scripts.TypedValidator Typed\n...\nwhere\n   wrap = Scripts.wrapValidator @() @MySillyRedeemer\n")),(0,l.kt)("p",null,"We also need to change some off-chain code in the ",(0,l.kt)("inlineCode",{parentName:"p"},"grab")," endpoint."),(0,l.kt)("p",null,"Instead of using ",(0,l.kt)("inlineCode",{parentName:"p"},"I r"),", we will use ",(0,l.kt)("inlineCode",{parentName:"p"},"toData (MySillyRedeemer r)"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'grab :: forall w s e. AsContractError e => Integer -> Contract w s e ()\ngrab r = do\n    utxos <- utxoAt scrAddress\n    let orefs   = fst <$> Map.toList utxos\n        lookups = Constraints.unspentOutputs utxos      <>\n                  Constraints.otherScript validator\n        tx :: TxConstraints Void Void\n        tx      = mconcat [mustSpendScriptOutput oref $ Redeemer $ PlutusTx.toData (MySillyRedeemer r) | oref <- orefs]\n    ledgerTx <- submitTxConstraintsWith @Void lookups tx\n    void $ awaitTxConfirmed $ txId ledgerTx\n    logInfo @String $ "collected gifts"\n')),(0,l.kt)("p",null,"N\u1ebfu ch\xfang ta c\u1ed1 g\u1eafng bi\xean d\u1ecbch m\xe3 ngay b\xe2y gi\u1edd, tr\xean d\xf2ng l\u1ec7nh ho\u1eb7c\ntrong s\xe2n ch\u01a1i, ch\xfang ta s\u1ebd g\u1eb7p l\u1ed7i v\xec Plutus kh\xf4ng bi\u1ebft c\xe1ch chuy\u1ec3n \u0111\u1ed5i\nqua l\u1ea1i gi\u1eefa ",(0,l.kt)("inlineCode",{parentName:"p"},"IsData")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"MySillyRedeemer"),"."),(0,l.kt)("p",null,"Ch\xfang t\xf4i c\xf3 th\u1ec3 vi\u1ebft m\u1ed9t v\xed d\u1ee5 c\u1ee7a IsData cho MySillyRedeemer b\u1eb1ng tay.\nNh\u01b0ng, ch\xfang ta kh\xf4ng c\u1ea7n ph\u1ea3i l\xe0m v\u1eady."),(0,l.kt)("p",null,"Thay v\xe0o \u0111\xf3, ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t ch\xfat ph\xe9p thu\u1eadt c\u1ee7a Template\nHaskell."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"PlutusTx.unstableMakeIsData ''MySillyRedeemer\n")),(0,l.kt)("p",null,"T\u1ea1i th\u1eddi \u0111i\u1ec3m bi\xean d\u1ecbch, tr\xecnh bi\xean d\u1ecbch s\u1ebd s\u1eed d\u1ee5ng Template Haskell \u0111\u1ec3\nvi\u1ebft m\u1ed9t IsDatath\u1ec3 hi\u1ec7n cho ch\xfang ta. V\xe0 b\xe2y gi\u1edd, n\xf3 s\u1ebd bi\xean d\u1ecbch."),(0,l.kt)("p",null,"H\xe3y ki\u1ec3m tra n\xf3 trong REPL."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude PlutusTx PlutusTx.IsData.Class> :l src/Week02/IsData.hs\nOk, one module loaded.\nPrelude PlutusTx PlutusTx.IsData.Class Week02.IsData> toData (MySillyRedeemer 42)\nConstr 0 [I 42]\n")),(0,l.kt)("p",null,"N\u1ebfu b\u1ea1n th\u1eed m\xe3 n\xe0y IsData.hs, trong s\xe2n ch\u01a1i, b\u1ea1n s\u1ebd th\u1ea5y r\u1eb1ng n\xf3 ho\u1ea1t\n\u0111\u1ed9ng theo c\xe1ch gi\u1ed1ng nh\u01b0 tr\u01b0\u1edbc \u0111\xe2y."),(0,l.kt)("p",null,"T\xf3m l\u01b0\u1ee3c ","-","-","-","-","-","-","-"),(0,l.kt)("p",null,"Ch\xfang t\xf4i \u0111\xe3 th\u1ea5y m\u1ed9t v\xe0i v\xed d\u1ee5 v\u1ec1 tr\xecnh x\xe1c nh\u1eadn \u0111\u01a1n gi\u1ea3n."),(0,l.kt)("p",null,"Ch\xfang t\xf4i \u0111\xe3 b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t tr\xecnh x\xe1c th\u1ef1c s\u1ebd lu\xf4n th\xe0nh c\xf4ng, ho\xe0n\nto\xe0n b\u1ecf qua c\xe1c l\u1eadp lu\u1eadn c\u1ee7a n\xf3. Sau \u0111\xf3, ch\xfang t\xf4i xem x\xe9t m\u1ed9t tr\xecnh x\xe1c\nth\u1ef1c lu\xf4n kh\xf4ng th\xe0nh c\xf4ng, m\u1ed9t l\u1ea7n n\u1eefa ho\xe0n to\xe0n b\u1ecf qua c\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a\nn\xf3. Sau \u0111\xf3, ch\xfang t\xf4i xem x\xe9t m\u1ed9t c\xf4ng c\u1ee5 ki\u1ec3m tra ng\u01b0\u1eddi mua l\u1ea1i c\u1ee7a n\xf3\n\u0111\u1ec3 ki\u1ec3m tra m\u1ed9t gi\xe1 tr\u1ecb \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh tr\u01b0\u1edbc nh\u1ea5t \u0111\u1ecbnh."),(0,l.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i \u0111\xe3 bi\u1ebfn tr\xecnh x\xe1c th\u1ef1c n\xe0y th\xe0nh m\u1ed9t phi\xean b\u1ea3n \u0111\xe3\nnh\u1eadp, phi\xean b\u1ea3n n\xe0y s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong th\u1ef1c t\u1ebf. \u0110\u1ea7u ti\xean, ch\xfang t\xf4i\ns\u1eed d\u1ee5ng c\xe1c ki\u1ec3u d\u1eef li\u1ec7u t\xedch h\u1ee3p v\xe0 sau \u0111\xf3 ch\xfang t\xf4i xem c\xe1ch ch\xfang t\xf4i\nc\xf3 th\u1ec3 s\u1eed d\u1ee5ng c\xe1c ki\u1ec3u d\u1eef li\u1ec7u t\xf9y ch\u1ec9nh."),(0,l.kt)("p",null,"Ch\xfang t\xf4i v\u1eabn ch\u01b0a xem x\xe9t c\xe1c v\xed d\u1ee5 trong \u0111\xf3 d\u1eef li\u1ec7u ho\u1eb7c b\u1ed1i c\u1ea3nh \u0111\u01b0\u1ee3c\nki\u1ec3m tra, \u0111i\u1ec1u n\xe0y s\u1ebd \u0111\u01b0\u1ee3c y\xeau c\u1ea7u \u0111\u1ec3 c\xf3 c\xe1c v\xed d\u1ee5 th\u1ef1c t\u1ebf h\u01a1n."),(0,l.kt)("p",null,"Ch\xfang ta s\u1ebd xem x\xe9t \u0111i\u1ec1u \u0111\xf3 trong b\xe0i gi\u1ea3ng ti\u1ebfp theo."))}g.isMDXComponent=!0},3592:function(n,t,e){t.Z=e.p+"assets/images/1-5f05ed3c68345659a94e4ed6f7502471.png"},868:function(n,t,e){t.Z=e.p+"assets/images/pic__00024-fc070116d4be973a3ba383b03c005097.png"},8358:function(n,t,e){t.Z=e.p+"assets/images/pic__00025-cb338f1f02e5efb286814c5e7ff077c8.png"},9297:function(n,t,e){t.Z=e.p+"assets/images/pic__00026-fd4fa5d1c6c90705682a40f0802c175f.png"},3027:function(n,t,e){t.Z=e.p+"assets/images/pic__00027-e8009bfb355342d158a40571df197cac.png"},6061:function(n,t,e){t.Z=e.p+"assets/images/pic__00028-66b232b1994c20e6619f4af11449506f.png"},2454:function(n,t,e){t.Z=e.p+"assets/images/pic__00029-2a114f78397694fc83c5e65c55af660a.png"},8100:function(n,t,e){t.Z=e.p+"assets/images/pic__00030-beb4a9a337af2382a2b37dbee182a890.png"},4193:function(n,t,e){t.Z=e.p+"assets/images/pic__00031-3f2f868104960170ff2ddbe80dbf1c0d.png"},8937:function(n,t,e){t.Z=e.p+"assets/images/pic__00032-9f3b4bf174a2262ab7a70932ae78d756.png"},5744:function(n,t,e){t.Z=e.p+"assets/images/pic__00033-2e906ca07048920ceb7b8359ca9c2dcb.png"},8834:function(n,t,e){t.Z=e.p+"assets/images/pic__00034-24c9f7957e25d3fc89ce197500cd9a90.png"},3793:function(n,t,e){t.Z=e.p+"assets/images/pic__00035-921fa0d0ea272d4601e0b224d17ca44c.png"},8331:function(n,t,e){t.Z=e.p+"assets/images/pic__00036-53ad6359b95bf3bf4551234df46cfdb9.png"},3338:function(n,t,e){t.Z=e.p+"assets/images/pic__00037-5c16dde25c9a6d7d6da48a306310e820.png"},3294:function(n,t,e){t.Z=e.p+"assets/images/playground_week2_1-84fa9ef5e0adf20ce81d4328f8f57ab2.png"}}]);