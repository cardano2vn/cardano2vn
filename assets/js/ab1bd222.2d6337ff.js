"use strict";(self.webpackChunkbringscdocs=self.webpackChunkbringscdocs||[]).push([[9139],{3905:function(n,t,e){e.d(t,{Zo:function(){return r},kt:function(){return m}});var a=e(7294);function c(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function h(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,a)}return e}function i(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?h(Object(e),!0).forEach((function(t){c(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function l(n,t){if(null==n)return{};var e,a,c=function(n,t){if(null==n)return{};var e,a,c={},h=Object.keys(n);for(a=0;a<h.length;a++)e=h[a],t.indexOf(e)>=0||(c[e]=n[e]);return c}(n,t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(n);for(a=0;a<h.length;a++)e=h[a],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(c[e]=n[e])}return c}var o=a.createContext({}),g=function(n){var t=a.useContext(o),e=t;return n&&(e="function"==typeof n?n(t):i(i({},t),n)),e},r=function(n){var t=g(n.components);return a.createElement(o.Provider,{value:t},n.children)},u={inlineCode:"code",wrapper:function(n){var t=n.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(n,t){var e=n.components,c=n.mdxType,h=n.originalType,o=n.parentName,r=l(n,["components","mdxType","originalType","parentName"]),p=g(e),m=c,s=p["".concat(o,".").concat(m)]||p[m]||u[m]||h;return e?a.createElement(s,i(i({ref:t},r),{},{components:e})):a.createElement(s,i({ref:t},r))}));function m(n,t){var e=arguments,c=t&&t.mdxType;if("string"==typeof n||c){var h=e.length,i=new Array(h);i[0]=p;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=n,l.mdxType="string"==typeof n?n:c,i[1]=l;for(var g=2;g<h;g++)i[g]=e[g];return a.createElement.apply(null,i)}return a.createElement.apply(null,e)}p.displayName="MDXCreateElement"},1979:function(n,t,e){e.r(t),e.d(t,{frontMatter:function(){return l},metadata:function(){return o},toc:function(){return g},default:function(){return u}});var a=e(7462),c=e(3366),h=(e(7294),e(3905)),i=["components"],l={},o={unversionedId:"dr-lars-lession/week5",id:"dr-lars-lession/week5",isDocsHomePage:!1,title:"Week 05 - Native Tokens",description:"Ghi ch\xfa",source:"@site/docs/dr-lars-lession/week5.md",sourceDirName:"dr-lars-lession",slug:"/dr-lars-lession/week5",permalink:"/docs/dr-lars-lession/week5",editUrl:"https://github.com/cardano2vn/cardanovn-portal/edit/main/docs/dr-lars-lession/week5.md",version:"current",frontMatter:{}},g=[{value:"T\u1ed5ng quat",id:"t\u1ed5ng-quat",children:[]},{value:"Value",id:"value",children:[{value:"Ki\u1ec3u Value",id:"ki\u1ec3u-value",children:[]}]},{value:"Ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n",id:"ch\xednh-s\xe1ch-\u0111\xfac-ti\u1ec1n",children:[]},{value:"V\xed d\u1ee5 1 - Free",id:"v\xed-d\u1ee5-1---free",children:[{value:"On chain",id:"on-chain",children:[]},{value:"Off chain",id:"off-chain",children:[]},{value:"Trong Playground",id:"trong-playground",children:[]},{value:"Th\u1eed nghi\u1ec7m v\u1edbi EmulatorTrace",id:"th\u1eed-nghi\u1ec7m-v\u1edbi-emulatortrace",children:[]}]},{value:"V\xed d\u1ee5 2 - Signed",id:"v\xed-d\u1ee5-2---signed",children:[{value:"On-chain",id:"on-chain-1",children:[]},{value:"Off-chain",id:"off-chain-1",children:[]}]},{value:"NFT - Non-Fungible Tokens",id:"nft---non-fungible-tokens",children:[{value:"V\xed d\u1ee5 3 - NFT",id:"v\xed-d\u1ee5-3---nft",children:[]}]}],r={toc:g};function u(n){var t=n.components,l=(0,c.Z)(n,i);return(0,h.kt)("wrapper",(0,a.Z)({},r,l,{components:t,mdxType:"MDXLayout"}),(0,h.kt)("p",null,"Ghi ch\xfa"),(0,h.kt)("p",null,"\u0110\xe2y l\xe0 phi\xean b\u1ea3n vi\u1ebft c\u1ee7a ",(0,h.kt)("a",{parentName:"p",href:"https://youtu.be/6VbhY162GQA"},"B\xe0i gi\u1ea3ng s\u1ed1 5"),"."),(0,h.kt)("p",null,"Trong b\xe0i gi\u1ea3ng n\xe0y, ch\xfang ta t\xecm hi\u1ec3u v\u1ec1 m\xe3 th\xf4ng b\xe1o g\u1ed1c, ch\xednh s\xe1ch khai th\xe1c v\xe0 NFT."),(0,h.kt)("p",null,"Nh\u1eefng ghi ch\xfa n\xe0y s\u1eed d\u1ee5ng Plutus cam k\u1ebft0c3c310cab61dbff8cbc1998a3678b367be6815a"),(0,h.kt)("h2",{id:"t\u1ed5ng-quat"},"T\u1ed5ng quat"),(0,h.kt)("p",null,"Ch\xfang ta s\u1ebd n\xf3i v\u1ec1 c\xe1ch Plutus h\u1ed7 tr\u1ee3 c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c v\xe0 c\xe1ch x\xe1c \u0111\u1ecbnh c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\xfac v\xe0 \u0111\u1ed1t trong nh\u1eefng \u0111i\u1ec1u ki\u1ec7n n\xe0o. Nh\u01b0ng tr\u01b0\u1edbc khi \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\xf3, h\xe3y c\xf9ng kh\xe1m ph\xe1 xem ",(0,h.kt)("inlineCode",{parentName:"p"},"value")," Cardano c\xf3 \xfd ngh\u0129a g\xec ."),(0,h.kt)("p",null,"Khi ch\xfang ta n\xf3i v\u1ec1 m\xf4 h\xecnh (E) UTxO, ch\xfang ta \u0111\xe3 bi\u1ebft r\u1eb1ng m\u1ed7i UTxO (giao d\u1ecbch ch\u01b0a s\u1eed d\u1ee5ng) \u0111\u1ec1u c\xf3 m\u1ed9t \u0111\u1ecba ch\u1ec9 v\xe0 m\u1ed9t gi\xe1 tr\u1ecb. V\xe0, ch\xfang t\xf4i th\u1ea5y r\u1eb1ng, do \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng sang m\xf4 h\xecnh (E) UTxO, m\u1ed7i UTxO c\u0169ng c\xf3 m\u1ed9t ",(0,h.kt)("inlineCode",{parentName:"p"},"Datum"),". Ch\xfang ta \u0111\xe3 th\u1ea5y c\xe1c v\xed d\u1ee5 v\u1ec1 UTxO nh\u01b0 v\u1eady trong c\xe1c b\xe0i gi\u1ea3ng tr\u01b0\u1edbc."),(0,h.kt)("p",null,"Trong h\u1ea7u h\u1ebft c\xe1c v\xed d\u1ee5 m\xe0 ch\xfang ta \u0111\xe3 th\u1ea5y cho \u0111\u1ebfn nay, gi\xe1 tr\u1ecb ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\xe0 m\u1ed9t gi\xe1 tr\u1ecb Ada, \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 lovelace. Ngo\u1ea1i l\u1ec7 l\xe0 v\xed d\u1ee5 \u0111\u1ea7u ti\xean, t\u1eeb b\xe0i gi\u1ea3ng 1, c\u1ee5 th\u1ec3 l\xe0 v\xed d\u1ee5 ",(0,h.kt)("inlineCode",{parentName:"p"},"English Auction")," . Trong v\xed d\u1ee5 \u0111\xf3, ch\xfang t\xf4i \u0111\xe3 b\xe1n \u0111\u1ea5u gi\xe1 m\u1ed9t NFT. Tuy nhi\xean, NFT ch\u1ec9 \u0111\u01b0\u1ee3c t\u1ea1o ra t\u1eeb kh\xf4ng kh\xed m\u1ecfng trong s\xe2n ch\u01a1i."),(0,h.kt)("p",null,"Tuy nhi\xean, trong chu\u1ed7i kh\u1ed1i Cardano th\u1ef1c, ban \u0111\u1ea7u ch\u1ec9 c\xf3 Ada, kh\xf4ng c\xf3 m\xe3 th\xf4ng b\xe1o g\u1ed1c n\xe0o kh\xe1c. V\xec v\u1eady, b\u1ea1n ph\u1ea3i l\xe0m g\xec \u0111\xf3 \u0111\u1ec3 t\u1ea1o c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c m\u1edbi ho\u1eb7c ghi c\xe1c m\xe3 hi\u1ec7n c\xf3. Trong b\xe0i gi\u1ea3ng n\xe0y, ch\xfang ta s\u1ebd xem c\xe1ch th\u1ef1c hi\u1ec7n \u0111i\u1ec1u \u0111\xf3."),(0,h.kt)("p",null,"Nh\u01b0ng tr\u01b0\u1edbc h\u1ebft h\xe3y n\xf3i v\u1ec1 c\xe1c gi\xe1 tr\u1ecb tr\xean."),(0,h.kt)("h2",{id:"value"},"Value"),(0,h.kt)("p",null,"C\xe1c lo\u1ea1i li\xean quan \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh trong g\xf3i ",(0,h.kt)("inlineCode",{parentName:"p"},"plutus-ledger-api"),". C\xe1c m\xf4-\u0111un quan t\xe2m l\xe0"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"module Plutus.V1.Ledger.Value\nmodule Plutus.V1.Ledger.Ada\n")),(0,h.kt)("h3",{id:"ki\u1ec3u-value"},"Ki\u1ec3u Value"),(0,h.kt)("p",null,(0,h.kt)("inlineCode",{parentName:"p"},"Value")," \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\xe0 map t\u1eeb ",(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol")," t\u1edbi maps. t\u1eeb\n",(0,h.kt)("inlineCode",{parentName:"p"},"TokenName"),"t\u1eeb ",(0,h.kt)("inlineCode",{parentName:"p"},"Integers"),", nghe c\xf3 v\u1ebb h\u01a1i k\u1ef3 c\u1ee5c v\xe0 ph\u1ee9c t\u1ea1p."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"newtype Value = Value { getValue :: Map.Map CurrencySymbol (Map.Map TokenName Integer) }\n    deriving stock (Generic)\n    deriving anyclass (ToJSON, FromJSON, Hashable, NFData)\n    deriving newtype (Serialise, PlutusTx.IsData)\n    deriving Pretty via (PrettyShow Value)\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u \u0111\u1ea7u ti\xean c\u1ea7n l\u01b0u \xfd l\xe0 m\u1ed7i m\xe3 th\xf4ng b\xe1o g\u1ed1c, bao g\u1ed3m c\u1ea3 Ada, \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh b\u1eb1ng hai ph\u1ea7n d\u1eef li\u1ec7u -  ",(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol")," v\xe0\n",(0,h.kt)("inlineCode",{parentName:"p"},"TokenName"),"."),(0,h.kt)("p",null,"M\u1ed9t ",(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol")," l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"newtype")," bao quanh l\xe0 m\u1ed9t ",(0,h.kt)("inlineCode",{parentName:"p"},"ByteString"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"newtype CurrencySymbol = CurrencySymbol { unCurrencySymbol :: Builtins.ByteString }\n    deriving (IsString, Show, Serialise, Pretty) via LedgerBytes\n    deriving stock (Generic)\n    deriving newtype (Haskell.Eq, Haskell.Ord, Eq, Ord, PlutusTx.IsData)\n    deriving anyclass (Hashable, ToJSONKey, FromJSONKey,  NFData)\n")),(0,h.kt)("p",null,"V\xe0 \u0111iww\xf9 n\xe0y c\u0169ng \u0111\xfang v\u1edbi ",(0,h.kt)("inlineCode",{parentName:"p"},"TokenName"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"newtype TokenName = TokenName { unTokenName :: Builtins.ByteString }\n    deriving (Serialise) via LedgerBytes\n    deriving stock (Generic)\n    deriving newtype (Haskell.Eq, Haskell.Ord, Eq, Ord, PlutusTx.IsData)\n    deriving anyclass (Hashable, NFData)\n    deriving Pretty via (PrettyShow TokenName)    \n")),(0,h.kt)("p",null,"Ch\xfang ta c\xf3 hai ",(0,h.kt)("inlineCode",{parentName:"p"},"ByteStrings")," \u0111\u1ecbnh ngh\u0129a l\xe0 coin, ho\u1eb7c n\xf3 c\xf2n \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"asset class"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"assetClass :: CurrencySymbol -> TokenName -> AssetClass\nassetClass s t = AssetClass (s, t)\n")),(0,h.kt)("p",null,"Ada l\xe0 m\u1ed9t l\u1edbp t\xe0i s\u1ea3n v\xe0 c\xe1c Token g\u1ed1c t\xf9y ch\u1ec9nh s\u1ebd l\xe0 c\xe1c l\u1edbp t\xe0i s\u1ea3n kh\xe1c."),(0,h.kt)("p",null,"M\u1ed9t ",(0,h.kt)("inlineCode",{parentName:"p"},"Value")," ch\u1ec9 \u0111\u01a1n gi\u1ea3n cho th\u1ea5y c\xf3 bao nhi\xeau \u0111\u01a1n v\u1ecb t\u1ed3n t\u1ea1i cho m\u1ed9t lo\u1ea1i t\xe0i s\u1ea3n nh\u1ea5t \u0111\u1ecbnh."),(0,h.kt)("p",null,"H\xe3y b\u1eaft \u0111\u1ea7u REPL v\xe0 nh\u1eadp hai m\xf4-\u0111un c\xf3 li\xean quan."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"cabal repl\nPrelude Week05.Free> import Plutus.V1.Ledger.Ada\nPrelude Plutus.V1.Ledger.Ada Week05.Free> import Plutus.V1.Ledger.Value \nPrelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> \nPrelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> :set -XOverloadedStrings\n")),(0,h.kt)("p",null,"Ghi ch\xfa:"),(0,h.kt)("p",null,"Ch\xfang t\xf4i c\u0169ng \u0111\xe3 k\xedch ho\u1ea1t ",(0,h.kt)("inlineCode",{parentName:"p"},"OverloadedStrings")," ti\u1ec7n \xedch m\u1edf r\u1ed9ng. Ch\xfang ta c\xf3 th\u1ec3 \u0111\u01b0a v\xe0o ",(0,h.kt)("inlineCode",{parentName:"p"},"ByteString"),"d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i k\xfd t\u1ef1."),(0,h.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta h\xe3y xem x\xe9t m\u1ed9t s\u1ed1 gi\xe1 tr\u1ecb. H\xe3y b\u1eaft \u0111\u1ea7u v\u1edbi c\xe1c gi\xe1 tr\u1ecb lovelace. T\u01b0\u01a1ng t\u1ef1 ",(0,h.kt)("inlineCode",{parentName:"p"},"Ledger.Ada")," module n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi l\xe0",(0,h.kt)("inlineCode",{parentName:"p"},"adaSymbol"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> :t adaSymbol\nadaSymbol :: CurrencySymbol\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y cho ch\xfang ta k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 c\u1ee7a lo\u1ea1i t\xe0i s\u1ea3n Ada, ch\u1ec9 l\xe0 lo\u1ea1i tr\u1ed1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"ByteString"),". T\u01b0\u01a1ng t\u1ef1, c\xf3 m\u1ed9t h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"adaToken"),", s\u1ebd cung c\u1ea5p cho ch\xfang ta t\xean token."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> :t adaToken\nadaToken :: TokenName\n")),(0,h.kt)("p",null,"M\u1ed9t l\u1ea7n n\u1eefa, \u0111\xe2y c\u0169ng l\xe0 tr\u1ed1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"ByteString"),"."),(0,h.kt)("p",null,"Ch\xfang ta \u0111\xe3 th\u1ea5y tr\u01b0\u1edbc \u0111\xe2y trong c\xe1c v\xed d\u1ee5 v\u1ec1 c\xe1ch t\u1ea1o m\u1ed9t bi\u1ec3u t\u01b0\u1ee3ng c\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"Value")," l\xe0 lovelace. H\xe0m  ",(0,h.kt)("inlineCode",{parentName:"p"},"lovelaceValueOf")," nay v\u1edbi gi\xe1 tr\u1ecb ",(0,h.kt)("inlineCode",{parentName:"p"},"Integer"),", ch\xfang ta \u0111\u01b0a v\xe0o ",(0,h.kt)("inlineCode",{parentName:"p"},"Value"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> :t lovelaceValueOf\nlovelaceValueOf :: Integer -> Value\n")),(0,h.kt)("p",null,"V\xed d\u1ee5 ta \u0111\u01b0a v\xe0o 123 lovelace, Ch\xfang ta c\xf3 th\u1ec3 l\xe0m:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> lovelaceValueOf 123\nValue (Map [(,Map [("",123)])])\n')),(0,h.kt)("p",null,"B\u1ea1n s\u1ebd lu\xf4n s\u1eed d\u1ee5ng m\u1ed9t h\xe0m tr\u1ee3 gi\xfap ch\u1eb3ng h\u1ea1n nh\u01b0 ",(0,h.kt)("inlineCode",{parentName:"p"},"lovelaceValueOf")," \u0111\u1ec3 x\xe2y d\u1ef1ng c\xe1c map gi\xe1 tr\u1ecb - b\u1ea1n s\u1ebd kh\xf4ng bao gi\u1edd c\u1ea7n ph\u1ea3i t\u1ea1o m\u1ed9t map tr\u1ef1c ti\u1ebfp."),(0,h.kt)("p",null,"\u1ede \u0111\xe2y ch\xfang t\xf4i xem map. Map b\xean ngo\xe0i c\u1ee7a c\xe1c k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 c\xf3 m\u1ed9t kh\xf3a, l\xe0 k\xfd hi\u1ec7u tr\u1ed1ng cho Ada v\xe0 b\u1ea3n \u0111\u1ed3 b\xean trong t\xean m\xe3 th\xf4ng b\xe1o c\xf3 m\u1ed9t kh\xf3a, chu\u1ed7i tr\u1ed1ng cho Ada v\xe0 gi\xe1 tr\u1ecb l\xe0 123."),(0,h.kt)("p",null,"OM\u1ed9t \u0111i\u1ec1u ch\xfang ta c\xf3 th\u1ec3 l\xe0m v\u1edbi c\xe1c gi\xe1 tr\u1ecb l\xe0 k\u1ebft h\u1ee3p ch\xfang. C\xe1c l\u1edbp ",(0,h.kt)("inlineCode",{parentName:"p"},"Value")," l\xe0 th\u1ec3 hi\u1ec7n c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Monoid"),", v\xec ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,h.kt)("inlineCode",{parentName:"p"},"mappend"),", n\xf3 c\xf3 th\u1ec3 vi\u1ebft ",(0,h.kt)("inlineCode",{parentName:"p"},"<>"),", xu\u1ea5t ph\xe1t t\u1eeb  super class c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Monoid")," g\u1ecdi l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"Semigroup"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> lovelaceValueOf 123 <> lovelaceValueOf 10\nValue (Map [(,Map [("",133)])])\n')),(0,h.kt)("p",null,"V\xec v\u1eady, l\xe0m th\u1ebf n\xe0o \u0111\u1ec3 ch\xfang ta t\u1ea1o ra ",(0,h.kt)("inlineCode",{parentName:"p"},"Value")," bao g\u1ed3m tokens g\u1ed1c?"),(0,h.kt)("p",null,"C\xf3 m\u1ed9t ch\u1ee9c n\u0103ng r\u1ea5t h\u1eefu \xedch \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"singleton"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Plutus.V1.Ledger.Ada Plutus.V1.Ledger.Value Week05.Free> :t singleton\nsingleton :: CurrencySymbol -> TokenName -> Integer -> Value\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y s\u1ebd t\u1ea1o ra m\u1ed9t  ",(0,h.kt)("inlineCode",{parentName:"p"},"Value")," cho token \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh b\u1edfi ",(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol"),"\nv\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"TokenName"),", v\xe0 cho m\u1ed9t s\u1ed1 ti\u1ec1n nh\u1ea5t \u0111\u1ecbnh ",(0,h.kt)("inlineCode",{parentName:"p"},"Integer"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Week05.Free> singleton "a8ff" "ABC" 7\nValue (Map [(a8ff,Map [("ABC",7)])])\n')),(0,h.kt)("p",null,'\u0110\u1ed1i s\u1ed1 \u0111\u1ea7u ti\u1ec1n l\xe0 \\"a8ff\\" cho ',(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol"),' l\xe0 chu\u1ed7i k\xfd t\u1ef1 m\xe3 hexa value, l\xe0 lyd ro cho n\xf3 r\xf5 r\xe0ng h\u01a1n. \u0110\u1ed1i s\u1ed1 th\u1ee9 2 l\xe0 "ABC" cho ',(0,h.kt)("inlineCode",{parentName:"p"},"TokenName")," c\xf3 th\u1ec3 l\xe0 chuyooix k\xfd t\u1ef1 t\xf9 \xfd."),(0,h.kt)("p",null,"V\xe0, ch\xfang ta c\xf3 th\u1ec3 k\u1ebft h\u1ee3p, nh\u01b0 tr\u01b0\u1edbc \u0111\xe2y to\xe1n t\u1eed ",(0,h.kt)("inlineCode",{parentName:"p"},"mappend"),". B\xe2y gi\u1edd ch\xfang ta c\xf3 th\u1ec3 t\u1ea1o m\u1ed9t map th\xfa v\u1ecb h\u01a1n."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Week05.Free> singleton "a8ff" "ABC" 7 <> lovelaceValueOf 42 <> singleton "a8ff" "XYZ" 100\nValue (Map [(,Map [("",42)]),(a8ff,Map [("ABC",7),("XYZ",100)])])\n')),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang ta th\u1ea5y m\u1ed9t b\u1ea3n \u0111\u1ed3 \u0111\u1ea1i di\u1ec7n cho 42 lovelace c\u0169ng nh\u01b0 hai m\xe3 th\xf4ng b\xe1o ",(0,h.kt)("inlineCode",{parentName:"p"},"ABC")," v\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"XYZ")," c\u1ea3 hai \u0111\u1ec1u thu\u1ed9c v\u1ec1 ",(0,h.kt)("inlineCode",{parentName:"p"},"CurrencySymbol"),' "af88", v\xe0 m\u1ed7i m\xe3 c\xf3 s\u1ed1 nguy\xean t\u01b0\u01a1ng \u1ee9ng.'),(0,h.kt)("p",null,"H\xe3y \u0111\u1eb7t t\xean cho gi\xe1 tr\u1ecb n\xe0y:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Week05.Free> let v = singleton "a8ff" "ABC" 7 <> lovelaceValueOf 42 <> singleton "a8ff" "XYZ" 100\nWeek05.Free> v\nValue (Map [(,Map [("",42)]),(a8ff,Map [("ABC",7),("XYZ",100)])])\n')),(0,h.kt)("p",null,"M\u1ed9t ch\u1ee9c n\u0103ng h\u1eefu \xedch kh\xe1c l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"valueOf")," cho ph\xe9p ch\xfang t\xf4i l\u1ea5y gi\xe1 tr\u1ecb c\u1ee7a m\u1ed9t k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 v\xe0 t\xean m\xe3 th\xf4ng b\xe1o nh\u1ea5t \u0111\u1ecbnh."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Week05.Free> :t valueOf\nvalueOf :: Value -> CurrencySymbol -> TokenName -> Integer\n\nWeek05.Free> valueOf v "a8ff" "XYZ"\n100    \n\nWeek05.Free> valueOf v "a8ff" "ABC"\n7\n\nWeek05.Free> valueOf v "a8ff" "abc"\n0\n')),(0,h.kt)("p",null,"M\u1ed9t ch\u1ee9c n\u0103ng h\u1eefu \xedch l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"flattenValue"),". Nh\u01b0 t\xean cho th\u1ea5y, n\xf3 l\xe0m ph\u1eb3ng b\u1ea3n \u0111\u1ed3 c\u1ee7a c\xe1c b\u1ea3n \u0111\u1ed3 th\xe0nh m\u1ed9t danh s\xe1ch ph\u1eb3ng g\u1ed3m c\xe1c b\u1ed9 ba."),(0,h.kt)("blockquote",null,(0,h.kt)("pre",{parentName:"blockquote"},(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Week05.Free> :t flattenValue\nflattenValue :: Value -> [(CurrencySymbol, TokenName, Integer)]\n\nWeek05.Free> flattenValue v\n[(a8ff,"ABC",7),(a8ff,"XYZ",100),(,"",42)]\n'))),(0,h.kt)("h2",{id:"ch\xednh-s\xe1ch-\u0111\xfac-ti\u1ec1n"},"Ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n"),(0,h.kt)("p",null,"B\xe2y gi\u1edd c\xe2u h\u1ecfi l\xe0 t\u1ea1i sao? T\u1ea1i sao ch\xfang ta c\u1ea7n c\u1ea3 bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 v\xe0 t\xean m\xe3 th\xf4ng b\xe1o? T\u1ea1i sao ch\xfang ta kh\xf4ng ch\u1ec9 s\u1eed d\u1ee5ng m\u1ed9t m\xe3 \u0111\u1ecbnh danh cho m\u1ed9t lo\u1ea1i n\u1ed9i dung? V\xe0 t\u1ea1i sao k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 ph\u1ea3i \u1edf d\u1ea1ng ch\u1eef s\u1ed1 th\u1eadp l\u1ee5c ph\xe2n?"),(0,h.kt)("p",null,"\u0110\xe2y l\xe0 n\u01a1i m\xe0 c\xe1i g\u1ecdi l\xe0 ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n xu\u1ea5t hi\u1ec7n."),(0,h.kt)("p",null,"Quy t\u1eafc l\xe0, n\xf3i chung, m\u1ed9t giao d\u1ecbch kh\xf4ng th\u1ec3 t\u1ea1o ho\u1eb7c x\xf3a m\xe3 th\xf4ng b\xe1o. C\xe1i g\xec v\xe0o c\u0169ng ra, tr\u1eeb ph\xed. Lu\xf4n lu\xf4n c\xf3 m\u1ed9t c\u1ea3m gi\xe1c \u0111\xe1ng y\xeau ph\u1ea3i \u0111\u01b0\u1ee3c tr\u1ea3 b\u1eb1ng m\u1ed7i giao d\u1ecbch. Ph\xed ph\u1ee5 thu\u1ed9c v\xe0o quy m\xf4 c\u1ee7a giao d\u1ecbch v\xe0 s\u1ed1 b\u01b0\u1edbc m\xe0 t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c th\u1ef1c hi\u1ec7n c\u0169ng nh\u01b0 m\u1ee9c ti\xeau th\u1ee5 b\u1ed9 nh\u1edb c\u1ee7a t\u1eadp l\u1ec7nh."),(0,h.kt)("p",null,"Nh\u01b0ng, n\u1ebfu \u0111\xf3 l\xe0 to\xe0n b\u1ed9 c\xe2u chuy\u1ec7n th\xec ch\xfang ta kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 t\u1ea1o ra c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c. V\xe0 \u0111\xe2y l\xe0 l\xfac c\xe1c ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n \u0111\u01b0\u1ee3c \u0111\u01b0a ra, v\xe0 s\u1ef1 li\xean quan c\u1ee7a bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 xu\u1ea5t hi\u1ec7n."),(0,h.kt)("p",null,"L\xfd do m\xe0 k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 ph\u1ea3i bao g\u1ed3m c\xe1c ch\u1eef s\u1ed1 th\u1eadp l\u1ee5c ph\xe2n l\xe0 v\xec n\xf3 th\u1ef1c s\u1ef1 l\xe0 h\xe0m b\u0103m c\u1ee7a m\u1ed9t t\u1eadp l\u1ec7nh. V\xe0 t\u1eadp l\u1ec7nh n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n v\xe0 n\u1ebfu ch\xfang ta c\xf3 m\u1ed9t giao d\u1ecbch m\xe0 ch\xfang ta d\u1ef1 ki\u1ebfn \u200b\u200bt\u1ea1o ho\u1eb7c ghi m\xe3 th\xf4ng b\xe1o g\u1ed1c th\xec \u0111\u1ed1i v\u1edbi m\u1ed7i m\xe3 th\xf4ng b\xe1o g\u1ed1c m\xe0 ch\xfang ta c\u1ed1 g\u1eafng t\u1ea1o ho\u1eb7c \u0111\u1ed1t, k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 s\u1ebd \u0111\u01b0\u1ee3c tra c\u1ee9u. V\xec v\u1eady, t\u1eadp l\u1ec7nh t\u01b0\u01a1ng \u1ee9ng c\u0169ng ph\u1ea3i \u0111\u01b0\u1ee3c ch\u1ee9a trong giao d\u1ecbch. V\xe0 t\u1eadp l\u1ec7nh \u0111\xf3 \u0111\u01b0\u1ee3c th\u1ef1c thi c\xf9ng v\u1edbi c\xe1c t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c kh\xe1c."),(0,h.kt)("p",null,"V\xe0, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 c\xe1c t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c m\xe0 ch\xfang ta \u0111\xe3 th\u1ea5y \u0111\u1ec3 x\xe1c th\u1ef1c \u0111\u1ea7u v\xe0o, m\u1ee5c \u0111\xedch c\u1ee7a c\xe1c t\u1eadp l\u1ec7nh in n\xe0y l\xe0 \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh xem giao d\u1ecbch n\xe0y c\xf3 quy\u1ec1n \u0111\xfac ho\u1eb7c ghi m\xe3 th\xf4ng b\xe1o hay kh\xf4ng. Ada c\u0169ng ph\xf9 h\u1ee3p v\u1edbi k\u1ebf ho\u1ea1ch n\xe0y. H\xe3y nh\u1edb r\u1eb1ng bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 c\u1ee7a Ada ch\u1ec9 l\xe0 m\u1ed9t chu\u1ed7i r\u1ed7ng, kh\xf4ng ph\u1ea3i l\xe0 m\xe3 b\u0103m c\u1ee7a b\u1ea5t k\u1ef3 t\u1eadp l\u1ec7nh n\xe0o. V\xec v\u1eady, kh\xf4ng c\xf3 t\u1eadp l\u1ec7nh n\xe0o b\u0103m th\xe0nh chu\u1ed7i tr\u1ed1ng, v\xec v\u1eady kh\xf4ng c\xf3 t\u1eadp l\u1ec7nh n\xe0o cho ph\xe9p \u0111\xfac ho\u1eb7c \u0111\u1ed1t Ada, c\xf3 ngh\u0129a l\xe0 Ada kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\xfac ho\u1eb7c \u0111\u1ed1t."),(0,h.kt)("p",null,"T\u1ea5t c\u1ea3 Ada t\u1ed3n t\u1ea1i \u0111\u1ebfn t\u1eeb giao d\u1ecbch Genesis v\xe0 t\u1ed5ng s\u1ed1 Ada trong h\u1ec7 th\u1ed1ng l\xe0 c\u1ed1 \u0111\u1ecbnh v\xe0 kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 thay \u0111\u1ed5i. Ch\u1ec9 c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c t\xf9y ch\u1ec9nh m\u1edbi c\xf3 th\u1ec3 c\xf3 c\xe1c ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n t\xf9y ch\u1ec9nh."),(0,h.kt)("p",null,"V\xec v\u1eady, ch\xfang ta s\u1ebd xem x\xe9t m\u1ed9t v\xed d\u1ee5 v\u1ec1 ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n ti\u1ebfp theo v\xe0 s\u1ebd th\u1ea5y r\u1eb1ng n\xf3 r\u1ea5t gi\u1ed1ng v\u1edbi m\u1ed9t t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c, nh\u01b0ng kh\xf4ng gi\u1ed1ng h\u1ec7t nhau."),(0,h.kt)("p",null,"Tr\u01b0\u1edbc khi ch\xfang t\xf4i vi\u1ebft ra ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n \u0111\u1ea7u ti\xean, h\xe3y nh\u1edb l\u1ea1i ng\u1eafn g\u1ecdn c\xe1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a x\xe1c th\u1ef1c."),(0,h.kt)("p",null,"Khi ch\xfang ta kh\xf4ng c\xf3 \u0111\u1ecba ch\u1ec9 kh\xf3a c\xf4ng khai m\xe0 c\xf3 \u0111\u1ecba ch\u1ec9 t\u1eadp l\u1ec7nh v\xe0 UTxO n\u1eb1m t\u1ea1i \u0111\u1ecba ch\u1ec9 \u0111\xf3, th\xec \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 giao d\u1ecbch n\xe0o c\u1ed1 g\u1eafng s\u1eed d\u1ee5ng UTxO \u0111\xf3, m\u1ed9t t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c s\u1ebd \u0111\u01b0\u1ee3c ch\u1ea1y."),(0,h.kt)("p",null,"T\u1eadp l\u1ec7nh x\xe1c th\u1ef1c \u0111\xf3, d\u01b0\u1edbi d\u1ea1ng \u0111\u1ea7u v\xe0o, d\u1eef li\u1ec7u, \u0111\u1ebfn t\u1eeb UTxO, tr\xecnh mua l\u1ea1i, \u0111\u1ebfn t\u1eeb \u0111\u1ea7u v\xe0o v\xe0 ng\u1eef c\u1ea3nh."),(0,h.kt)("p",null,"Nh\u1edb l\u1ea1i r\u1eb1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"ScriptContext")," c\xf3 hai tr\u01b0\u1eddng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data ScriptContext = ScriptContext{scriptContextTxInfo :: TxInfo, scriptContextPurpose :: ScriptPurpose }\n")),(0,h.kt)("p",null,"M\u1ed9t trong nh\u1eefng tr\u01b0\u1eddng \u0111\xf3 l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"ScriptPurpose"),", v\xe0 trong tr\u01b0\u1eddng n\xe0y\nm\u1ecdi th\u1ee9 ch\xfang ta th\u1ea5y cho \u0111\u1ebfn b\xe2y gi\u1edd \u0111\u1ec1u thu\u1ed9c lo\u1ea1i ",(0,h.kt)("inlineCode",{parentName:"p"},"Spending"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data ScriptPurpose\n    = Minting CurrencySymbol\n    | Spending TxOutRef\n    | Rewarding StakingCredential\n    | Certifying DCert\n")),(0,h.kt)("p",null,"Tr\u01b0\u1eddng kh\xe1c l\xe0  ",(0,h.kt)("inlineCode",{parentName:"p"},"TxInfo")," ch\u1ee9a t\u1ea5t c\u1ea3 th\xf4ng tin ng\u1eef c\u1ea3nh v\u1ec1 giao d\u1ecbch."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"-- | A pending transaction. This is the view as seen by validator scripts, so some details are stripped out.\ndata TxInfo = TxInfo\n    { txInfoInputs      :: [TxInInfo] -- ^ Transaction inputs\n    , txInfoInputsFees  :: [TxInInfo]     -- ^ Transaction inputs designated to pay fees\n    , txInfoOutputs     :: [TxOut] -- ^ Transaction outputs\n    , txInfoFee         :: Value -- ^ The fee paid by this transaction.\n    , txInfoForge       :: Value -- ^ The 'Value' forged by this transaction.\n    , txInfoDCert       :: [DCert] -- ^ Digests of certificates included in this transaction\n    , txInfoWdrl        :: [(StakingCredential, Integer)] -- ^ Withdrawals\n    , txInfoValidRange  :: SlotRange -- ^ The valid range for the transaction.\n    , txInfoSignatories :: [PubKeyHash] -- ^ Signatures provided with the transaction, attested that they all signed the tx\n    , txInfoData        :: [(DatumHash, Datum)]\n    , txInfoId          :: TxId\n    -- ^ Hash of the pending transaction (excluding witnesses)\n    } deriving (Generic)\n")),(0,h.kt)("p",null,"\u0110\u1ed1i v\u1edbi c\xe1c ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n, \u0111i\u1ec1u n\xe0y \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t n\u1ebfu ",(0,h.kt)("inlineCode",{parentName:"p"},"txInfoForge")," tr\u01b0\u1eddng c\u1ee7a giao d\u1ecbch ch\u1ee9a gi\xe1 tr\u1ecb kh\xe1c 0. Trong t\u1ea5t c\u1ea3 c\xe1c giao d\u1ecbch m\xe0 ch\xfang t\xf4i \u0111\xe3 th\u1ea5y cho \u0111\u1ebfn nay, gi\xe1 tr\u1ecb tr\u01b0\u1eddng n\xe0y b\u1eb1ng 0 - ch\xfang t\xf4i ch\u01b0a bao gi\u1edd t\u1ea1o ho\u1eb7c ph\xe1 h\u1ee7y b\u1ea5t k\u1ef3 m\xe3 th\xf4ng b\xe1o n\xe0o."),(0,h.kt)("p",null,"N\u1ebfu n\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"is")," kh\xe1c 0, th\xec \u0111\u1ed1i v\u1edbi m\u1ed7i k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 c\xf3 trong ",(0,h.kt)("inlineCode",{parentName:"p"},"Value"),", t\u1eadp l\u1ec7nh ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n t\u01b0\u01a1ng \u1ee9ng s\u1ebd \u0111\u01b0\u1ee3c ch\u1ea1y."),(0,h.kt)("p",null,"Trong khi c\xe1c t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c c\xf3 ba \u0111\u1ea7u v\xe0o - d\u1eef li\u1ec7u, tr\xecnh \u0111\u1ed5i v\xe0 ng\u1eef c\u1ea3nh, c\xe1c t\u1eadp l\u1ec7nh ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n n\xe0y ch\u1ec9 c\xf3 m\u1ed9t \u0111\u1ea7u v\xe0o - ng\u1eef c\u1ea3nh. V\xe0 \u0111\xf3 l\xe0 b\u1ed1i c\u1ea3nh gi\u1ed1ng nh\u01b0 ch\xfang ta \u0111\xe3 c\xf3 tr\u01b0\u1edbc \u0111\xe2y - ",(0,h.kt)("inlineCode",{parentName:"p"},"ScriptContext"),". S\u1ebd kh\xf4ng c\xf3 \xfd ngh\u0129a g\xec n\u1ebfu c\xf3 d\u1eef li\u1ec7u, v\xec n\xf3 thu\u1ed9c v\u1ec1 UTxO v\xe0 s\u1ebd kh\xf4ng c\xf3 \xfd ngh\u0129a g\xec n\u1ebfu c\xf3 ng\u01b0\u1eddi mua l\u1ea1i v\xec n\xf3 thu\u1ed9c v\u1ec1 t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c. Ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n thu\u1ed9c v\u1ec1 b\u1ea3n th\xe2n giao d\u1ecbch, kh\xf4ng ph\u1ea3i \u0111\u1ea7u v\xe0o ho\u1eb7c \u0111\u1ea7u ra c\u1ee5 th\u1ec3."),(0,h.kt)("p",null,"\u0110\u1ed1i v\u1edbi ",(0,h.kt)("inlineCode",{parentName:"p"},"ScriptPurpose"),", \u0111i\u1ec1u n\xe0y s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c ",(0,h.kt)("inlineCode",{parentName:"p"},"Spending")," nh\u01b0 n\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c cho \u0111\u1ebfn b\xe2y gi\u1edd, nh\u01b0ng s\u1ebd l\xe0 Minting."),(0,h.kt)("h2",{id:"v\xed-d\u1ee5-1---free"},"V\xed d\u1ee5 1 - Free"),(0,h.kt)("p",null,"H\xe3y vi\u1ebft m\u1ed9t ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n \u0111\u01a1n gi\u1ea3n."),(0,h.kt)("h3",{id:"on-chain"},"On chain"),(0,h.kt)("p",null,"Khi ch\xfang t\xf4i vi\u1ebft tr\xecnh x\xe1c th\u1ef1c, ch\xfang t\xf4i vi\u1ebft m\xe3 On-chain nh\u01b0 sau:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkValidator :: Datum -> Redeemer -> ScriptContext -> Bool\n")),(0,h.kt)("p",null,"h\xfang t\xf4i c\u0169ng \u0111\xe3 th\u1ea5y phi\xean b\u1ea3n c\u1ea5p th\u1ea5p trong \u0111\xf3 ch\xfang t\xf4i c\xf3 ba \u0111\u1ed1i s\u1ed1 ",(0,h.kt)("inlineCode",{parentName:"p"},"Data")," v\xe0 tr\u1ea3 v\u1ec1 ",(0,h.kt)("inlineCode",{parentName:"p"},"Unit"),". V\xe0 ch\xfang t\xf4i th\u1ea5y r\u1eb1ng c\xf3 th\u1ec3 c\xf3 c\xe1c \u0111\u1ed1i s\u1ed1 b\u1ed5 sung tr\u01b0\u1edbc s\u1ed1 li\u1ec7u, n\u1ebfu ch\xfang t\xf4i vi\u1ebft m\u1ed9t t\u1eadp l\u1ec7nh \u0111\u01b0\u1ee3c tham s\u1ed1 h\xf3a."),(0,h.kt)("p",null,"Ch\xfang ta c\u0169ng c\xf3 th\u1ec3 c\xf3 c\xe1c k\u1ecbch b\u1ea3n ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n \u0111\u01b0\u1ee3c tham s\u1ed1 h\xf3a v\xe0 ch\xfang ta s\u1ebd th\u1ea5y \u0111i\u1ec1u \u0111\xf3 trong m\u1ed9t v\xed d\u1ee5 sau. Nh\u01b0ng tr\u01b0\u1edbc ti\xean ch\xfang ta s\u1ebd xem x\xe9t m\u1ed9t c\xe1i kh\xf4ng \u0111\u01b0\u1ee3c tham s\u1ed1 h\xf3a."),(0,h.kt)("p",null,"\u0110\u1ea7u ti\xean, h\xe3y \u0111\u1ed5i t\xean h\xe0m th\xe0nh ",(0,h.kt)("inlineCode",{parentName:"p"},"mkPolicy"),", x\xf3a ",(0,h.kt)("inlineCode",{parentName:"p"},"Datum")," v\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"Redeemer"),", v\xe0 vi\u1ebft th\xe0nh \u0111\u01a1n gi\u1ea3n nh\u1ea5t m\xe0 ch\xfang ta c\xf3 th\u1ec3.."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkPolicy :: ScriptContext -> Bool\nmkPolicy _ = True\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y b\u1ecf qua context v\xe0 lu\xf4n tr\u1ea3 v\u1ec1 ",(0,h.kt)("inlineCode",{parentName:"p"},"True"),". \u0110i\u1ec1u n\xe0y s\u1ebd cho ph\xe9p \u0111\xfac v\xe0 ghi m\xe3 th\xf4ng b\xe1o t\xf9y \xfd v\xe0 t\xean m\xe3 th\xf4ng b\xe1o thu\u1ed9c v\u1ec1 k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 \u0111\u01b0\u1ee3c li\xean k\u1ebft v\u1edbi ch\xednh s\xe1ch n\xe0y."),(0,h.kt)("p",null,"H\xe3y nh\u1edb r\u1eb1ng, khi ch\xfang t\xf4i vi\u1ebft tr\xecnh x\xe1c th\u1ef1c, ch\xfang t\xf4i c\u1ea7n s\u1eed d\u1ee5ng Template Haskell \u0111\u1ec3 bi\xean d\u1ecbch h\xe0m n\xe0y sang m\xe3 Plutus. Ch\xfang t\xf4i c\u1ea7n l\xe0m \u0111i\u1ec1u g\xec \u0111\xf3 t\u01b0\u01a1ng t\u1ef1 cho ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n c\u1ee7a m\xecnh."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"policy :: Scripts.MonetaryPolicy\npolicy = mkMonetaryPolicyScript $$(PlutusTx.compile [|| Scripts.wrapMonetaryPolicy mkPolicy ||])\n")),(0,h.kt)("p",null,"V\xe0, nh\u01b0 tr\u01b0\u1edbc \u0111\xe2y, ch\xfang ta c\u1ea7n t\u1ea1o h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"mkPolicy")," v\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"INLINABLE"),",v\xec m\u1ecdi th\u1ee9 trong ngo\u1eb7c Oxford {} c\u1ea7n ph\u1ea3i c\xf3 s\u1eb5n t\u1ea1i th\u1eddi \u0111i\u1ec3m bi\xean d\u1ecbch."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"{-# INLINABLE mkPolicy #-}\nmkPolicy :: ScriptContext -> Bool\nmkPolicy _ = True\n")),(0,h.kt)("p",null,"B\xe2y gi\u1edd ch\xfang t\xf4i c\xf3 m\u1ed9t ch\xednh s\xe1ch, ch\xfang t\xf4i c\xf3 th\u1ec3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 t\u1eeb ch\xednh s\xe1ch."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"curSymbol :: CurrencySymbol\ncurSymbol = scriptCurrencySymbol policy\n")),(0,h.kt)("p",null,"V\xe0, ch\xfang ta c\xf3 th\u1ec3 xem x\xe9t \u0111i\u1ec1u n\xe0y trong REPL:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.Free> curSymbol\ne01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf\n")),(0,h.kt)("p",null,"V\xe0 \u0111i\u1ec1u n\xe0y ho\xe0n th\xe0nh ph\u1ea7n on-chain, cho vi\u1ec7c \u0111\xfac ti\u1ec1n \u0111\u01a1n gi\u1ea3n n\xe0y. Nh\u01b0ng \u0111\u1ec3 d\xf9ng th\u1eed v\xe0 t\u01b0\u01a1ng t\xe1c v\u1edbi n\xf3, ch\xfang ta c\u1ea7n m\u1ed9t ph\u1ea7n off-chain."),(0,h.kt)("h3",{id:"off-chain"},"Off chain"),(0,h.kt)("p",null,"Ph\u1ea7n off-chain n\xean l\xe0m g\xec? Ch\xe0, n\xf3 s\u1ebd cho ph\xe9p c\xe1c v\xed t\xf9y \xfd \u0111\xfac v\xe0 \u0111\u1ed1t c\xe1c m\xe3 th\xf4ng b\xe1o c\u1ee7a bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 n\xe0y."),(0,h.kt)("p",null,"Ch\xfang t\xf4i c\xf3 bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7, v\xec v\u1eady \u0111i\u1ec1u c\xf2n thi\u1ebfu l\xe0 t\xean m\xe3 th\xf4ng b\xe1o v\xe0 s\u1ed1 ti\u1ec1n ch\xfang t\xf4i mu\u1ed1n \u0111\xfac ho\u1eb7c \u0111\u1ed1t. V\xe0 \u0111\u1ed1i v\u1edbi \u0111i\u1ec1u n\xe0y, ch\xfang t\xf4i s\u1ebd x\xe1c \u0111\u1ecbnh m\u1ed9t ki\u1ec3u d\u1eef li\u1ec7u ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"data MintParams = MintParams\n    { mpTokenName :: !TokenName\n    , mpAmount    :: !Integer\n    } deriving (Generic, ToJSON, FromJSON, ToSchema)    \n")),(0,h.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y hai tr\u01b0\u1eddng - ",(0,h.kt)("inlineCode",{parentName:"p"},"mpTokenName")," and ",(0,h.kt)("inlineCode",{parentName:"p"},"mpAmount"),". \xdd t\u01b0\u1edfng l\xe0 n\u1ebfu gi\xe1 tr\u1ecb ",(0,h.kt)("inlineCode",{parentName:"p"},"mpAmount")," l\xe0 D\u01b0\u01a1ng, ch\xfang ta n\xean t\u1ea1o m\xe3 th\xf4ng b\xe1o, v\xe0 n\u1ebfu n\xf3 l\xe0 \xc2m, ch\xfang ta n\xean \u0111\u1ed1t m\xe3 th\xf4ng b\xe1o."),(0,h.kt)("p",null,"B\u01b0\u1edbc ti\u1ebfp theo l\xe0 x\xe1c \u0111\u1ecbnh l\u01b0\u1ee3c \u0111\u1ed3. Nh\u1edb l\u1ea1i r\u1eb1ng m\u1ed9t trong nh\u1eefng tham s\u1ed1 c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Contact")," monad l\xe0 l\u01b0\u1ee3c \u0111\u1ed3 x\xe1c \u0111\u1ecbnh c\xe1c h\xe0nh \u0111\u1ed9ng c\xf3 s\u1eb5n m\xe0 ch\xfang ta c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'type FreeSchema =\n    BlockchainActions\n        .\\/ Endpoint "mint" MintParams\n')),(0,h.kt)("p",null,"Nh\u01b0 m\u1ecdi khi, ch\xfang ta c\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"BlockchainActions")," cung c\u1ea5p cho ch\xfang t\xf4i quy\u1ec1n truy c\u1eadp v\xe0o nh\u1eefng th\u1ee9 chung chung nh\u01b0 l\u1ea5y kh\xf3a c\xf4ng khai c\u1ee7a ri\xeang b\u1ea1n. V\xe0 \u1edf \u0111\xe2y, ch\xfang t\xf4i \u0111\xe3 th\xeam m\u1ed9t \u0111i\u1ec3m cu\u1ed1i ",(0,h.kt)("inlineCode",{parentName:"p"},"mint")," b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng to\xe1n t\u1eed c\u1ea5p ki\u1ec3u m\xe0 ch\xfang t\xf4i \u0111\xe3 th\u1ea5y tr\u01b0\u1edbc \u0111\xe2y."),(0,h.kt)("p",null,"V\xec v\u1eady, b\xe2y gi\u1edd ch\xfang ta c\xf3 th\u1ec3 xem x\xe9t b\u1ea3n h\u1ee3p \u0111\u1ed3ng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mint :: MintParams -> Contract w FreeSchema Text ()\n")),(0,h.kt)("p",null,"Trong qu\xe1 kh\u1ee9, ch\xfang t\xf4i \u0111\xe3 kh\xf4ng \u0111i s\xe2u v\xe0o chi ti\u1ebft v\u1ec1 ph\u1ea7n ngo\xe0i chu\u1ed7i c\u1ee7a h\u1ee3p \u0111\u1ed3ng. Nh\u01b0ng, nh\u01b0 b\xe2y gi\u1edd ch\xfang ta \u0111\xe3 bi\u1ebft v\u1ec1 ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract monad"),"   t\u1eeb b\xe0i gi\u1ea3ng tr\u01b0\u1edbc, ch\xfang ta \u0111\xe3 s\u1eb5n s\xe0ng \u0111i v\xe0o chi ti\u1ebft h\u01a1n nhi\u1ec1u."),(0,h.kt)("p",null,"Nh\u1edb l\u1ea1i r\u1eb1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," monad Nh\u1eadn 4 tham s\u1ed1."),(0,h.kt)("p",null,"\u0110\u1ea7u ti\xean l\xe0 \u0111\u01a1n nguy\xean c\u1ee7a ng\u01b0\u1eddi vi\u1ebft cho ph\xe9p ch\xfang ta s\u1eed d\u1ee5ng m\u1ed9t h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"tell"),". B\u1eb1ng c\xe1ch \u0111\u1ec3 tham s\u1ed1 n\xe0y b\u1eb1ng m\u1ed9t s\u1ed1 nh\u1ecf w, ch\xfang t\xf4i ch\u1ec9 ra r\u1eb1ng ch\xfang t\xf4i s\u1ebd kh\xf4ng s\u1eed d\u1ee5ng tham s\u1ed1 n\xe0y - ch\xfang t\xf4i s\u1ebd kh\xf4ng c\xf3 h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"tell")," v\u1edbi b\u1ea5t k\u1ef3 tr\u1ea1ng th\xe1i n\xe0o."),(0,h.kt)("p",null,"Tham s\u1ed1 ti\u1ebfp theo l\xe0 l\u01b0\u1ee3c \u0111\u1ed3 m\xe0 ch\xfang ta v\u1eeba th\u1ea3o lu\u1eadn. Nh\u01b0 \u0111\xe3 l\u01b0u \xfd \u1edf tr\xean, b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng, ",(0,h.kt)("inlineCode",{parentName:"p"},"FreeSchema"),"ch\xfang t\xf4i c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o c\xe1c h\xe0nh \u0111\u1ed9ng chu\u1ed7i kh\u1ed1i th\xf4ng th\u01b0\u1eddng, c\u0169ng nh\u01b0 endpoint",(0,h.kt)("inlineCode",{parentName:"p"},"mint")," ."),(0,h.kt)("p",null,"Tham s\u1ed1 th\u1ee9 ba l\xe0 lo\u1ea1i th\xf4ng b\xe1o l\u1ed7i, v\xe0 nh\u01b0 ch\xfang ta \u0111\xe3 th\u1ea5y, ",(0,h.kt)("inlineCode",{parentName:"p"},"Text")," th\u01b0\u1eddng l\xe0 m\u1ed9t l\u1ef1a ch\u1ecdn t\u1ed1t."),(0,h.kt)("p",null,"Cu\u1ed1i c\xf9ng, tham s\u1ed1 cu\u1ed1i c\xf9ng l\xe0 ki\u1ec3u tr\u1ea3 v\u1ec1, v\xe0 h\u1ee3p \u0111\u1ed3ng c\u1ee7a ch\xfang ta s\u1ebd ch\u1ec9 c\xf3 ki\u1ec3u tr\u1ea3 v\u1ec1 Unit."),(0,h.kt)("p",null,"B\xe2y gi\u1edd ph\u1ea7n th\xe2n h\xe0m, nh\u01b0 l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"Contact")," l\xe0 m\u1ed9t monad, Ch\xfang ta c\xf3 th\u1ec3 s\u1eed s\xf9ng",(0,h.kt)("inlineCode",{parentName:"p"},"do"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mint mp = do\n    let val     = Value.singleton curSymbol (mpTokenName mp) (mpAmount mp)\n        lookups = Constraints.monetaryPolicy policy\n        tx      = Constraints.mustForgeValue val\n    ledgerTx <- submitTxConstraintsWith @Void lookups tx\n    void $ awaitTxConfirmed $ txId ledgerTx\n    Contract.logInfo @String $ printf "forged %s" (show val)\n')),(0,h.kt)("p",null,"\u0110i\u1ec1u \u0111\u1ea7u ti\xean m\xe0 ch\xfang t\xf4i x\xe1c \u0111\u1ecbnh l\xe0 gi\xe1 tr\u1ecb m\xe0 ch\xfang t\xf4i mu\u1ed1n r\xe8n luy\u1ec7n. \u0110\u1ed1i v\u1edbi \u0111i\u1ec1u n\xe0y, ch\xfang t\xf4i \u0111ang s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"singleton")," m\xe0 ch\xfang t\xf4i \u0111\xe3 th\u1eed trong REPL tr\u01b0\u1edbc \u0111\xf3."),(0,h.kt)("p",null,"C\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"singleton"),"  l\xe0 k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 \u0111\u1ea1i di\u1ec7n cho h\xe0m b\u0103m c\u1ee7a ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n, c\u1ed9ng v\u1edbi t\xean m\xe3 th\xf4ng b\xe1o v\xe0 s\u1ed1 ti\u1ec1n \u0111\u01b0\u1ee3c tr\xedch xu\u1ea5t t\u1eeb ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams"),"."),(0,h.kt)("p",null,"b\xe2y gi\u1edd Ch\xfang ta s\u1ebd t\u1ea1m th\u1eddi b\u1ecf qua \u0111\u1ed1i s\u1ed1 ",(0,h.kt)("inlineCode",{parentName:"p"},"lookups")," ,v\xe0 chuy\u1ec3n sang \u0111\u1ed1i s\u1ed1 ",(0,h.kt)("inlineCode",{parentName:"p"},"tx"),"."),(0,h.kt)("p",null,"M\u1ed9t trong nh\u1eefng m\u1ee5c \u0111\xedch ch\xednh c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," monad l\xe0 x\xe2y d\u1ef1ng v\xe0 g\u1eedi c\xe1c giao d\u1ecbch. Con \u0111\u01b0\u1eddng m\xe0 nh\xf3m Plutus \u0111\xe3 th\u1ef1c hi\u1ec7n l\xe0 cung c\u1ea5p m\u1ed9t c\xe1ch \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh c\xe1c r\xe0ng bu\u1ed9c c\u1ee7a giao d\u1ecbch m\xe0 b\u1ea1n \u0111ang x\xe1c \u0111\u1ecbnh. Sau \u0111\xf3, c\xe1c th\u01b0 vi\u1ec7n Plutus s\u1ebd \u0111\u1ea3m nh\u1eadn vi\u1ec7c x\xe2y d\u1ef1ng giao d\u1ecbch ch\xednh x\xe1c (n\u1ebfu c\xf3 th\u1ec3). \u0110i\u1ec1u n\xe0y tr\xe1i ng\u01b0\u1ee3c v\u1edbi vi\u1ec7c y\xeau c\u1ea7u ch\u1ec9 \u0111\u1ecbnh t\u1ea5t c\u1ea3 c\xe1c \u0111\u1ea7u v\xe0o v\xe0 \u0111\u1ea7u ra theo c\xe1ch th\u1ee7 c\xf4ng, \u0111i\u1ec1u n\xe0y s\u1ebd r\u1ea5t t\u1ebb nh\u1ea1t v\xec nhi\u1ec1u y\xeau c\u1ea7u, ch\u1eb3ng h\u1ea1n nh\u01b0 g\u1eedi ti\u1ec1n l\u1ebb tr\u1edf l\u1ea1i v\xed g\u1eedi, th\u01b0\u1eddng gi\u1ed1ng nhau."),(0,h.kt)("p",null,"C\xe1c \u0111i\u1ec1u ki\u1ec7n n\xe0y \u0111\u1ec1u c\xf3 t\xean b\u1eaft \u0111\u1ea7u b\u1eb1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"must"),". C\xf3 nh\u1eefng th\u1ee9 nh\u01b0 ",(0,h.kt)("inlineCode",{parentName:"p"},"mustSpendScriptOutput"),", ",(0,h.kt)("inlineCode",{parentName:"p"},"mustPayToPublicKey")," v\xe0 t\u1ea5t c\u1ea3 c\xe1c lo\u1ea1i \u0111i\u1ec1u ki\u1ec7n c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1eb7t v\xe0o m\u1ed9t \u0111i\u1ec1u ki\u1ec7n."),(0,h.kt)("p",null,"Trong v\xed d\u1ee5 c\u1ee7a ch\xfang t\xf4i, ch\xfang t\xf4i \u0111ang s\u1eed d\u1ee5ng ",(0,h.kt)("inlineCode",{parentName:"p"},"mustForgeValue")," v\xe0 ch\xfang t\xf4i chuy\u1ec3n n\xf3 v\xe0o gi\xe1 tr\u1ecb \u0111\xe3 \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh tr\u01b0\u1edbc \u0111\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"val"),". K\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c gi\u1ea3 m\u1ea1o c\xe1c m\xe3 th\xf4ng b\xe1o \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh ",(0,h.kt)("inlineCode",{parentName:"p"},"val")," l\xe0 ch\xfang s\u1ebd k\u1ebft th\xfac trong v\xed c\u1ee7a ch\xednh ch\xfang ta."),(0,h.kt)("p",null,"Khi c\xe1c \u0111i\u1ec1u ki\u1ec7n \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh, b\u1ea1n c\u1ea7n g\u1ecdi m\u1ed9t h\xe0m \u0111\u1ec3 g\u1eedi giao d\u1ecbch. C\xf3 r\u1ea5t nhi\u1ec1u ch\u1ee9c n\u0103ng nh\u01b0 v\u1eady, nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, ch\u1ee9c n\u0103ng th\xedch h\u1ee3p l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith"),"."),(0,h.kt)("p",null,"T\u1ea5t c\u1ea3 c\xe1c h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTx")," \u0111\u1ec1u nh\u1eadn c\xe1c \u0111i\u1ec1u ki\u1ec7n khai b\xe1o n\xe0y m\xe0 giao d\u1ecbch ph\u1ea3i th\u1ecfa m\xe3n, v\xe0 sau \u0111\xf3 ch\xfang c\u1ed1 g\u1eafng x\xe2y d\u1ef1ng m\u1ed9t giao d\u1ecbch \u0111\xe1p \u1ee9ng c\xe1c \u0111i\u1ec1u ki\u1ec7n \u0111\xf3. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\xfang t\xf4i, \u0111i\u1ec1u ki\u1ec7n duy nh\u1ea5t l\xe0 ch\xfang t\xf4i mu\u1ed1n gi\u1ea3 m\u1ea1o gi\xe1 tr\u1ecb."),(0,h.kt)("p",null,"V\xec v\u1eady, nh\u1eefng g\xec ph\u1ea3i l\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith")," \u0111\u1ec3 t\u1ea1o ra m\u1ed9t giao d\u1ecbch h\u1ee3p l\u1ec7? V\xed d\u1ee5, n\xf3 ph\u1ea3i c\xe2n b\u1eb1ng c\xe1c \u0111\u1ea7u v\xe0o v\xe0 \u0111\u1ea7u ra. Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, v\xec ch\xfang t\xf4i lu\xf4n c\xf3 ph\xed giao d\u1ecbch, ch\xfang t\xf4i c\u1ea7n th\xf4ng tin \u0111\u1ea7u v\xe0o bao g\u1ed3m ph\xed giao d\u1ecbch. V\xec v\u1eady, \u0111\u1ec3 t\u1ea1o giao d\u1ecbch, h\xe0m s\u1ebd xem x\xe9t c\xe1c UTxO c\u1ee7a ch\xednh ch\xfang ta v\xe0 t\xecm m\u1ed9t ho\u1eb7c nhi\u1ec1u UTxO c\xf3 th\u1ec3 bao tr\u1ea3 ph\xed giao d\u1ecbch v\xe0 s\u1eed d\u1ee5ng ch\xfang l\xe0m \u0111\u1ea7u v\xe0o cho giao d\u1ecbch."),(0,h.kt)("p",null,"H\u01a1n n\u1eefa, n\u1ebfu ch\xfang ta \u0111ang gi\u1ea3 m\u1ea1o gi\xe1 tr\u1ecb (n\u1ebfu ",(0,h.kt)("inlineCode",{parentName:"p"},"mpAmount")," l\xe0 gi\xe1 tr\u1ecb d\u01b0\u01a1ng), th\xec gi\xe1 tr\u1ecb \u0111\xf3 ph\u1ea3i \u0111i \u0111\xe2u \u0111\xf3. Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith"),", s\u1ebd t\u1ea1o m\u1ed9t \u0111\u1ea7u ra g\u1eedi gi\xe1 tr\u1ecb m\u1edbi \u0111\u01b0\u1ee3c \u0111\xfac \u0111\u1ebfn v\xed c\u1ee7a ch\xednh ch\xfang ta."),(0,h.kt)("p",null,"M\u1eb7t kh\xe1c, n\u1ebfu ch\xfang t\xf4i \u0111\u1ed1t c\xe1c m\xe3 th\xf4ng b\xe1o (n\u1ebfu ",(0,h.kt)("inlineCode",{parentName:"p"},"mpAmount")," l\xe0 s\u1ed1 \xe2m), th\xec c\xe1c m\xe3 th\xf4ng b\xe1o \u0111\xf3 ph\u1ea3i \u0111\u1ebfn t\u1eeb m\u1ed9t n\u01a1i n\xe0o \u0111\xf3. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\xf3, h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith")," s\u1ebd t\xecm m\u1ed9t \u0111\u1ea7u v\xe0o trong v\xed c\u1ee7a ch\xednh ch\xfang ta \u0111\u1ec3 l\u1ea5y c\xe1c m\xe3 th\xf4ng b\xe1o."),(0,h.kt)("p",null,"Ch\u1ee9c n\u0103ng g\u1eedi c\u0169ng c\xf3 th\u1ec3 kh\xf4ng th\xe0nh c\xf4ng. V\xed d\u1ee5, n\u1ebfu ch\xfang ta mu\u1ed1n thanh to\xe1n cho ai \u0111\xf3, nh\u01b0ng ch\xfang ta kh\xf4ng c\xf3 \u0111\u1ee7 ti\u1ec1n trong v\xed, n\xf3 s\u1ebd kh\xf4ng th\xe0nh c\xf4ng. Ho\u1eb7c, n\u1ebfu ch\xfang t\xf4i y\xeau c\u1ea7u ghi c\xe1c m\xe3 th\xf4ng b\xe1o m\xe0 ch\xfang t\xf4i kh\xf4ng c\xf3, n\xf3 c\u0169ng s\u1ebd th\u1ea5t b\u1ea1i. Khi kh\xf4ng th\xe0nh c\xf4ng, m\u1ed9t ngo\u1ea1i l\u1ec7 s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a ra, v\u1edbi m\u1ed9t th\xf4ng b\xe1o l\u1ed7i thu\u1ed9c ki\u1ec3u ",(0,h.kt)("inlineCode",{parentName:"p"},"Text"),"."),(0,h.kt)("p",null,"B\xe2y gi\u1edd, tr\u1edf l\u1ea1i ",(0,h.kt)("inlineCode",{parentName:"p"},"lookups"),".  \u0110\u1ec3 \u0111\xe1p \u1ee9ng c\xe1c \u0111i\u1ec1u ki\u1ec7n trong h\xe0m\n",(0,h.kt)("inlineCode",{parentName:"p"},"mustForgeValue"),", \u0111\xf4i khi th\u01b0 vi\u1ec7n c\u1ea7n th\xeam th\xf4ng tin. Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, \u0111\u1ec3 x\xe1c th\u1ef1c m\u1ed9t giao d\u1ecbch gi\u1ea3 m\u1ea1o gi\xe1 tr\u1ecb, c\xe1c n\xfat x\xe1c th\u1ef1c giao d\u1ecbch ph\u1ea3i ch\u1ea1y t\u1eadp l\u1ec7nh ch\xednh s\xe1ch."),(0,h.kt)("p",null,"Tuy nhi\xean, k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 ch\u1ec9 l\xe0 m\xe3 b\u0103m c\u1ee7a t\u1eadp l\u1ec7nh ch\xednh s\xe1ch. \u0110\u1ec3 t\u1ef1 ch\u1ea1y t\u1eadp l\u1ec7nh, n\xf3 ph\u1ea3i \u0111\u01b0\u1ee3c bao g\u1ed3m trong giao d\u1ecbch. C\xf3 ngh\u0129a l\xe0, trong b\u01b0\u1edbc x\xe2y d\u1ef1ng c\u1ee7a giao d\u1ecbch, khi thu\u1eadt to\xe1n nh\xecn th\u1ea5y r\xe0ng bu\u1ed9c ",(0,h.kt)("inlineCode",{parentName:"p"},"mustForgeValue"),",  n\xf3 bi\u1ebft r\u1eb1ng n\xf3 ph\u1ea3i \u0111\xednh k\xe8m t\u1eadp l\u1ec7nh ch\xednh s\xe1ch t\u01b0\u01a1ng \u1ee9ng v\xe0o giao d\u1ecbch."),(0,h.kt)("p",null,"\u0110\u1ec3 cho thu\u1eadt to\xe1n bi\u1ebft t\u1eadp l\u1ec7nh ch\xednh s\xe1ch \u1edf \u0111\xe2u, ch\xfang t\xf4i c\xf3 th\u1ec3 \u0111\u01b0a ra c\xe1c g\u1ee3i \xfd v\xe0 \u0111\xe2y l\xe0 c\xe1c b\u1ea3n tra c\u1ee9u. C\xf3 th\u1ec3 s\u1eed d\u1ee5ng nhi\u1ec1u c\xe1ch tra c\u1ee9u kh\xe1c nhau - b\u1ea1n c\xf3 th\u1ec3 cung c\u1ea5p UTxO, t\u1eadp l\u1ec7nh tr\xecnh x\xe1c th\u1ef1c v\xe0, nh\u01b0 ch\xfang t\xf4i l\xe0m \u1edf \u0111\xe2y, b\u1ea1n c\xf3 th\u1ec3 cung c\u1ea5p t\u1eadp l\u1ec7nh ch\xednh s\xe1ch ti\u1ec1n t\u1ec7."),(0,h.kt)("p",null,"Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\xfang t\xf4i, \u0111i\u1ec1u duy nh\u1ea5t ch\xfang t\xf4i c\u1ea7n cung c\u1ea5p khi tra c\u1ee9u l\xe0 ch\xednh s\xe1ch m\xe0 ch\xfang t\xf4i \u0111\xe3 x\xe1c \u0111\u1ecbnh tr\u01b0\u1edbc \u0111\xf3 trong t\u1eadp l\u1ec7nh."),(0,h.kt)("p",null,"C\xf3 nh\u1eefng bi\u1ebfn th\u1ec3 c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith")," kh\xf4ng c\xf3 bi\u1ebfn th\u1ec3 ",(0,h.kt)("inlineCode",{parentName:"p"},"with")," kh\xf4ng c\u1ea7n tra c\u1ee9u, nh\u01b0 ch\xfang ta \u0111\xe3 th\u1ea5y trong c\xe1c b\xe0i gi\u1ea3ng tr\u01b0\u1edbc."),(0,h.kt)("p",null,"Cu\u1ed1i c\xf9ng,  ",(0,h.kt)("inlineCode",{parentName:"p"},"@Void"),":"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"ledgerTx <- submitTxConstraintsWith @Void lookups tx\n")),(0,h.kt)("p",null,"H\u1ea7u h\u1ebft c\xe1c h\xe0m r\xe0ng bu\u1ed9c \u0111\u1ec1u h\u01b0\u1edbng t\u1edbi vi\u1ec7c s\u1eed d\u1ee5ng m\u1ed9t t\u1eadp l\u1ec7nh tr\xecnh x\xe1c nh\u1eadn c\u1ee5 th\u1ec3. Th\xf4ng th\u01b0\u1eddng, b\u1ea1n c\xf3 t\xecnh hu\u1ed1ng r\u1eb1ng b\u1ea1n \u0111ang l\xe0m vi\u1ec7c tr\xean m\u1ed9t h\u1ee3p \u0111\u1ed3ng th\xf4ng minh c\u1ee5 th\u1ec3. V\xe0 h\u1ee3p \u0111\u1ed3ng th\xf4ng minh c\u1ee5 th\u1ec3 \u0111\xf3 c\xf3 m\u1ee9c d\u1eef li\u1ec7u v\xe0 ki\u1ec3u ng\u01b0\u1eddi mua, v\xe0 h\u1ea7u h\u1ebft c\xe1c ch\u1ee9c n\u0103ng r\xe0ng bu\u1ed9c l\xe0 tham s\u1ed1 trong ki\u1ec3u d\u1eef li\u1ec7u v\xe0 ki\u1ec3u ng\u01b0\u1eddi mua. Trong tr\u01b0\u1eddng h\u1ee3p \u0111\xf3, b\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng tr\u1ef1c ti\u1ebfp ki\u1ec3u d\u1eef li\u1ec7u m\xe0 kh\xf4ng c\u1ea7n ph\u1ea3i chuy\u1ec3n \u0111\u1ed5i n\xf3 sang ki\u1ec3u Plutus\n",(0,h.kt)("inlineCode",{parentName:"p"},"Datum"),"."),(0,h.kt)("p",null,"Nh\u01b0ng trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, ch\xfang t\xf4i kh\xf4ng t\u1eadn d\u1ee5ng \u0111i\u1ec1u \u0111\xf3. Ch\xfang t\xf4i kh\xf4ng c\xf3 b\u1ea5t k\u1ef3 t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c n\xe0o. \u0110i\u1ec1u \u0111\xf3 c\xf3 ngh\u0129a l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith")," s\u1ebd kh\xf4ng bi\u1ebft lo\u1ea1i n\xe0o \u0111\u1ec3 s\u1eed d\u1ee5ng cho datum v\xe0 Redeemer v\xec ch\xfang t\xf4i kh\xf4ng c\xf3 ch\xfang trong v\xed d\u1ee5 n\xe0y. V\xec v\u1eady, trong tr\u01b0\u1eddng h\u1ee3p \u0111\xf3, ch\xfang ta ph\u1ea3i cho tr\xecnh bi\xean d\u1ecbch bi\u1ebft lo\u1ea1i n\xe0o s\u1ebd s\u1eed d\u1ee5ng. Ch\xfang t\xf4i kh\xf4ng quan t\xe2m, v\xec kh\xf4ng c\xf3 datum v\xe0 Redeemer, v\xec v\u1eady ch\xfang t\xf4i s\u1eed d\u1ee5ng lo\u1ea1i",(0,h.kt)("inlineCode",{parentName:"p"},"Void"),"."),(0,h.kt)("p",null,"Ngo\xe0i ra, trong c\xf9ng m\u1ed9t d\xf2ng, ch\xfang ta th\u1ea5y m\u1ed9t r\xe0ng bu\u1ed9c \u0111\u01a1n nguy\xean, v\xec v\u1eady ch\xfang ta bi\u1ebft r\u1eb1ng \u0111\xe2y l\xe0 m\u1ed9t h\xe0nh \u0111\u1ed9ng \u0111\u01a1n nguy\xean x\u1ea3y ra trong ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," monad. L\xfd do cho \u0111i\u1ec1u n\xe0y l\xe0, \u0111\u1ec3 tra c\u1ee9u, ch\u1eb3ng h\u1ea1n nh\u01b0 c\xe1c UTxO c\u1ee7a ch\xfang ta, h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith")," ph\u1ea3i s\u1eed d\u1ee5ng s\u1ee9c m\u1ea1nh si\xeau vi\u1ec7t c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," \u0111\u01a1n nguy\xean, \u0111\xf3 l\xe0 \u0111\u1ec3 truy c\u1eadp ",(0,h.kt)("inlineCode",{parentName:"p"},"BlockchainActions"),"."),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ",(0,h.kt)("inlineCode",{parentName:"p"},"ledgerTx")," v\u1ec1 c\u01a1 b\u1ea3n l\xe0 m\u1ed9t x\u1eed l\xfd cho giao d\u1ecbch m\xe0 ch\xfang t\xf4i v\u1eeba g\u1eedi."),(0,h.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i \u0111\u1ee3i giao d\u1ecbch \u0111\u01b0\u1ee3c x\xe1c nh\u1eadn."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"void $ awaitTxConfirmed $ txId ledgerTx\n")),(0,h.kt)("p",null,"Hi\u1ec7n t\u1ea1i, n\u1ebfu x\xe1c th\u1ef1c giao d\u1ecbch kh\xf4ng th\xe0nh c\xf4ng, d\xf2ng ch\u1edd x\xe1c nh\u1eadn s\u1ebd b\u1ecb ch\u1eb7n v\u0129nh vi\u1ec5n. Tuy nhi\xean, \u0111i\u1ec1u n\xe0y s\u1ebd s\u1edbm thay \u0111\u1ed5i trong b\u1ea3n ph\xe1t h\xe0nh s\u1eafp t\u1edbi c\u1ee7a Plutus \u0111\u1ec3 cho ph\xe9p ch\xfang t\xf4i l\u1eafng nghe c\xe1c thay \u0111\u1ed5i v\u1ec1 tr\u1ea1ng th\xe1i, v\xec v\u1eady b\u1ea1n c\xf3 th\u1ec3 ph\xe1t hi\u1ec7n xem x\xe1c th\u1ef1c c\xf3 th\u1ea5t b\u1ea1i hay kh\xf4ng."),(0,h.kt)("p",null,"Sau khi x\xe1c nh\u1eadn, ch\xfang t\xf4i ch\u1ec9 c\u1ea7n vi\u1ebft m\u1ed9t th\xf4ng b\xe1o nh\u1eadt k\xfd."),(0,h.kt)("p",null,"Cu\u1ed1i c\xf9ng, ch\xfang ta c\u1ea7n th\xeam m\u1ed9t s\u1ed1 b\u1ea3n so\u1ea1n s\u1eb5n \u0111\u1ec3 x\xe1c \u0111\u1ecbnh \u0111i\u1ec3m cu\u1ed1i c\u1ee7a ch\xfang ta, \u0111\u1ec3 c\xf3 th\u1ec3 th\u1ef1c thi h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"mint"),", v\xed d\u1ee5, trong playground."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"endpoints :: Contract () FreeSchema Text ()\nendpoints = mint' >> endpoints\n  where\n    mint' = endpoint @\"mint\" >>= mint    \n")),(0,h.kt)("p",null,"Ch\xfang t\xf4i x\xe1c \u0111\u1ecbnh m\u1ed9t h\u1ee3p \u0111\u1ed3ng kh\xe1c ",(0,h.kt)("inlineCode",{parentName:"p"},"endpoints"),", v\xe0 \u0111\xf3 lu\xf4n l\xe0 t\xean c\u1ee7a h\u1ee3p \u0111\u1ed3ng m\xe0 playground s\u1ebd ch\u1ea1y. V\xec v\u1eady, n\u1ebfu b\u1ea1n mu\u1ed1n th\u1eed nghi\u1ec7m \u0111i\u1ec1u g\xec \u0111\xf3 trong playground, b\u1ea1n lu\xf4n c\u1ea7n m\u1ed9t th\u1ee9 \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"endpoints"),"."),(0,h.kt)("p",null,"\u1ede \u0111\xe2y ch\xfang ta ch\u1ec9 \u0111\u1ecbnh ngh\u0129a m\u1ed9t h\xe0m \u0111\u01b0\u1ee3c g\u1ecdi ",(0,h.kt)("inlineCode",{parentName:"p"},"mint'"),"v\xe0 sau \u0111\xf3 g\u1ecdi \u0111\u1ec7 quy ",(0,h.kt)("inlineCode",{parentName:"p"},"endpoints"),", v\xec v\u1eady khi n\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c th\u1ef1c thi, n\xf3 s\u1ebd c\xf3 s\u1eb5n \u0111\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c thi l\u1ea1i."),(0,h.kt)("p",null,"V\xec ",(0,h.kt)("inlineCode",{parentName:"p"},"mint'")," b\u1eb1ng c\xe1ch n\xe0o \u0111\xf3 ch\xfang ta ph\u1ea3i c\xf3 \u0111\u01b0\u1ee3c ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams")," v\xe0 \u0111\u1ec3 s\u1eed d\u1ee5ng ",(0,h.kt)("inlineCode",{parentName:"p"},"endpoint"),". H\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"endpoint")," cung c\u1ea5p m\u1ed9t tham s\u1ed1 cho Contract. Khi tham s\u1ed1 c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams")," \u0111\u01b0\u1ee3c cung c\u1ea5p, ch\xfang t\xf4i s\u1eed d\u1ee5ng r\xe0ng bu\u1ed9c \u0111\u01a1n nguy\xean \u0111\u1ec3 g\u1ecdi ",(0,h.kt)("inlineCode",{parentName:"p"},"mint")," v\u1edbi ccacs \u0111\u1ed1i s\u1ed1 \u0111\xf3."),(0,h.kt)("p",null,"Hai d\xf2ng cu\u1ed1i c\xf9ng, nh\u01b0 ch\xfang ta \u0111\xe3 th\u1ea5y tr\u01b0\u1edbc \u0111\xe2y, ch\u1ec9 c\u1ea7n thi\u1ebft cho giao di\u1ec7n ng\u01b0\u1eddi d\xf9ng c\u1ee7a playground."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkSchemaDefinitions ''FreeSchema\nmkKnownCurrencies []    \n")),(0,h.kt)("h3",{id:"trong-playground"},"Trong Playground"),(0,h.kt)("p",null,"Ch\xfang t\xf4i \u0111\xe3 thi\u1ebft l\u1eadp m\u1ed9t k\u1ecbch b\u1ea3n trong \u0111\xf3 V\xed 1 \u0111\xfac 555 m\xe3 th\xf4ng b\xe1o ABC v\xe0 V\xed 2 \u0111\xfac 444 m\xe3 th\xf4ng b\xe1o ABC. Sau \u0111\xf3, sau khi ch\u1edd 1 khe, V\xed 1 \u0111\u1ed1t 222 m\xe3 th\xf4ng b\xe1o ABC. Cu\u1ed1i c\xf9ng, ch\xfang ta \u0111\u1ee3i 1 slot \u1edf cu\u1ed1i."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(3345).Z})),(0,h.kt)("p",null,"B\xe2y gi\u1edd, n\u1ebfu ch\xfang ta \u0111\xe1nh gi\xe1 \u0111i\u1ec1u n\xe0y, tr\u01b0\u1edbc ti\xean ch\xfang ta s\u1ebd th\u1ea5y giao d\u1ecbch kh\u1edfi \u0111\u1ea7u trong \u0111\xf3 c\xe1c v\xed \u0111\u01b0\u1ee3c c\u1ea5p 1000 lovelace m\u1ed7i v\xed."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(6232).Z})),(0,h.kt)("p",null,"Ti\u1ebfp theo, ch\xfang t\xf4i th\u1ea5y hai giao d\u1ecbch t\u1ea1i V\u1ecb tr\xed 1. \u0110\u1ea7u ti\xean l\xe0 giao d\u1ecbch t\u1eeb V\xed 2, n\u01a1i 444 m\xe3 th\xf4ng b\xe1o ABC \u0111\u01b0\u1ee3c \u0111\xfac v\xe0 m\u1ed9t kho\u1ea3n ph\xed 10 lovelace \u0111\u01b0\u1ee3c thanh to\xe1n. UTxO \u0111\u1ec3 thanh to\xe1n ph\xed \u0111\xe3 \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng t\xecm th\u1ea5y b\u1edfi ch\u1ee9c n\u0103ng t\u1ea1o giao d\u1ecbch ",(0,h.kt)("inlineCode",{parentName:"p"},"submitTxConstraintsWith"),", nh\u01b0 \u0111\xe3 th\u1ea3o lu\u1eadn tr\u01b0\u1edbc \u0111\xe2y."),(0,h.kt)("p",null,"Ch\xfang t\xf4i th\u1ea5y \u1edf \u0111\xe2y m\u1ed9t th\u1ee9 m\xe0 ch\xfang t\xf4i ch\u01b0a t\u1eebng th\u1ea5y tr\u01b0\u1edbc \u0111\xe2y - ",(0,h.kt)("inlineCode",{parentName:"p"},"Forge")," m\u1ed9t ph\u1ea7n c\u1ee7a giao d\u1ecbch, n\u01a1i c\xe1c m\xe3 th\xf4ng b\xe1o g\u1ed1c th\u1ef1c s\u1ef1 \u0111\u01b0\u1ee3c t\u1ea1o ra. H\u1ed9p ch\u1ee9a k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 (b\u0103m ch\xednh s\xe1ch) v\xe0 t\xean m\xe3 th\xf4ng b\xe1o."),(0,h.kt)("p",null,"Ch\xfang t\xf4i c\u0169ng th\u1ea5y hai k\u1ebft qu\u1ea3 \u0111\u1ea7u ra - m\u1ed9t l\u1ea7n v\u1edbi s\u1ef1 thay \u0111\u1ed5i 990 lovelace v\xe0 m\u1ed9t k\u1ebft qu\u1ea3 kh\xe1c v\u1edbi c\xe1c m\xe3 th\xf4ng b\xe1o m\u1edbi \u0111\u01b0\u1ee3c \u0111\xfac. Tr\xean th\u1ef1c t\u1ebf, c\xe1c k\u1ebft qu\u1ea3 \u0111\u1ea7u ra n\xe0y c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p v\u1edbi nhau, nh\u01b0ng \u1edf \u0111\xe2y ch\xfang \u0111\u01b0\u1ee3c th\u1ec3 hi\u1ec7n d\u01b0\u1edbi d\u1ea1ng hai UTxO ri\xeang bi\u1ec7t."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(9952).Z})),(0,h.kt)("p",null,"Sau \u0111\xf3, ch\xfang t\xf4i th\u1ea5y giao d\u1ecbch t\u1eeb V\xed 1, n\u01a1i c\xf3 555 m\xe3 th\xf4ng b\xe1o ABC \u0111\u01b0\u1ee3c \u0111\xfac v\xe0 m\u1ed9t kho\u1ea3n ph\xed 10 lovelace \u0111\u01b0\u1ee3c thanh to\xe1n."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(9).Z})),(0,h.kt)("p",null,"Cu\u1ed1i c\xf9ng, ch\xfang t\xf4i th\u1ea5y vi\u1ec7c \u0111\u1ed1t 222 m\xe3 th\xf4ng b\xe1o b\u1eb1ng V\xed 1. \u1ede \u0111\xe2y, ch\xfang t\xf4i th\u1ea5y r\u1eb1ng thu\u1eadt to\xe1n \u0111\xe3 l\xe0m m\u1ed9t \u0111i\u1ec1u g\xec \u0111\xf3 h\u01a1i kh\xe1c m\u1ed9t ch\xfat. Khi nh\u1eadn th\u1ea5y r\u1eb1ng m\u1ed9t \u0111\u1ee3t ghi \u0111ang di\u1ec5n ra, n\xf3 \u0111\xe3 t\xecm th\u1ea5y ABC token UTxO trong Wallet 1 v\xe0 s\u1eed d\u1ee5ng ch\xfang l\xe0m \u0111\u1ea7u v\xe0o. Ch\xfang t\xf4i c\u0169ng l\u01b0u \xfd \u1edf \u0111\xe2y r\u1eb1ng UTxO \u0111\u1ea7u ra \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p, nh\u01b0 ch\xfang t\xf4i \u0111\xe3 \u0111\u1ec1 c\u1eadp \u1edf tr\xean, c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n thay v\xec s\u1eed d\u1ee5ng hai UTxO \u0111\u1ea7u ra."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(5289).Z})),(0,h.kt)("p",null,"V\xe0 ch\xfang t\xf4i c\u0169ng c\xf3 th\u1ec3 xem c\xe1c s\u1ed1 d\u01b0 cu\u1ed1i c\xf9ng \u0111\u1ec3 ki\u1ec3m tra l\u1ea1i xem t\u1ea5t c\u1ea3 \u0111\xe3 di\u1ec5n ra theo \u0111\xfang k\u1ebf ho\u1ea1ch ch\u01b0a."),(0,h.kt)("p",null,(0,h.kt)("img",{src:e(722).Z})),(0,h.kt)("p",null,"V\u1edbi ch\xednh s\xe1ch ti\u1ec1n t\u1ec7 c\u1ee7a ch\xfang t\xf4i, ch\xfang t\xf4i c\xf3 th\u1ec3 t\u1ea1o c\xe1c giao d\u1ecbch gi\u1ea3 m\u1ea1o v\xe0 \u0111\u1ed1t t\xf9y \xfd b\u1eb1ng b\u1ea5t k\u1ef3 v\xed n\xe0o. V\xec v\u1eady, \u0111\xe2y c\xf3 l\u1ebd kh\xf4ng ph\u1ea3i l\xe0 m\u1ed9t ch\xednh s\xe1ch ti\u1ec1n t\u1ec7 t\u1ed1t. M\u1ee5c \u0111\xedch c\u1ee7a m\xe3 th\xf4ng b\xe1o l\xe0 \u0111\u1ea1i di\u1ec7n cho gi\xe1 tr\u1ecb, nh\u01b0ng n\u1ebfu b\u1ea5t k\u1ef3 ai t\u1ea1i b\u1ea5t k\u1ef3 th\u1eddi \u0111i\u1ec3m n\xe0o c\xf3 th\u1ec3 t\u1ea1o ra m\xe3 th\xf4ng b\xe1o m\u1edbi, th\xec m\xe3 th\xf4ng b\xe1o n\xe0y s\u1ebd kh\xf4ng c\xf3 nhi\u1ec1u \xfd ngh\u0129a. C\xf3 th\u1ec3 c\xf3 m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng k\u1ef3 l\u1ea1 cho n\xf3, nh\u01b0ng tr\xean th\u1ef1c t\u1ebf, ch\xednh s\xe1ch n\xe0y kh\xe1 v\xf4 d\u1ee5ng."),(0,h.kt)("h3",{id:"th\u1eed-nghi\u1ec7m-v\u1edbi-emulatortrace"},"Th\u1eed nghi\u1ec7m v\u1edbi EmulatorTrace"),(0,h.kt)("p",null,"H\xe3y c\u0169ng ki\u1ec3m tra \u0111i\u1ec1u n\xe0y t\u1eeb d\xf2ng l\u1ec7nh, thay v\xec trong playground."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'test :: IO ()\ntest = runEmulatorTraceIO $ do\n    let tn = "ABC"\n    h1 <- activateContractWallet (Wallet 1) endpoints\n    h2 <- activateContractWallet (Wallet 2) endpoints\n    callEndpoint @"mint" h1 $ MintParams\n        { mpTokenName = tn\n        , mpAmount    = 555\n        }\n    callEndpoint @"mint" h2 $ MintParams\n        { mpTokenName = tn\n        , mpAmount    = 444\n        }\n    void $ Emulator.waitNSlots 1\n    callEndpoint @"mint" h1 $ MintParams\n        { mpTokenName = tn\n        , mpAmount    = -222\n        }\n    void $ Emulator.waitNSlots 1\n')),(0,h.kt)("p",null,"N\u1ebfu ch\xfang t\xf4i ch\u1ea1y \u0111i\u1ec1u n\xe0y trong REPL, ch\xfang t\xf4i s\u1ebd th\u1ea5y nh\u1eefng g\xec ch\xfang t\xf4i \u0111\xe3 th\u1ea5y trong s\xe2n ch\u01a1i, nh\u01b0ng thay v\xe0o \u0111\xf3 tr\xean b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n. N\xf3 kh\xf4ng \u0111\u1eb9p, nh\u01b0ng n\xf3 nhanh h\u01a1n."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.}"},'Prelude Week05.Free> test\nSlot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8\nSlot 00000: SlotAdd Slot 1\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number 555.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00001: W1: TxSubmit: 7c01d39fc031815eaf05d97709e4973a24dfa38e9dd68a4fd1ec92bb80cf76e4\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number 444.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00001: W2: TxSubmit: 6ba7eb4441992284e687d184080d4a8693e7b188fc45150d6e7ccd1243968f53\nSlot 00001: TxnValidate 6ba7eb4441992284e687d184080d4a8693e7b188fc45150d6e7ccd1243968f53\nSlot 00001: TxnValidate 7c01d39fc031815eaf05d97709e4973a24dfa38e9dd68a4fd1ec92bb80cf76e4\nSlot 00001: SlotAdd Slot 2\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\\"ABC\\",555)])])"\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\\"ABC\\",444)])])"\nSlot 00002: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number -222.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00002: W1: TxSubmit: 95d42e93ee41ab5bed7857b176be5a4e16602323eaacaa90f3bb807a9fd235c0\nSlot 00002: TxnValidate 95d42e93ee41ab5bed7857b176be5a4e16602323eaacaa90f3bb807a9fd235c0\nSlot 00002: SlotAdd Slot 3\nSlot 00003: `` CONTRACT LOG: "forged Value (Map [(e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf,Map [(\\"ABC\\",-222)])])"\nSlot 00003: SlotAdd Slot 4\nFinal balances\nWallet 1: \n    {, ""}: 99999980\n    {e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf, "ABC"}: 333\nWallet 2: \n    {e01824b4319351c40b5ec727fff328a82076b1474a6bad6c8e8a2cd835cc6aaf, "ABC"}: 444\n    {, ""}: 99999990\n...    \nWallet 10: \n    {, ""}: 100000000\n')),(0,h.kt)("h2",{id:"v\xed-d\u1ee5-2---signed"},"V\xed d\u1ee5 2 - Signed"),(0,h.kt)("h3",{id:"on-chain-1"},"On-chain"),(0,h.kt)("p",null,"H\xe3y xem m\u1ed9t v\xed d\u1ee5 th\u1ef1c t\u1ebf h\u01a1n."),(0,h.kt)("p",null,"Ch\xfang t\xf4i s\u1ebd l\u1ea5y m\u1ed9t b\u1ea3n sao c\u1ee7a m\xf4-\u0111un Mi\u1ec5n ph\xed v\xe0 g\u1ecdi n\xf3 l\xe0 \u0110\xe3 k\xfd."),(0,h.kt)("p",null,"C\xf3 l\u1ebd v\xed d\u1ee5 d\u1ec5 nh\u1ea5t v\u1ec1 ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n th\u1ef1c t\u1ebf l\xe0 m\u1ed9t ch\xednh s\xe1ch m\xe0 vi\u1ec7c \u0111\xfac v\xe0 \u0111\u1ed1t m\xe3 th\xf4ng b\xe1o b\u1ecb h\u1ea1n ch\u1ebf \u0111\u1ed1i v\u1edbi c\xe1c giao d\u1ecbch \u0111\u01b0\u1ee3c k\xfd b\u1edfi m\u1ed9t h\xe0m b\u0103m kh\xf3a c\xf4ng khai c\u1ee5 th\u1ec3. \u0110i\u1ec1u \u0111\xf3 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 m\u1ed9t ng\xe2n h\xe0ng trung \u01b0\u01a1ng, b\u1eb1ng c\xe1c lo\u1ea1i ti\u1ec1n t\u1ec7 fiat."),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 c\xe1c ch\xednh s\xe1ch c\u1ee7a ch\xfang t\xf4i kh\xf4ng c\xf2n l\xe0 kh\xf4ng c\xf3 c\xe1c tham s\u1ed1. Ch\xfang t\xf4i c\u1ea7n m\xe3 b\u0103m kh\xf3a c\xf4ng khai. Ngo\xe0i ra, ch\xfang ta c\u0169ng c\u1ea7n ph\u1ea3i xem x\xe9t b\u1ed1i c\u1ea3nh, v\xec v\u1eady ch\xfang ta kh\xf4ng th\u1ec3 b\u1ecf qua nh\u01b0 l\u1ea7n tr\u01b0\u1edbc."),(0,h.kt)("p",null,"Ch\xfang t\xf4i nh\u1edb r\u1eb1ng ",(0,h.kt)("inlineCode",{parentName:"p"},"scriptContextTxInfo")," t\u1eeb ng\u1eef c\u1ea3nh c\xf3 ch\u1ee9a danh s\xe1ch t\u1ea5t c\u1ea3 c\xe1c b\xean k\xfd k\u1ebft c\u1ee7a giao d\u1ecbch. V\xec v\u1eady, ch\xfang t\xf4i c\xf3 th\u1ec3 s\u1eed d\u1ee5ng \u0111i\u1ec1u n\xe0y \u0111\u1ec3 xem li\u1ec7u ng\u01b0\u1eddi k\xfd \u0111\u01b0\u1ee3c y\xeau c\u1ea7u c\xf3 ph\u1ea3i l\xe0 m\u1ed9t trong s\u1ed1 h\u1ecd hay kh\xf4ng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkPolicy :: PubKeyHash -> ScriptContext -> Bool\nmkPolicy pkh ctx = txSignedBy (scriptContextTxInfo ctx) pkh\n")),(0,h.kt)("p",null,"C\xe1c h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"txSignedBy")," l\xe0 m\u1ed9t c\xe1ch thu\u1eadn ti\u1ec7n \u0111\u1ec3 ki\u1ec3m tra n\xe0y. Trong c\xe1c v\xed d\u1ee5 tr\u01b0\u1edbc, ch\xfang t\xf4i \u0111\xe3 s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"elem")," \u0111\u1ec3 ki\u1ec3m tra xem n\xf3 c\xf3 t\u1ed3n t\u1ea1i trong danh s\xe1ch hay kh\xf4ng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.Free> import Ledger\nPrelude Ledger Week05.Free> :t txSignedBy\ntxSignedBy :: TxInfo -> PubKeyHash -> Bool\n")),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang ta c\u1ea7n c\u1eadp nh\u1eadt ph\u1ea7n m\xe3 bi\xean d\u1ecbch h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"mkPolicy"),"  c\u1ee7a ch\xfang ta th\xe0nh m\xe3 Plutus. Ch\xfang t\xf4i s\u1ebd s\u1eed d\u1ee5ng c\xe1c k\u1ef9 thu\u1eadt t\u01b0\u01a1ng t\u1ef1 m\xe0 ch\xfang t\xf4i \u0111\xe3 s\u1eed d\u1ee5ng khi vi\u1ebft c\xe1c t\u1eadp l\u1ec7nh tr\xecnh x\xe1c th\u1ef1c. C\u1ee5 th\u1ec3, ch\xfang t\xf4i s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"applyCode")," \u0111\u1ec3 cho ph\xe9p ch\xfang t\xf4i tham chi\u1ebfu ",(0,h.kt)("inlineCode",{parentName:"p"},"pkh"),", gi\xe1 tr\u1ecb c\u1ee7a n\xf3 ch\u1ec9 \u0111\u01b0\u1ee3c bi\u1ebft trong th\u1eddi gian ch\u1ea1y."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"policy :: PubKeyHash -> Scripts.MonetaryPolicy\npolicy pkh = mkMonetaryPolicyScript $\n    $$(PlutusTx.compile [|| Scripts.wrapMonetaryPolicy . mkPolicy ||])\n    `PlutusTx.applyCode`\n    PlutusTx.liftCode pkh\n")),(0,h.kt)("p",null,"Ch\xfang t\xf4i c\u0169ng c\u1ea7n c\u1eadp nh\u1eadt h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"curSymbol"),", v\xec n\xf3 hi\u1ec7n ph\u1ee5 thu\u1ed9c v\xe0o h\xe0m b\u0103m c\u1ee7a kh\xf3a c\xf4ng khai. N\xf3 ph\u1ee5 thu\u1ed9c v\xe0o n\xf3 \u0111\u1ec3 n\xf3 c\xf3 th\u1ec3 chuy\u1ec3n n\xf3 \u0111\u1ebfn h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"policy"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"curSymbol :: PubKeyHash -> CurrencySymbol\ncurSymbol = scriptCurrencySymbol . policy\n")),(0,h.kt)("p",null,"L\u01b0u \xfd, d\xf2ng th\u1ee9 hai \u1edf \u0111\xe2y, ph\u1ea7n n\u1ed9i dung, l\xe0 c\xe1ch vi\u1ebft ng\u1eafn h\u01a1n:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"curSymbol pkh = scriptCurrencySymbol $ policy pkh\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y r\xf5 r\xe0ng, khi b\u1ea1n xem x\xe9t m\u1ed9t c\xe1i g\xec \u0111\xf3 nh\u01b0 sau, \u0111\xe2u ",(0,h.kt)("inlineCode",{parentName:"p"},"timesSix")," ch\u1ec9 l\xe0 m\u1ed9t c\xe1ch kh\xe1c \u0111\u1ec3 vi\u1ebft k\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c k\u1ebft h\u1ee3p c\xe1c h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"timesTwo")," and ",(0,h.kt)("inlineCode",{parentName:"p"},"timesThree"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"timesSix x = timesTwo $ timesThree x \n")),(0,h.kt)("p",null,"gi\u1ed1ng h\u1ec7t nh\u01b0 ..."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"timesSix = timesTwo . timesThree\n")),(0,h.kt)("p",null,"Qu\xe1 tr\xecnh \u0111\u01a1n gi\u1ea3n h\xf3a n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 gi\u1ea3m ETA, v\xec v\u1eady n\u1ebfu b\u1ea1n t\u1eebng th\u1ea5y IDE c\u1ee7a m\xecnh g\u1ee3i \xfd r\u1eb1ng b\u1ea1n c\xf3 th\u1ec3 gi\u1ea3m ETA, th\xec \u0111\xe2y ch\xednh l\xe0 nh\u1eefng g\xec n\xf3 \u0111ang n\xf3i \u0111\u1ebfn."),(0,h.kt)("p",null,"B\xe2y gi\u1edd cho m\xe3 off-chain."),(0,h.kt)("h3",{id:"off-chain-1"},"Off-chain"),(0,h.kt)("p",null,"We don\\'t need to extend the ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams")," Ch\xfang t\xf4i kh\xf4ng c\u1ea7n m\u1edf r\u1ed9ng ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams")," ki\u1ec3u d\u1eef li\u1ec7u cho Off-chain. V\xed mu\u1ed1n \u0111\xfac ho\u1eb7c \u0111\u1ed1t ti\u1ec1n t\u1ec7 c\xf3 th\u1ec3 k\xfd b\u1eb1ng m\xe3 b\u0103m kh\xf3a c\xf4ng khai c\u1ee7a ch\xednh n\xf3. \u0110\xe2y l\xe0 ch\u1eef k\xfd duy nh\u1ea5t m\xe0 v\xed c\xf3 th\u1ec3 cung c\u1ea5p v\xe0 n\xf3 c\xf3 kh\u1ea3 n\u0103ng t\u1ef1 tra c\u1ee9u."),(0,h.kt)("p",null,"Ch\xfang t\xf4i s\u1ebd th\u1ef1c hi\u1ec7n m\u1ed9t thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi t\xean c\u1ee7a l\u01b0\u1ee3c \u0111\u1ed3 cho r\xf5 r\xe0ng. T\u1ea5t nhi\xean, ch\xfang t\xf4i c\u0169ng s\u1ebd c\u1eadp nh\u1eadt t\xean n\xe0y b\u1ea5t c\u1ee9 n\u01a1i n\xe0o n\xf3 xu\u1ea5t hi\u1ec7n trong t\u1eadp l\u1ec7nh h\u1ee3p \u0111\u1ed3ng.t\nscript."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'type SignedSchema =\n    BlockchainActions\n        .\\/ Endpoint "mint" MintParams\n')),(0,h.kt)("p",null,"B\xe2y gi\u1edd, \u0111\u1ed1i v\u1edbi h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"mint"),", ch\xfang ta c\u1ea7n chuy\u1ec3n h\xe0m b\u0103m kh\xf3a c\xf4ng khai cho h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"curSymbol"),". N\u1eafm gi\u1eef kh\xf3a c\xf4ng khai l\xe0 th\u1ee9 \u0111\u01b0\u1ee3c cung c\u1ea5p b\u1edfi ",(0,h.kt)("inlineCode",{parentName:"p"},"BlockchainActions"),". V\xec v\u1eady, ch\xfang t\xf4i s\u1ebd l\u1ea5y \u0111i\u1ec1u n\xe0y t\u1eeb ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," v\xe0 \xe1p d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"pubKeyHash"),"cho n\xf3."),(0,h.kt)("p",null,"M\u1ed9t c\xe1ch \u0111\u1ec3 l\xe0m \u0111i\u1ec1u n\xe0y s\u1ebd l\xe0"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"pk <- Contract.ownPubKey\nlet pkh = pubKeyHash pk\n")),(0,h.kt)("p",null,"Tuy nhi\xean, nh\u01b0 ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract")," l\xe0 m\u1ed9t monad, v\xe0 do \u0111\xf3 l\xe0 m\u1ed9t th\u1ec3 hi\u1ec7n c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"Functor"),",  ch\xfang ta c\xf3 h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"fmap")," , h\xe0m n\xe0y s\u1ebd bi\u1ebfn\n",(0,h.kt)("inlineCode",{parentName:"p"},"Contract a")," th\xe0nh ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract b"),". Trong tr\u01b0\u1eddng h\u1ee3p n\xe0y, ch\xfang ta c\xf3 th\u1ec3 t\u1eadn d\u1ee5ng \u0111i\u1ec1u \u0111\xf3 b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"pubKeyHash")," nh\u01b0 l\xe0 (a -> b) c\u1ee7a h\xe0m fmap v\xe0 s\u1ebd chuy\u1ec3n ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract pubKey")," th\xe0nh ",(0,h.kt)("inlineCode",{parentName:"p"},"Contract pubKeyHash"),",v\xe0 sau \u0111\xf3 c\xf3 th\u1ec3 h\xe0m grab \u0111\u1ec3 l\u1ea5y gi\xe1 tr\u1ecb."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"pkh <- fmap pubKeyHash Contract.ownPubKey\n")),(0,h.kt)("p",null,"C\xf2n m\u1ed9t \u0111i\u1ec1u n\u1eefa ch\xfang t\xf4i c\xf3 th\u1ec3 l\xe0m \u0111\u1ec3 c\u1ea3i thi\u1ec7n \u0111i\u1ec1u n\xe0y. C\xf3 m\u1ed9t nh\xe0 \u0111i\u1ec1u h\xe0nh cho ",(0,h.kt)("inlineCode",{parentName:"p"},"fmap"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"pkh <- pubKeyHash <$> Contract.ownPubKey\n")),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"")),(0,h.kt)("p",null,"\u0110\u01b0\u1ee3c r\u1ed3i, b\xe2y gi\u1edd ch\xfang ta h\xe3y c\u1eadp nh\u1eadt d\xf2ng tra c\u1ee9u \u0111\u1ec3 chuy\u1ec3n trong h\xe0m b\u0103m kh\xf3a c\xf4ng khai."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"lookups = Constraints.monetaryPolicy $ policy pkh\n")),(0,h.kt)("p",null,"V\xe0 b\xe2y gi\u1edd ch\xfang ta \u0111\xe3 ho\xe0n th\xe0nh vi\u1ec7c s\u1eeda \u0111\u1ed5i h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"mint"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mint :: MintParams -> Contract w SignedSchema Text ()\nmint mp = do\n    pkh <- pubKeyHash <$> Contract.ownPubKey\n    let val     = Value.singleton (curSymbol pkh) (mpTokenName mp) (mpAmount mp)\n        lookups = Constraints.monetaryPolicy $ policy pkh\n        tx      = Constraints.mustForgeValue val\n    ledgerTx <- submitTxConstraintsWith @Void lookups tx\n    void $ awaitTxConfirmed $ txId ledgerTx\n    Contract.logInfo @String $ printf "forged %s" (show val)\n')),(0,h.kt)("p",null,"V\xec v\u1eady, ch\xfang ta h\xe3y th\u1eed n\xf3 b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"test"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.}"},'Prelude Ledger Week05.Signed> Week05.Signed.test\nSlot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8\nSlot 00000: SlotAdd Slot 1\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number 555.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00001: W1: TxSubmit: 20289e7b1bb6692b35e24e0f9293327f9169d843ae0ea431186fdefae6092a44\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number 444.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00001: W2: TxSubmit: 1c367cf81dd2da478abb96235ee16facf9f7d47374c9455d5fdd516aaf04d0c2\nSlot 00001: TxnValidate 1c367cf81dd2da478abb96235ee16facf9f7d47374c9455d5fdd516aaf04d0c2\nSlot 00001: TxnValidate 20289e7b1bb6692b35e24e0f9293327f9169d843ae0ea431186fdefae6092a44\nSlot 00001: SlotAdd Slot 2\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521,Map [(\\"ABC\\",555)])])"\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(2a964fa6314803cf1b61165aeb1d758e355aae9480a29e282b58e76983f101ba,Map [(\\"ABC\\",444)])])"\nSlot 00002: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("mpAmount",Number -222.0),("mpTokenName",Object (fromList [("unTokenName",String "ABC")]))]))]))])\nSlot 00002: W1: TxSubmit: 6e20d243447d7f49de509ef6b52c6d947769d95a6451c9cda53e42a0ba02fa69\nSlot 00002: TxnValidate 6e20d243447d7f49de509ef6b52c6d947769d95a6451c9cda53e42a0ba02fa69\nSlot 00002: SlotAdd Slot 3\nSlot 00003: `` CONTRACT LOG: "forged Value (Map [(7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521,Map [(\\"ABC\\",-222)])])"\nSlot 00003: SlotAdd Slot 4\nFinal balances\nWallet 1: \n    {, ""}: 99999980\n    {7183b1cf81e44b26c558ddf442c4a7161a1b504b61136a8773dc2e4960323521, "ABC"}: 333\nWallet 2: \n    {2a964fa6314803cf1b61165aeb1d758e355aae9480a29e282b58e76983f101ba, "ABC"}: 444\n    {, ""}: 99999990\n...\nWallet 10: \n    {, ""}: 100000000\n')),(0,h.kt)("p",null,"\u0110i\u1ec1u n\xe0y tr\xf4ng r\u1ea5t gi\u1ed1ng v\u1edbi tr\u01b0\u1edbc \u0111\xe2y, nh\u01b0ng l\u1ea7n n\xe0y, h\xe3y l\u01b0u \xfd r\u1eb1ng, trong khi t\xean m\xe3 th\xf4ng b\xe1o gi\u1ed1ng nhau, c\xe1c k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 kh\xe1c nhau cho m\u1ed7i v\xed."),(0,h.kt)("h2",{id:"nft---non-fungible-tokens"},"NFT - Non-Fungible Tokens"),(0,h.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta h\xe3y n\xf3i v\u1ec1 NFT - Token kh\xf4ng Fungible. NFT l\xe0 c\xe1c m\xe3 th\xf4ng b\xe1o c\xf3 s\u1ed1 l\u01b0\u1ee3ng ch\xednh x\xe1c l\xe0 1."),(0,h.kt)("p",null,"C\xe1c v\xed d\u1ee5 v\u1ec1 m\xe3 th\xf4ng b\xe1o g\u1ed1c m\xe0 ch\xfang t\xf4i \u0111\xe3 nghi\xean c\u1ee9u cho \u0111\u1ebfn nay ch\u1eafc ch\u1eafn kh\xf4ng ph\u1ea3i l\xe0 NFT v\xec ch\xfang t\xf4i c\xf3 th\u1ec3 d\u1ec5 d\xe0ng \u0111\xfac bao nhi\xeau t\xf9y th\xedch. \u0110i\u1ec1u n\xe0y kh\xf4ng ch\u1ec9 \u0111\xfang trong v\xed d\u1ee5 \u0111\u1ea7u ti\xean, n\u01a1i b\u1ea5t k\u1ef3 ai c\u0169ng c\xf3 th\u1ec3 \u0111\xfac m\xe3 th\xf4ng b\xe1o, m\xe0 c\xf2n trong v\xed d\u1ee5 th\u1ee9 hai, trong \u0111\xf3, mi\u1ec5n l\xe0 b\u1ea1n l\xe0 ch\u1ee7 s\u1edf h\u1eefu c\u1ee7a m\xe3 b\u0103m kh\xf3a c\xf4ng khai ch\xednh x\xe1c, b\u1ea1n c\xf3 th\u1ec3 \u0111\xfac m\xe3 th\xf4ng b\xe1o kh\xf4ng gi\u1edbi h\u1ea1n cho k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 v\xe0 m\xe3 th\xf4ng b\xe1o li\xean quan T\xean."),(0,h.kt)("p",null,"\u0110\u1ec3 t\u1ea1o ra m\u1ed9t NFT, c\xf3 l\u1ebd \xfd t\u01b0\u1edfng ng\xe2y th\u01a1 \u0111\u1ea7u ti\xean s\u1ebd l\xe0 xem x\xe9t tr\u01b0\u1eddng gi\u1ea3 m\u1ea1o trong ch\xednh s\xe1ch v\xe0 th\u1ef1c thi m\u1ed9t ch\xednh s\xe1ch trong \u0111\xf3 s\u1ed1 ti\u1ec1n l\xe0 m\u1ed9t."),(0,h.kt)("p",null,"Nh\u01b0ng \u0111i\u1ec1u \u0111\xf3 kh\xf4ng gi\xfap \u0111\u01b0\u1ee3c g\xec cho ch\xfang t\xf4i. \u0110i\u1ec1u \u0111\xf3 ch\u1ec9 c\xf3 ngh\u0129a l\xe0 trong m\u1ed9t giao d\u1ecbch, b\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 \u0111\xfac m\u1ed9t m\xe3 th\xf4ng b\xe1o. Nh\u01b0ng kh\xf4ng ai c\xf3 th\u1ec3 ng\u0103n ch\xfang t\xf4i g\u1eedi bao nhi\xeau trong s\u1ed1 c\xe1c giao d\u1ecbch \u0111\xf3 t\xf9y th\xedch."),(0,h.kt)("p",null,"T\xf9y ch\u1ecdn th\u1ee9 hai th\u1ef1c s\u1ef1 \u0111\xe3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng tr\xean chu\u1ed7i kh\u1ed1i Cardano. NFT \u0111\xe3 c\xf3 s\u1eb5n k\u1ec3 t\u1eeb Mary fork, c\xf3 tr\u01b0\u1edbc Plutus, v\xe0 \u0111\u1ec3 l\xe0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\xe0y, ch\xfang \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng th\u1eddi h\u1ea1n."),(0,h.kt)("p",null,"Trong c\xe1c v\xed d\u1ee5 tr\u01b0\u1edbc, ch\xfang ta \u0111\xe3 th\u1ea5y c\xe1ch th\u1eddi gian c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft h\u1ee3p trong c\xe1c t\u1eadp l\u1ec7nh x\xe1c th\u1ef1c v\xe0 \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 c\u0169ng c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong c\xe1c t\u1eadp l\u1ec7nh ch\xednh s\xe1ch."),(0,h.kt)("p",null,"\xdd t\u01b0\u1edfng \u1edf \u0111\xe2y l\xe0 ch\u1ec9 cho ph\xe9p \u0111\xfac ti\u1ec1n tr\u01b0\u1edbc khi th\u1eddi h\u1ea1n nh\u1ea5t \u0111\u1ecbnh tr\xf4i qua. S\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\xe1p n\xe0y, n\u1ebfu b\u1ea1n mu\u1ed1n \u0111\xfac NFT, b\u1ea1n \u0111\xfac m\u1ed9t m\xe3 th\xf4ng b\xe1o tr\u01b0\u1edbc th\u1eddi h\u1ea1n, sau \u0111\xf3 cho ph\xe9p th\u1eddi h\u1ea1n tr\xf4i qua. \u0110i\u1ec1u n\xe0y \u0111\u1ea3m b\u1ea3o r\u1eb1ng, sau th\u1eddi h\u1ea1n, s\u1ebd kh\xf4ng c\xf3 m\xe3 th\xf4ng b\xe1o m\u1edbi n\xe0o \u0111\u01b0\u1ee3c \u0111\xfac."),(0,h.kt)("p",null,"Tuy nhi\xean, \u0111\u1ec3 ki\u1ec3m tra r\u1eb1ng b\u1ea1n ch\u1ec9 \u0111\xfac m\u1ed9t m\xe3 th\xf4ng b\xe1o tr\u01b0\u1edbc th\u1eddi h\u1ea1n, b\u1ea1n c\u1ea7n m\u1ed9t c\xe1i g\xec \u0111\xf3 gi\u1ed1ng nh\u01b0 m\u1ed9t c\xf4ng c\u1ee5 kh\xe1m ph\xe1 chu\u1ed7i kh\u1ed1i. V\xec v\u1eady, theo ngh\u0129a n\xe0y, ch\xfang kh\xf4ng ph\u1ea3i l\xe0 NFT th\u1ef1c s\u1ef1, trong ch\u1eebng m\u1ef1c b\u1ea3n th\xe2n bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 \u0111\u1ea3m b\u1ea3o r\u1eb1ng ch\xfang l\xe0 duy nh\u1ea5t."),(0,h.kt)("p",null,"S\u1eed d\u1ee5ng Plutus, c\xf3 th\u1ec3 t\u1ea1o ra c\xe1c NFT th\u1ef1c s\u1ef1. N\u1ebfu b\u1ea1n bi\u1ebft t\u1eadp l\u1ec7nh ch\xednh s\xe1ch t\u01b0\u01a1ng \u1ee9ng v\u1edbi k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7, b\u1ea1n c\xf3 th\u1ec3 ch\u1eafc ch\u1eafn r\u1eb1ng ch\u1ec9 c\xf3 m\u1ed9t m\xe3 th\xf4ng b\xe1o \u0111ang t\u1ed3n t\u1ea1i m\xe0 kh\xf4ng c\u1ea7n ph\u1ea3i s\u1eed d\u1ee5ng \u0111\u1ebfn m\u1ed9t th\u1ee9 g\xec \u0111\xf3 nh\u01b0 tr\xecnh kh\xe1m ph\xe1 chu\u1ed7i kh\u1ed1i."),(0,h.kt)("p",null,"V\xe0, suy ngh\u0129 v\u1ec1 c\xe1ch l\xe0m \u0111i\u1ec1u \u0111\xf3, ph\u1ea3i c\xf3 m\u1ed9t c\xe1ch \u0111\u1ec3 ng\u0103n ch\u1eb7n vi\u1ec7c c\xf3 nhi\u1ec1u h\u01a1n m\u1ed9t giao d\u1ecbch \u0111\xfac ti\u1ec1n cho m\xe3 th\xf4ng b\xe1o \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp. B\u1ea5t c\u1ee9 \u0111i\u1ec1u g\xec b\u1ea1n vi\u1ebft trong t\u1eadp l\u1ec7nh ch\xednh s\xe1ch c\u1ee7a m\xecnh, n\xf3 ch\u1ec9 ph\u1ea3i tr\u1ea3 v\u1ec1 true cho m\u1ed9t giao d\u1ecbch, do \u0111\xf3 kh\xf4ng th\u1ec3 th\u1ef1c hi\u1ec7n l\u1ea1i \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 trong m\u1ed9t giao d\u1ecbch kh\xe1c."),(0,h.kt)("p",null,"L\xfac \u0111\u1ea7u, \u0111i\u1ec1u n\xe0y nghe c\xf3 v\u1ebb kh\xf4ng th\u1ec3. T\u1ea1i sao b\u1ea1n kh\xf4ng th\u1ec3 ch\u1ea1y l\u1ea1i c\xf9ng m\u1ed9t giao d\u1ecbch v\xe0 x\xe1c th\u1ef1c l\u1ea1i th\xe0nh c\xf4ng? Ngay c\u1ea3 khi xem x\xe9t th\u1eddi h\u1ea1n, \u0111i\u1ec1u g\xec ng\u0103n giao d\u1ecbch th\u1ee9 hai trong c\xf9ng m\u1ed9t v\u1ecb tr\xed v\u01b0\u1ee3t qua x\xe1c th\u1ef1c?"),(0,h.kt)("p",null,"Ch\xeca kh\xf3a \u1edf \u0111\xe2y l\xe0 ch\xfang ta c\u1ea7n m\u1ed9t c\xe1i g\xec \u0111\xf3 \u0111\u1ed9c \u0111\xe1o. M\u1ed9t th\u1ee9 ch\u1ec9 c\xf3 th\u1ec3 t\u1ed3n t\u1ea1i trong m\u1ed9t l\u1ea7n giao d\u1ecbch v\xe0 kh\xf4ng bao gi\u1edd l\u1eb7p l\u1ea1i. \u0110\xe2y l\xe0 m\u1ed9t th\u1ee7 thu\u1eadt quan tr\u1ecdng v\xe0 c\u1ea7n ghi nh\u1edb."),(0,h.kt)("p",null,"\xdd t\u01b0\u1edfng l\xe0 s\u1eed d\u1ee5ng UTxOs. UTxO l\xe0 duy nh\u1ea5t. UTxO l\xe0 \u0111\u1ea7u ra c\u1ee7a m\u1ed9t giao d\u1ecbch v\xe0 s\u1ed1 nh\u1eadn d\u1ea1ng duy nh\u1ea5t c\u1ee7a n\xf3 l\xe0 ID giao d\u1ecbch v\xe0 ch\u1ec9 m\u1ee5c c\u1ee7a n\xf3 trong danh s\xe1ch c\xe1c \u0111\u1ea7u ra t\u1eeb giao d\u1ecbch \u0111\xf3."),(0,h.kt)("p",null,"L\xfd do m\xe0 c\xe1c giao d\u1ecbch l\xe0 duy nh\u1ea5t l\xe0 m\u1ed9t ch\xfat tinh t\u1ebf. Ch\xfang s\u1ebd kh\xf4ng nh\u1ea5t thi\u1ebft l\xe0 duy nh\u1ea5t n\u1ebfu n\xf3 kh\xf4ng ph\u1ea3i l\xe0 ph\xed. N\u1ebfu kh\xf4ng c\xf3 ph\xed, b\u1ea1n c\xf3 th\u1ec3 c\xf3 m\u1ed9t giao d\u1ecbch kh\xf4ng c\xf3 \u0111\u1ea7u v\xe0o v\xe0 ch\u1ec9 v\u1edbi \u0111\u1ea7u ra kh\xf4ng c\xf3 gi\xe1 tr\u1ecb. M\u1ed9t giao d\u1ecbch nh\u01b0 v\u1eady s\u1ebd c\xf3 m\u1ed9t s\u1ed1 b\u0103m ch\xednh x\xe1c m\u1ed7i khi n\xf3 \u0111\u01b0\u1ee3c ch\u1ea1y v\xe0 do \u0111\xf3 c\xf3 c\xf9ng m\u1ed9t id giao d\u1ecbch ch\xednh x\xe1c. Nh\u01b0ng v\u1edbi ph\xed, m\u1ed9t giao d\u1ecbch nh\u01b0 v\u1eady kh\xf4ng th\u1ec3 t\u1ed3n t\u1ea1i, v\xec b\u1ea1n lu\xf4n c\u1ea7n \u0111\u1ea7u v\xe0o cung c\u1ea5p ph\xed v\xe0 ph\xed kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 \u0111\u1ebfn t\u1eeb c\xf9ng m\u1ed9t UTxO nh\u01b0 \u0111\u1ea7u v\xe0o."),(0,h.kt)("p",null,"V\xec v\u1eady, \u0111\u1ec3 t\u1ea1o NFT, ch\xfang t\xf4i s\u1ebd cung c\u1ea5p m\u1ed9t UTxO c\u1ee5 th\u1ec3 l\xe0m tham s\u1ed1 cho ch\xednh s\xe1ch \u0111\xfac ti\u1ec1n v\xe0 trong ch\xednh s\xe1ch n\xe0y, ch\xfang t\xf4i s\u1ebd ki\u1ec3m tra xem giao d\u1ecbch c\xf3 s\u1eed d\u1ee5ng UTxO n\xe0y hay kh\xf4ng. V\xe0, nh\u01b0 ch\xfang t\xf4i v\u1eeba l\u01b0u \xfd, m\u1ed9t khi UTxO \u0111\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c ti\xeau th\u1ee5, n\xf3 kh\xf4ng bao gi\u1edd c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c ti\xeau th\u1ee5 l\u1ea1i."),(0,h.kt)("h3",{id:"v\xed-d\u1ee5-3---nft"},"V\xed d\u1ee5 3 - NFT"),(0,h.kt)("p",null,"Ch\xfang t\xf4i b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t b\u1ea3n sao c\u1ee7a v\xed d\u1ee5 tr\u01b0\u1edbc ",(0,h.kt)("inlineCode",{parentName:"p"},"Signed")," av\xe0 ch\xfang t\xf4i s\u1ebd g\u1ecdi ",(0,h.kt)("inlineCode",{parentName:"p"},"NFT"),"."),(0,h.kt)("p",null,"V\xec v\u1eady, h\xe3y bi\u1ebfn ch\xednh s\xe1ch \u0111\xe3 k\xfd th\xe0nh m\u1ed9t ch\xednh s\xe1ch NFT th\u1ef1c s\u1ef1."),(0,h.kt)("h4",{id:"on-chain-2"},"On-chain"),(0,h.kt)("p",null,"\u0110\u1ea7u ti\xean, ch\xfang t\xf4i s\u1ebd kh\xf4ng s\u1eed d\u1ee5ng m\xe3 b\u0103m kh\xf3a c\xf4ng khai l\xe0m \u0111\u1ea7u v\xe0o n\u1eefa, nh\u01b0 th\u1ec3 ch\xfang t\xf4i l\xe0 ng\xe2n h\xe0ng trung \u01b0\u01a1ng, m\xe0 thay v\xe0o \u0111\xf3 s\u1ebd s\u1eed d\u1ee5ng UTxO. V\u1eady, lo\u1ea1i n\xe0o t\u01b0\u01a1ng \u1ee9ng v\u1edbi UTxO?"),(0,h.kt)("p",null,"H\xe3y xem REPL v\xe0 nh\u1eafc nh\u1edf b\u1ea3n th\xe2n v\u1ec1 \u0111i\u1ec1u \u0111\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"TxInfo"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.Signed Week05.Free> import Ledger\nPrelude Week05.Signed Ledger Week05.Free> :i TxInfo\ntype TxInfo :: `\ndata TxInfo\n    = TxInfo {txInfoInputs :: [TxInInfo],\n                txInfoInputsFees :: [TxInInfo],\n                txInfoOutputs :: [TxOut],\n                txInfoFee :: Value,\n                txInfoForge :: Value,\n                txInfoDCert :: [Plutus.V1.Ledger.DCert.DCert],\n                txInfoWdrl :: [(Plutus.V1.Ledger.Credential.StakingCredential,\n                                Integer)],\n                txInfoValidRange :: SlotRange,\n                txInfoSignatories :: [PubKeyHash],\n                txInfoData :: [(DatumHash, Datum)],\n                txInfoId :: TxId}\n")),(0,h.kt)("p",null,"Ch\xfang t\xf4i, ch\xfang t\xf4i quan t\xe2m \u0111\u1ebfn tr\u01b0\u1eddng n\xe0y:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"txInfoInputs :: [TxInInfo]\n")),(0,h.kt)("p",null,"H\xe3y xem x\xe9t ki\u1ec3u ",(0,h.kt)("inlineCode",{parentName:"p"},"TxInInfo")),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.Signed Ledger Week05.Free> :i TxInInfo\ntype TxInInfo :: `\ndata TxInInfo\n    = TxInInfo {txInInfoOutRef :: TxOutRef, txInInfoResolved :: TxOut}\n")),(0,h.kt)("p",null,"Ch\xfang ta th\u1ea5y r\u1eb1ng n\xf3 l\xe0 m\u1ed9t b\u1ea3n ghi c\xf3 hai tr\u01b0\u1eddng. \u0110\u1ea7u ti\xean l\xe0 v\u1ec1 lo\u1ea1i ",(0,h.kt)("inlineCode",{parentName:"p"},"TxOutRef")," v\xe0 \u0111i\u1ec1u n\xe0y tham chi\u1ebfu \u0111\u1ebfn UTxO, ch\xednh x\xe1c l\xe0 nh\u1eefng g\xec ch\xfang ta c\u1ea7n. V\xec v\u1eady, ch\xfang ta h\xe3y s\u1eed d\u1ee5ng n\xf3."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkPolicy :: TxOutRef -> ScriptContext -> Bool\n")),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang t\xf4i \u0111\xe3 s\u1eb5n s\xe0ng \u0111\u1ec3 vi\u1ebft logic. Ch\xfang ta ph\u1ea3i ki\u1ec3m tra xem t\u1eadp l\u1ec7nh c\xf3 ch\u1ee9a UTxO \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh l\xe0m \u0111\u1ea7u v\xe0o hay kh\xf4ng. Ch\xfang t\xf4i s\u1ebd \u1ee7y th\xe1c \u0111i\u1ec1u n\xe0y cho m\u1ed9t ch\u1ee9c n\u0103ng tr\u1ee3 gi\xfap. Ch\u1ee9c n\u0103ng n\xe0y, m\xe0 ch\xfang t\xf4i s\u1ebd g\u1ecdi h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"hasUTxO")," s\u1eed d\u1ee5ng h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"any"),", l\xe0 m\u1ed9t h\xe0m ti\xeau chu\u1ea9n Prelude, nh\u01b0ng c\u0169ng c\xf3 phi\xean b\u1ea3n Plutus, v\xec nh\u1eefng l\xfd do m\xe0 ch\xfang t\xf4i \u0111\xe3 gi\u1ea3i quy\u1ebft tr\u01b0\u1edbc \u0111\xf3."),(0,h.kt)("p",null,"C\xe1c h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"any")," c\xf3 m\u1ed9t \u0111\u01a1n v\u1ecb (m\u1ed9t h\xe0m tr\u1ea3 v\u1ec1 m\u1ed9t boolean) v\xe0 \xe1p d\u1ee5ng n\xf3 v\xe0o m\u1ed9t b\u1ed9 s\u01b0u t\u1eadp \u0111\u1ea7u v\xe0o c\u1ee7a c\xe1c ki\u1ec3u ",(0,h.kt)("inlineCode",{parentName:"p"},"Foldable"),"( v\xed d\u1ee5 m\u1ed9t danh s\xe1ch), v\xe0 s\u1ebd tr\u1edf th\xe0nh s\u1ef1 th\u1eadt n\u1ebfu v\u1ecb l\xe0 \u0111\xfang \u0111\u1ed1i v\u1edbi b\u1ea5t k\u1ef3 \u0111\u1ea7u v\xe0o."),(0,h.kt)("p",null,"\u1ede \u0111\xe2y, ch\xfang t\xf4i s\u1eed d\u1ee5ng anyh\xe0m \u0111\u1ec3 xem li\u1ec7u c\xf3 b\u1ea5t k\u1ef3 ",(0,h.kt)("inlineCode",{parentName:"p"},"txInInfoOutRefs")," n\xe0o trong ",(0,h.kt)("inlineCode",{parentName:"p"},"txInfoInputs")," t\u1eeb ",(0,h.kt)("inlineCode",{parentName:"p"},"TxInfo")," tr\u01b0\u1eddng c\u1ee7a ng\u1eef c\u1ea3nh kh\u1edbp v\u1edbi UTxO m\xe0 ch\xfang t\xf4i \u0111ang x\xe1c th\u1ef1c hay kh\xf4ng."),(0,h.kt)("p",null,"\u0110\u1ec3 r\xf5 r\xe0ng, ch\xfang t\xf4i c\u0169ng s\u1ebd cung c\u1ea5p m\u1ed9t ch\u1ee9c n\u0103ng tr\u1ee3 gi\xfap \u0111\u1ec3 l\u1ea5y danh s\xe1ch ",(0,h.kt)("inlineCode",{parentName:"p"},"txInfoInputs"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"info :: TxInfo\ninfo = scriptContextTxInfo ctx\n\nhasUTxO :: Bool\nhasUTxO = any (\\i -> txInInfoOutRef i == oref) $ txInfoInputs info\n")),(0,h.kt)("p",null,"V\xec v\u1eady, ch\xfang ta c\xf3 \u0111\u1ee7 \u0111\u1ec3 ho\xe0n th\xe0nh vi\u1ec7c vi\u1ebft ch\xednh s\xe1ch c\u1ee7a ch\xfang t\xf4i? H\xe3y xem nh\u1eefng g\xec ch\xfang t\xf4i c\xf3."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mkPolicy :: TxOutRef -> ScriptContext -> Bool\nmkPolicy oref ctx = traceIfFalse "UTxO not consumed" hasUTxO\nwhere\n    info :: TxInfo\n    info = scriptContextTxInfo ctx\n\n    hasUTxO :: Bool\n    hasUTxO = any (\\i -> txInInfoOutRef i == oref) $ txInfoInputs info\n')),(0,h.kt)("p",null,"Hi\u1ec7n t\u1ea1i, ch\xfang t\xf4i c\xf3 ch\xednh s\xe1ch ch\u1ec9 c\xf3 th\u1ec3 \u0111\xfac ho\u1eb7c \u0111\u1ed1t m\u1ed9t l\u1ea7n. Tuy nhi\xean, t\u1ea5t nhi\xean, trong m\u1ed9t giao d\u1ecbch duy nh\u1ea5t \u0111\xf3, ch\xfang ta v\u1eabn c\xf3 th\u1ec3 \u0111\xfac bao nhi\xeau m\xe3 th\xf4ng b\xe1o t\xf9y th\xedch."),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang t\xf4i ngh\u0129 v\u1ec1 nh\u1eefng g\xec ch\xfang t\xf4i th\u1ef1c s\u1ef1 mu\u1ed1n. C\xf3 th\u1ec3 ch\xfang t\xf4i mu\u1ed1n m\u1ed9t ch\xednh s\xe1ch cho ph\xe9p ch\xfang t\xf4i \u0111\xfac ch\u1ec9 m\u1ed9t m\xe3 th\xf4ng b\xe1o cho bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7. Ho\u1eb7c c\xf3 l\u1ebd, ch\xfang t\xf4i mu\u1ed1n c\xf3 th\u1ec3 \u0111\xfac nhi\u1ec1u NFT c\xf9ng m\u1ed9t l\xfac, m\u1ed7i NFT c\xf3 m\u1ed9t t\xean m\xe3 th\xf4ng b\xe1o kh\xe1c nhau."),(0,h.kt)("p",null,"\u0110i\u1ec1u \u0111\xf3 t\xf9y thu\u1ed9c v\xe0o ch\xfang t\xf4i. Nh\u01b0ng, gi\u1ea3 s\u1eed ch\xfang ta \u0111i v\u1edbi t\xf9y ch\u1ecdn \u0111\u1ea7u ti\xean. Ch\xfang t\xf4i ch\u1ec9 mu\u1ed1n \u0111\xfac m\u1ed9t m\xe3 th\xf4ng b\xe1o."),(0,h.kt)("p",null,"V\xec v\u1eady, s\u1ebd h\u1ee3p l\xfd khi chuy\u1ec3n t\xean m\xe3 th\xf4ng b\xe1o l\xe0m tham s\u1ed1."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mkPolicy :: TxOutRef -> TokenName -> ScriptContext -> Bool\n")),(0,h.kt)("p",null,"V\xe0 ch\xfang t\xf4i c\u1ea7n m\u1ed9t \u0111i\u1ec1u ki\u1ec7n th\u1ee9 hai \u0111\u1ec3 ki\u1ec3m tra xem ch\xfang t\xf4i c\xf3 \u0111\xfac ch\u1ec9 m\u1ed9t \u0111\u1ed3ng xu c\u1ee5 th\u1ec3 n\xe0y hay kh\xf4ng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mkPolicy oref tn ctx = traceIfFalse "UTxO not consumed"   hasUTxO           &&\n                       traceIfFalse "wrong amount minted" checkMintedAmount\n')),(0,h.kt)("p",null,"V\xe0, t\u1ea5t nhi\xean, ch\xfang t\xf4i c\u1ea7n ph\u1ea3i th\u1ef1c hi\u1ec7n ",(0,h.kt)("inlineCode",{parentName:"p"},"checkMintedAmount"),"."),(0,h.kt)("p",null,"Tr\u01b0\u1edbc h\u1ebft, ch\xfang ta c\u1ea7n truy c\u1eadp v\xe0o gi\xe1 tr\u1ecb gi\u1ea3 m\u1ea1o. Ch\xfang t\xf4i c\xf3 \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\xe0y t\u1eeb c\xe1c l\u0129nh v\u1ef1c ",(0,h.kt)("inlineCode",{parentName:"p"},"txInfoForge")," c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"TxInfo"),"."),(0,h.kt)("p",null,"L\xe0m c\xe1ch n\xe0o \u0111\u1ec3 ch\xfang t\xf4i ki\u1ec3m tra xem gi\xe1 tr\u1ecb gi\u1ea3 m\u1ea1o n\xe0y c\xf3 \u0111\xfang l\xe0 1 m\xe3 th\xf4ng b\xe1o c\u1ee7a t\xean m\xe0 ch\xfang t\xf4i y\xeau c\u1ea7u hay kh\xf4ng? C\xf3 m\u1ed9t s\u1ed1 c\xe1ch ti\u1ebfp c\u1eadn, nh\u01b0ng m\u1ed9t l\xe0 s\u1eed d\u1ee5ng h\xe0m",(0,h.kt)("inlineCode",{parentName:"p"},"flattenValue")," m\xe0 ch\xfang t\xf4i s\u1ebd nh\u1edb l\u1ea1i, tr\u1ea3 v\u1ec1 danh s\xe1ch b\u1ed9 ba k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7, t\xean m\xe3 th\xf4ng b\xe1o v\xe0 gi\xe1 tr\u1ecb. Sau \u0111\xf3, ch\xfang t\xf4i c\xf3 th\u1ec3 ki\u1ec3m tra xem \u0111\u1ea7u ra c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"flattenValue")," c\xf3 ch\xednh x\xe1c m\u1ed9t b\u1ed9 ba kh\u1edbp v\u1edbi bi\u1ec3u t\u01b0\u1ee3ng, m\xe3 th\xf4ng b\xe1o v\xe0 gi\xe1 tr\u1ecb m\xe0 ch\xfang t\xf4i mong \u0111\u1ee3i hay kh\xf4ng."),(0,h.kt)("p",null,"N\xf3 s\u1ebd tr\xf4ng gi\u1ed1ng nh\u01b0 th\u1ebf n\xe0y:"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"flattenValue (txInfoForge info) == [(cs, tn, 1)]\n")),(0,h.kt)("p",null,"Nh\u01b0ng ch\xfang t\xf4i v\u1eabn c\xf2n m\u1ed9t v\u1ea5n \u0111\u1ec1 c\u1ea7n gi\u1ea3i quy\u1ebft - ch\xfang t\xf4i c\u1ea7n bi\u1ebft k\xfd hi\u1ec7u ti\u1ec1n t\u1ec7 l\xe0 g\xec. Cho r\u1eb1ng bi\u1ec3u t\u01b0\u1ee3ng ti\u1ec1n t\u1ec7 l\xe0 m\u1ed9t h\xe0m b\u0103m c\u1ee7a ch\xednh s\xe1ch, c\xf3 v\u1ebb nh\u01b0 ch\xfang ta \u0111ang g\u1eb7p v\u1ea5n \u0111\u1ec1 v\u1ec1 con g\xe0 v\xe0 qu\u1ea3 tr\u1ee9ng."),(0,h.kt)("p",null,"May m\u1eafn thay, c\xf3 m\u1ed9t ch\u1ee9c n\u0103ng \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"ownCurrencySymbol")," t\u1ed3n t\u1ea1i \u0111\u1ec3 gi\u1ea3i quy\u1ebft ch\xednh x\xe1c v\u1ea5n \u0111\u1ec1 n\xe0y."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"flattenValue (txInfoForge info) == [(ownCurrencySymbol ctx, tn, 1)]\n")),(0,h.kt)("p",null,"Khi n\xf3 x\u1ea3y ra, \u0111i\u1ec1u n\xe0y s\u1ebd kh\xf4ng bi\xean d\u1ecbch, v\xec Eq kh\xf4ng \u0111\u01b0\u1ee3c x\xe1c \u0111\u1ecbnh cho b\u1ed9 ba trong Plutus Prelude. V\xec v\u1eady, ch\xfang ta c\xf3 th\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y v\u1edbi m\u1ed9t c\xe2u l\u1ec7nh tr\u01b0\u1eddng h\u1ee3p v\xe0 m\u1ed9t s\u1ed1 \u0111\u1ed1i s\xe1nh m\u1eabu."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"case flattenValue (txInfoForge info) of\n        [(cs, tn', amt)] -> cs  == ownCurrencySymbol ctx && tn' == tn && amt == 1\n        _                -> False\n")),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang t\xf4i c\xf3 th\u1ec3 ho\xe0n th\xe0nh ch\xednh s\xe1ch c\u1ee7a m\xecnh."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mkPolicy :: TxOutRef -> TokenName -> ScriptContext -> Bool\nmkPolicy oref tn ctx = traceIfFalse "UTxO not consumed"   hasUTxO           &&\n                    traceIfFalse "wrong amount minted" checkMintedAmount\nwhere\n    info :: TxInfo\n    info = scriptContextTxInfo ctx\n\n    hasUTxO :: Bool\n    hasUTxO = any (\\i -> txInInfoOutRef i == oref) $ txInfoInputs info\n\n    checkMintedAmount :: Bool\n    checkMintedAmount = case flattenValue (txInfoForge info) of\n        [(cs, tn\', amt)] -> cs  == ownCurrencySymbol ctx && tn\' == tn && amt == 1\n        _                -> False\n')),(0,h.kt)("p",null,"V\xe0 ch\xfang t\xf4i s\u1ebd c\u1eadp nh\u1eadt b\u1ea3ng n\u1ea5u \u0103n c\u1ee7a ch\xfang t\xf4i."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"policy :: TxOutRef -> TokenName -> Scripts.MonetaryPolicy\npolicy oref tn = mkMonetaryPolicyScript $\n    $$(PlutusTx.compile [|| \\oref' tn' -> Scripts.wrapMonetaryPolicy $ mkPolicy oref' tn' ||])\n    `PlutusTx.applyCode`\n    PlutusTx.liftCode oref\n    `PlutusTx.applyCode`\n    PlutusTx.liftCode tn\n\ncurSymbol :: TxOutRef -> TokenName -> CurrencySymbol\ncurSymbol oref tn = scriptCurrencySymbol $ policy oref tn    \n")),(0,h.kt)("p",null,"\u0110i\u1ec1u \u0111\xf3 ho\xe0n th\xe0nh ph\u1ea7n on-chain."),(0,h.kt)("h4",{id:"off-chain-2"},"Off-chain"),(0,h.kt)("p",null,"Ch\xfang ta c\u1ea7n suy ngh\u0129 v\u1ec1 c\xe1c y\u1ebfu t\u1ed1 \u0111\u1ea7u v\xe0o m\xe0 ch\xfang ta c\u1ea7n cho giao d\u1ecbch n\xe0y."),(0,h.kt)("p",null,"\u0110\u1ea7u ti\xean, ch\xfang t\xf4i c\u1ea7n m\u1ed9t UTxO v\xe0 ch\xfang t\xf4i c\u1ea7n cung c\u1ea5p m\u1ed9t UTxO c\u1ee7a ri\xeang m\xecnh. Tuy nhi\xean, ch\xfang ta kh\xf4ng c\u1ea7n chuy\u1ec3n n\xf3 v\xe0o v\xec ch\xfang ta c\xf3 th\u1ec3 tra c\u1ee9u tr\u1ef1c ti\u1ebfp."),(0,h.kt)("p",null,"Ch\xfang t\xf4i ch\u1ec9 c\u1ea7n cung c\u1ea5p t\xean m\xe3 th\xf4ng b\xe1o, v\xec v\u1eady ch\xfang t\xf4i kh\xf4ng c\u1ea7n lo\u1ea1i d\u1eef li\u1ec7u \u0111\u1eb7c bi\u1ec7t n\u1eefa, v\xec v\u1eady ch\xfang t\xf4i c\xf3 th\u1ec3 x\xf3a ",(0,h.kt)("inlineCode",{parentName:"p"},"MintParams")," v\xe0 ch\u1ec9 s\u1eed d\u1ee5ng ",(0,h.kt)("inlineCode",{parentName:"p"},"TokenName"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'type NFTSchema =\n    BlockchainActions\n        .\\/ Endpoint "mint" TokenName\n')),(0,h.kt)("p",null,"B\xe2y gi\u1edd ch\xfang ta s\u1ebd vi\u1ebft h\xe0m off-chain ",(0,h.kt)("inlineCode",{parentName:"p"},"mint"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"mint :: TokenName -> Contract w NFTSchema Text ()\nmint tn = do\n")),(0,h.kt)("p",null,"\u0110i\u1ec1u \u0111\u1ea7u ti\xean c\u1ea7n l\xe0m l\xe0 l\u1ea5y danh s\xe1ch c\xe1c UTxO thu\u1ed9c v\u1ec1 ch\xfang t\xf4i."),(0,h.kt)("p",null,"C\xe1c m\xf4-\u0111un ",(0,h.kt)("inlineCode",{parentName:"p"},"Plutus.Contract"),"  cho ch\xfang ta h\xe0m ",(0,h.kt)("inlineCode",{parentName:"p"},"utxoAt"),", trong \u0111\xf3 c\xf3 ch\u1eef k\xfd d\u01b0\u1edbi \u0111\xe2y, v\xe0 nh\xecn l\xean t\u1ea5t c\u1ea3 c\xe1c UTxOs t\u1ea1i m\u1ed9t \u0111\u1ecba ch\u1ec9 nh\u1ea5t \u0111\u1ecbnh."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"utxoAt :: Address -> Contract w s e Ledger.AddressMap.UtxoMap\n")),(0,h.kt)("p",null,"m\u1ed9t ",(0,h.kt)("inlineCode",{parentName:"p"},"AddressMap")," l\xe0 map trong \u0111\xf3  keys l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"TxOutRef"),"s gi\xe1 tr\u1ecb l\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"TxOutTx"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.NFT> :i Ledger.AddressMap.UtxoMap\ntype Ledger.AddressMap.UtxoMap :: `\ntype Ledger.AddressMap.UtxoMap = Data.Map.Internal.Map TxOutRef TxOutTx\n")),(0,h.kt)("p",null,"N\u1ebfu ch\xfang t\xf4i chuy\u1ec3n ch\u1ee9c n\u0103ng n\xe0y \u0111\u1ebfn \u0111\u1ecba ch\u1ec9 c\u1ee7a ch\xednh ch\xfang t\xf4i th\xec c\xe1c kh\xf3a c\u1ee7a b\u1ea3n \u0111\u1ed3 n\xe0y s\u1ebd l\xe0 c\xe1c UTxO thu\u1ed9c v\u1ec1 ch\xfang t\xf4i. Ch\xfang t\xf4i ch\u1ecdn c\xe1i n\xe0o trong s\u1ed1 n\xe0y kh\xf4ng quan tr\u1ecdng. V\xec v\u1eady, mi\u1ec5n l\xe0 ch\xfang ta s\u1edf h\u1eefu \xedt nh\u1ea5t m\u1ed9t UTxO, ch\xfang ta \u0111\xe3 t\u1ed1t."),(0,h.kt)("p",null,"B\u01b0\u1edbc \u0111\u1ea7u ti\xean l\xe0 t\xecm \u0111\u1ecba ch\u1ec9 c\u1ee7a ch\xednh ch\xfang t\xf4i. Ch\xfang t\xf4i bi\u1ebft c\xe1ch t\xecm kh\xf3a c\xf4ng khai c\u1ee7a ri\xeang m\xecnh v\xe0, v\u1edbi \u0111i\u1ec1u n\xe0y, ch\xfang t\xf4i c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\xe0y ",(0,h.kt)("inlineCode",{parentName:"p"},"pubKeyAddress")," \u0111\u1ec3 l\u1ea5y \u0111\u1ecba ch\u1ec9 c\u1ee7a m\xecnh."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"pubKeyAddress :: PubKey -> address\n")),(0,h.kt)("p",null,"H\xe3y l\u1ea5y ch\xfang."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"import qualified Data.Map as Map\n\nmint :: TokenName -> Contract w NFTSchema Text ()\nmint tn = do\n    pk    <- Contract.ownPubKey\n    utxos <- utxoAt (pubKeyAddress pk)\n")),(0,h.kt)("p",null,"Ch\xfang t\xf4i ch\u1ec9 c\u1ea7n m\u1ed9t c\xe1i - ch\xfang t\xf4i kh\xf4ng quan t\xe2m c\xe1i n\xe0o. Ch\xfang t\xf4i s\u1ebd vi\u1ebft m\u1ed9t c\xe2u l\u1ec7nh tr\u01b0\u1eddng h\u1ee3p s\u1ebd ghi l\u1ea1i l\u1ed7i n\u1ebfu ch\xfang t\xf4i kh\xf4ng c\xf3 UTxO c\xf3 s\u1eb5n ho\u1eb7c s\u1ebd s\u1eed d\u1ee5ng UTxO \u0111\u1ea7u ti\xean trong danh s\xe1ch ti\u1ebfp t\u1ee5c v\u1edbi m\xe3 gi\u1ea3 m\u1ea1o."),(0,h.kt)("p",null,"Thay \u0111\u1ed5i \u0111\u1ea7u ti\xean l\xe0 ch\u1ec9 \u0111\u1ecbnh 1thay v\xec ch\u1ec9 \u0111\u1ecbnh ",(0,h.kt)("inlineCode",{parentName:"p"},"mpAmount"),", v\xec ch\xfang t\xf4i mu\u1ed1n c\xf3 ch\xednh x\xe1c 1 \u0111\u1ed3ng xu \u0111\u01b0\u1ee3c \u0111\xfac."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'case Map.keys utxos of\n    []       -> Contract.logError @String "no utxo found"\n    oref : _ -> do\n        let val     = Value.singleton (curSymbol oref tn) tn 1\n')),(0,h.kt)("p",null,"Th\u1ee9 hai, ch\xfang t\xf4i th\xeam \u0111\u1ed1i s\u1ed1 t\xean m\xe3 th\xf4ng b\xe1o v\xe0o c\xe1c tra c\u1ee9u."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"lookups = Constraints.monetaryPolicy $ policy oref tn\n")),(0,h.kt)("p",null,"Th\u1ee9 ba, b\xe2y gi\u1edd ch\xfang t\xf4i c\u1ea7n m\u1ed9t r\xe0ng bu\u1ed9c b\u1ed5 sung \u0111\u1ec3 kh\u1eb3ng \u0111\u1ecbnh r\u1eb1ng UTxO c\u1ee5 th\u1ec3 c\u1ee7a ch\xfang t\xf4i \u0111\xe3 \u0111\u01b0\u1ee3c ti\xeau th\u1ee5."),(0,h.kt)("p",null,"C\xf3 m\u1ed9t ch\u1ee9c n\u0103ng cho \u0111i\u1ec1u \u0111\xf3."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Prelude Week05.NFT> import Ledger.Constraints\nPrelude Week05.NFT> :t mustSpendPubKeyOutput\nmustSpendPubKeyOutput :: TxOutRef -> TxConstraints i o\n")),(0,h.kt)("p",null,"L\xe0m th\u1ebf n\xe0o \u0111\u1ec3 ch\xfang ta k\u1ebft h\u1ee3p c\xe1c r\xe0ng bu\u1ed9c c\u1ee7a ",(0,h.kt)("inlineCode",{parentName:"p"},"mustForgeValue")," v\xe0 ",(0,h.kt)("inlineCode",{parentName:"p"},"mustSpendPubKeyOutput"),"? ",(0,h.kt)("inlineCode",{parentName:"p"},"Contraints"),"kh\xf4ng t\u1ea1o th\xe0nh a ",(0,h.kt)("inlineCode",{parentName:"p"},"Monoid"),", nh\u01b0ng ch\xfang c\xf3 t\u1ea1o th\xe0nh a Semigroup, v\xe0 s\u1ef1 kh\xe1c bi\u1ec7t ch\u1ec9 l\xe0 \u1edf ch\u1ed7 ",(0,h.kt)("inlineCode",{parentName:"p"},"Semigroup")," ch\xfang ta kh\xf4ng c\xf3 ",(0,h.kt)("inlineCode",{parentName:"p"},"mempty"),", ph\u1ea7n t\u1eed trung t\xednh. Ch\xfang t\xf4i v\u1eabn c\xf3 th\u1ec3 k\u1ebft h\u1ee3p ch\xfang v\u1edbi to\xe1n t\u1eed ",(0,h.kt)("inlineCode",{parentName:"p"},"<>"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"tx = Constraints.mustForgeValue val <> Constraints.mustSpendPubKeyOutput oref\n")),(0,h.kt)("p",null,"B\xe2y gi\u1edd, ch\xfang t\xf4i c\u1ea7n cung c\u1ea5p m\u1ed9t b\u1ea3n tra c\u1ee9u cho ph\xe9p truy c\u1eadp v\xe0o n\u01a1i ",(0,h.kt)("inlineCode",{parentName:"p"},"oref")," c\xf3 th\u1ec3 t\xecm th\u1ea5y UTxO . V\xec v\u1eady, ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng"),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"Ledger.Constraints.unspentOutputs :: Data.Map.Internal.Map TxOutRef TxOutTx -> ScriptLookups a\n")),(0,h.kt)("p",null,"V\xec v\u1eady, h\xe3y c\u1eadp nh\u1eadt tra c\u1ee9u c\u1ee7a ch\xfang t\xf4i."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"lookups = Constraints.monetaryPolicy (policy oref tn) <> Constraints.unspentOutputs utxos\n")),(0,h.kt)("p",null,"M\u1ed9t c\xe1i g\xec \u0111\xf3 ch\xfang ta c\u1ea7n ph\u1ea3i l\xe0m tr\u01b0\u1edbc khi k\u1ecbch b\u1ea3n n\xe0y s\u1ebd ch\u1ea1y l\xe0 ph\u1ea3i nh\u1eadp kh\u1ea9u c\xe1c nh\xe0 \u0111i\u1ec1u h\xe0nh ",(0,h.kt)("inlineCode",{parentName:"p"},"<>")," cho Semigroupt\u1eeb Haskell Prelude ti\xeau chu\u1ea9n, nh\u01b0 ch\xfang ta \u0111\xe3 lo\u1ea1i tr\u1eeb m\u1ed9t c\xe1ch r\xf5 r\xe0ng t\u1eeb c\xe1c mudule ",(0,h.kt)("inlineCode",{parentName:"p"},"PlutusTx.Prelude"),"."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},"import Prelude (Semigroup (..))\n")),(0,h.kt)("p",null,"Ch\xfang ta h\xe3y nh\xecn v\xe0o to\xe0n b\u1ed9 ch\u1ee9c n\u0103ng."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'mint :: TokenName -> Contract w NFTSchema Text ()\nmint tn = do\n    pk    <- Contract.ownPubKey\n    utxos <- utxoAt (pubKeyAddress pk)\n    case Map.keys utxos of\n        []       -> Contract.logError @String "no utxo found"\n        oref : _ -> do\n            let val     = Value.singleton (curSymbol oref tn) tn 1\n                lookups = Constraints.monetaryPolicy (policy oref tn) <> Constraints.unspentOutputs utxos\n                tx      = Constraints.mustForgeValue val <> Constraints.mustSpendPubKeyOutput oref\n            ledgerTx <- submitTxConstraintsWith @Void lookups tx\n            void $ awaitTxConfirmed $ txId ledgerTx\n            Contract.logInfo @String $ printf "forged %s" (show val)\n')),(0,h.kt)("p",null,"\u0110\u1ed1i v\u1edbi k\u1ecbch b\u1ea3n th\u1eed nghi\u1ec7m."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'test :: IO ()\ntest = runEmulatorTraceIO $ do\n    let tn = "ABC"\n    h1 <- activateContractWallet (Wallet 1) endpoints\n    h2 <- activateContractWallet (Wallet 2) endpoints\n    callEndpoint @"mint" h1 tn\n    callEndpoint @"mint" h2 tn\n    void $ Emulator.waitNSlots 1\n')),(0,h.kt)("p",null,"H\xe3y th\u1eed nghi\u1ec7m."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-{.haskell}"},'Prelude Week05.Signed Ledger Plutus.Contract Ledger.Constraints Week05.Free> Week05.NFT.test\nSlot 00000: TxnValidate af5e6d25b5ecb26185289a03d50786b7ac4425b21849143ed7e18bcd70dc4db8\nSlot 00000: SlotAdd Slot 1\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nContract instance started\nSlot 00001: 00000000-0000-4000-8000-000000000000 {Contract instance for wallet 1}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("unTokenName",String "ABC")]))]))])\nSlot 00001: W1: TxSubmit: 691a5c0725ac09f79c8c45c899d732d26460d18c4c18167be71d55319bcd5669\nSlot 00001: 00000000-0000-4000-8000-000000000001 {Contract instance for wallet 2}:\nReceive endpoint call: Object (fromList [("tag",String "mint"),("value",Object (fromList [("unEndpointValue",Object (fromList [("unTokenName",String "ABC")]))]))])\nSlot 00001: W2: TxSubmit: e53519b17bf7d11a148ce17ac0305330f138a684530ba08b1c57f714672b8c68\nSlot 00001: TxnValidate e53519b17bf7d11a148ce17ac0305330f138a684530ba08b1c57f714672b8c68\nSlot 00001: TxnValidate 691a5c0725ac09f79c8c45c899d732d26460d18c4c18167be71d55319bcd5669\nSlot 00001: SlotAdd Slot 2\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(9d969e597d45fcd1732ce255e12a97599e883f924b4565fc3a2407bc08d34524,Map [(\\"ABC\\",1)])])"\nSlot 00002: ``` CONTRACT LOG: "forged Value (Map [(913f220c3b1ba49531bae2fedd9edb138a8b360e7e605bfcf4ff3f2045433069,Map [(\\"ABC\\",1)])])"\nSlot 00002: SlotAdd Slot 3\nFinal balances\nWallet 1: \n    {9d969e597d45fcd1732ce255e12a97599e883f924b4565fc3a2407bc08d34524, "ABC"}: 1\n    {, ""}: 99999990\nWallet 2: \n    {913f220c3b1ba49531bae2fedd9edb138a8b360e7e605bfcf4ff3f2045433069, "ABC"}: 1\n    {, ""}: 99999990\n...\nWallet 10: \n    {, ""}: 100000000\n')),(0,h.kt)("p",null,"V\xe0 b\xe2y gi\u1edd ch\xfang t\xf4i \u0111\xe3 \u0111\xfac m\u1ed9t s\u1ed1 NFT."))}u.isMDXComponent=!0},3345:function(n,t,e){t.Z=e.p+"assets/images/week05__00007-270b982ffe4af5e16f350eeb431aec66.png"},6232:function(n,t,e){t.Z=e.p+"assets/images/week05__00008-8d0dd93b6829f9cea9f29bc3342803fd.png"},9952:function(n,t,e){t.Z=e.p+"assets/images/week05__00009-764a94ea804c12f7cedfd0ad39283118.png"},9:function(n,t,e){t.Z=e.p+"assets/images/week05__00010-2229fd8ca240af8ba246c7de1752e6b0.png"},5289:function(n,t,e){t.Z=e.p+"assets/images/week05__00011-ae746f5050bda534c483912702da91aa.png"},722:function(n,t,e){t.Z=e.p+"assets/images/week05__00012-69d34b65fcb4c74f35cc1ebe90b9ef96.png"}}]);